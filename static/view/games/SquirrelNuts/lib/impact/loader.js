ig.module("impact.loader").requires("impact.image","impact.font","impact.sound").defines(function(){"use strict";ig.Loader=ig.Class.extend({resources:[],gameClass:null,status:0,done:!1,_unloaded:[],_drawStatus:0,_intervalId:0,_loadCallbackBound:null,init:function(t,s){this.gameClass=t,this.resources=s,this._loadCallbackBound=this._loadCallback.bind(this);for(var e=0;e<this.resources.length;e++)this._unloaded.push(this.resources[e].path)},load:function(){if(ig.system.clear("#000"),this.resources.length){for(var t=0;t<this.resources.length;t++)this.loadResource(this.resources[t]);this._intervalId=setInterval(this.draw.bind(this),16)}else this.end()},loadResource:function(t){t.load(this._loadCallbackBound)},end:function(){this.done||(this.done=!0,clearInterval(this._intervalId),ig.system.setGame(this.gameClass))},draw:function(){this._drawStatus+=(this.status-this._drawStatus)/5;var t=ig.system.scale,s=.6*ig.system.width,e=.1*ig.system.height,i=.5*ig.system.width-s/2,l=.5*ig.system.height-e/2;ig.system.context.fillStyle="#000",ig.system.context.fillRect(0,0,480,320),ig.system.context.fillStyle="#fff",ig.system.context.fillRect(i*t,l*t,s*t,e*t),ig.system.context.fillStyle="#000",ig.system.context.fillRect(i*t+t,l*t+t,s*t-t-t,e*t-t-t),ig.system.context.fillStyle="#fff",ig.system.context.fillRect(i*t,l*t,s*t*this._drawStatus,e*t)},_loadCallback:function(t,s){if(!s)throw"Failed to load resource: "+t;this._unloaded.erase(t),this.status=1-this._unloaded.length/this.resources.length,0==this._unloaded.length&&setTimeout(this.end.bind(this),250)}})});