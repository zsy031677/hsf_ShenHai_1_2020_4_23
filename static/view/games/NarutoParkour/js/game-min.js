function hex_md5(t){return rstr2hex(rstr_md5(str2rstr_utf8(t)))}function b64_md5(t){return rstr2b64(rstr_md5(str2rstr_utf8(t)))}function any_md5(t,e){return rstr2any(rstr_md5(str2rstr_utf8(t)),e)}function hex_hmac_md5(t,e){return rstr2hex(rstr_hmac_md5(str2rstr_utf8(t),str2rstr_utf8(e)))}function b64_hmac_md5(t,e){return rstr2b64(rstr_hmac_md5(str2rstr_utf8(t),str2rstr_utf8(e)))}function any_hmac_md5(t,e,i){return rstr2any(rstr_hmac_md5(str2rstr_utf8(t),str2rstr_utf8(e)),i)}function md5_vm_test(){return"900150983cd24fb0d6963f7d28e17f72"==hex_md5("abc").toLowerCase()}function rstr_md5(t){return binl2rstr(binl_md5(rstr2binl(t),8*t.length))}function rstr_hmac_md5(t,e){var i=rstr2binl(t);16<i.length&&(i=binl_md5(i,8*t.length));for(var n=Array(16),s=Array(16),r=0;16>r;r++)n[r]=909522486^i[r],s[r]=1549556828^i[r];return i=binl_md5(n.concat(rstr2binl(e)),512+8*e.length),binl2rstr(binl_md5(s.concat(i),640))}function rstr2hex(t){for(var e,i=hexcase?"0123456789ABCDEF":"0123456789abcdef",n="",s=0;s<t.length;s++)e=t.charCodeAt(s),n+=i.charAt(e>>>4&15)+i.charAt(15&e);return n}function rstr2b64(t){for(var e="",i=t.length,n=0;n<i;n+=3)for(var s=t.charCodeAt(n)<<16|(n+1<i?t.charCodeAt(n+1)<<8:0)|(n+2<i?t.charCodeAt(n+2):0),r=0;4>r;r++)e=8*n+6*r>8*t.length?e+b64pad:e+"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/".charAt(s>>>6*(3-r)&63);return e}function rstr2any(t,e){var i,n,s,r,o,a=e.length,h=Array(Math.ceil(t.length/2));for(i=0;i<h.length;i++)h[i]=t.charCodeAt(2*i)<<8|t.charCodeAt(2*i+1);var u=Math.ceil(8*t.length/(Math.log(e.length)/Math.log(2))),c=Array(u);for(n=0;n<u;n++){for(o=[],i=r=0;i<h.length;i++)r=(r<<16)+h[i],s=Math.floor(r/a),r-=s*a,(0<o.length||0<s)&&(o[o.length]=s);c[n]=r,h=o}for(a="",i=c.length-1;0<=i;i--)a+=e.charAt(c[i]);return a}function str2rstr_utf8(t){for(var e,i,n="",s=-1;++s<t.length;)e=t.charCodeAt(s),i=s+1<t.length?t.charCodeAt(s+1):0,55296<=e&&56319>=e&&56320<=i&&57343>=i&&(e=65536+((1023&e)<<10)+(1023&i),s++),127>=e?n+=String.fromCharCode(e):2047>=e?n+=String.fromCharCode(192|e>>>6&31,128|63&e):65535>=e?n+=String.fromCharCode(224|e>>>12&15,128|e>>>6&63,128|63&e):2097151>=e&&(n+=String.fromCharCode(240|e>>>18&7,128|e>>>12&63,128|e>>>6&63,128|63&e));return n}function str2rstr_utf16le(t){for(var e="",i=0;i<t.length;i++)e+=String.fromCharCode(255&t.charCodeAt(i),t.charCodeAt(i)>>>8&255);return e}function str2rstr_utf16be(t){for(var e="",i=0;i<t.length;i++)e+=String.fromCharCode(t.charCodeAt(i)>>>8&255,255&t.charCodeAt(i));return e}function rstr2binl(t){for(var e=Array(t.length>>2),i=0;i<e.length;i++)e[i]=0;for(i=0;i<8*t.length;i+=8)e[i>>5]|=(255&t.charCodeAt(i/8))<<i%32;return e}function binl2rstr(t){for(var e="",i=0;i<32*t.length;i+=8)e+=String.fromCharCode(t[i>>5]>>>i%32&255);return e}function binl_md5(t,e){t[e>>5]|=128<<e%32,t[14+(e+64>>>9<<4)]=e;for(var i=1732584193,n=-271733879,s=-1732584194,r=271733878,o=0;o<t.length;o+=16)var a=i,h=n,u=s,c=r,i=md5_ff(i,n,s,r,t[o+0],7,-680876936),r=md5_ff(r,i,n,s,t[o+1],12,-389564586),s=md5_ff(s,r,i,n,t[o+2],17,606105819),n=md5_ff(n,s,r,i,t[o+3],22,-1044525330),i=md5_ff(i,n,s,r,t[o+4],7,-176418897),r=md5_ff(r,i,n,s,t[o+5],12,1200080426),s=md5_ff(s,r,i,n,t[o+6],17,-1473231341),n=md5_ff(n,s,r,i,t[o+7],22,-45705983),i=md5_ff(i,n,s,r,t[o+8],7,1770035416),r=md5_ff(r,i,n,s,t[o+9],12,-1958414417),s=md5_ff(s,r,i,n,t[o+10],17,-42063),n=md5_ff(n,s,r,i,t[o+11],22,-1990404162),i=md5_ff(i,n,s,r,t[o+12],7,1804603682),r=md5_ff(r,i,n,s,t[o+13],12,-40341101),s=md5_ff(s,r,i,n,t[o+14],17,-1502002290),n=md5_ff(n,s,r,i,t[o+15],22,1236535329),i=md5_gg(i,n,s,r,t[o+1],5,-165796510),r=md5_gg(r,i,n,s,t[o+6],9,-1069501632),s=md5_gg(s,r,i,n,t[o+11],14,643717713),n=md5_gg(n,s,r,i,t[o+0],20,-373897302),i=md5_gg(i,n,s,r,t[o+5],5,-701558691),r=md5_gg(r,i,n,s,t[o+10],9,38016083),s=md5_gg(s,r,i,n,t[o+15],14,-660478335),n=md5_gg(n,s,r,i,t[o+4],20,-405537848),i=md5_gg(i,n,s,r,t[o+9],5,568446438),r=md5_gg(r,i,n,s,t[o+14],9,-1019803690),s=md5_gg(s,r,i,n,t[o+3],14,-187363961),n=md5_gg(n,s,r,i,t[o+8],20,1163531501),i=md5_gg(i,n,s,r,t[o+13],5,-1444681467),r=md5_gg(r,i,n,s,t[o+2],9,-51403784),s=md5_gg(s,r,i,n,t[o+7],14,1735328473),n=md5_gg(n,s,r,i,t[o+12],20,-1926607734),i=md5_hh(i,n,s,r,t[o+5],4,-378558),r=md5_hh(r,i,n,s,t[o+8],11,-2022574463),s=md5_hh(s,r,i,n,t[o+11],16,1839030562),n=md5_hh(n,s,r,i,t[o+14],23,-35309556),i=md5_hh(i,n,s,r,t[o+1],4,-1530992060),r=md5_hh(r,i,n,s,t[o+4],11,1272893353),s=md5_hh(s,r,i,n,t[o+7],16,-155497632),n=md5_hh(n,s,r,i,t[o+10],23,-1094730640),i=md5_hh(i,n,s,r,t[o+13],4,681279174),r=md5_hh(r,i,n,s,t[o+0],11,-358537222),s=md5_hh(s,r,i,n,t[o+3],16,-722521979),n=md5_hh(n,s,r,i,t[o+6],23,76029189),i=md5_hh(i,n,s,r,t[o+9],4,-640364487),r=md5_hh(r,i,n,s,t[o+12],11,-421815835),s=md5_hh(s,r,i,n,t[o+15],16,530742520),n=md5_hh(n,s,r,i,t[o+2],23,-995338651),i=md5_ii(i,n,s,r,t[o+0],6,-198630844),r=md5_ii(r,i,n,s,t[o+7],10,1126891415),s=md5_ii(s,r,i,n,t[o+14],15,-1416354905),n=md5_ii(n,s,r,i,t[o+5],21,-57434055),i=md5_ii(i,n,s,r,t[o+12],6,1700485571),r=md5_ii(r,i,n,s,t[o+3],10,-1894986606),s=md5_ii(s,r,i,n,t[o+10],15,-1051523),n=md5_ii(n,s,r,i,t[o+1],21,-2054922799),i=md5_ii(i,n,s,r,t[o+8],6,1873313359),r=md5_ii(r,i,n,s,t[o+15],10,-30611744),s=md5_ii(s,r,i,n,t[o+6],15,-1560198380),n=md5_ii(n,s,r,i,t[o+13],21,1309151649),i=md5_ii(i,n,s,r,t[o+4],6,-145523070),r=md5_ii(r,i,n,s,t[o+11],10,-1120210379),s=md5_ii(s,r,i,n,t[o+2],15,718787259),n=md5_ii(n,s,r,i,t[o+9],21,-343485551),i=safe_add(i,a),n=safe_add(n,h),s=safe_add(s,u),r=safe_add(r,c);return[i,n,s,r]}function md5_cmn(t,e,i,n,s,r){return safe_add(bit_rol(safe_add(safe_add(e,t),safe_add(n,r)),s),i)}function md5_ff(t,e,i,n,s,r,o){return md5_cmn(e&i|~e&n,t,e,s,r,o)}function md5_gg(t,e,i,n,s,r,o){return md5_cmn(e&n|i&~n,t,e,s,r,o)}function md5_hh(t,e,i,n,s,r,o){return md5_cmn(e^i^n,t,e,s,r,o)}function md5_ii(t,e,i,n,s,r,o){return md5_cmn(i^(e|~n),t,e,s,r,o)}function safe_add(t,e){var i=(65535&t)+(65535&e);return(t>>16)+(e>>16)+(i>>16)<<16|65535&i}function bit_rol(t,e){return t<<e|t>>>32-e}var ns_egret;!function(t){var e=function(){function e(){this.isUseCapture=!1}return e.prototype.addEventListener=function(e,i,n,s,r){void 0===s&&(s=!1),void 0===r&&(r=0),t.DEBUG&&t.DEBUG.ADD_EVENT_LISTENER&&t.DEBUG.checkAddEventListener(e,i,n,s,r),this._eventDataList||(this._eventDataList=[]);for(var o=-1,a={eventName:e,func:i,thisObj:n,useCapture:s,priority:r},h=this._eventDataList.length,u=0;u<h;u++){var c=this._eventDataList[u];if(c.eventName==e&&c.func==i&&c.thisObj==n&&c.useCapture==s)return;c.priority>=r&&-1==o&&(o=u-1)}-1!=o?this._eventDataList.splice(u-1,0,a):this._eventDataList.unshift(a)},e.prototype.removeEventListener=function(t,e,i,n){if(void 0===n&&(n=!1),this._eventDataList)for(var s=this._eventDataList.length,r=0;r<s;r++){var o=this._eventDataList[r];if(o.eventName==t&&o.func==e&&o.thisObj==i&&o.useCapture==n){this._eventDataList.splice(r,1);break}}},e.prototype.hasEventListener=function(t,e){if(!this._eventDataList)return!1;for(var i=!1,n=this._eventDataList.length,s=0;s<n;s++){var r=this._eventDataList[s];r.eventName==t&&r.thisObj==e&&(i=!0)}return i},e.prototype.dispatchEvent=function(e){for(var i=0;i<arguments.length-1;i++);if(!this._eventDataList)return!1;for(var n=i=!1,s=this._eventDataList.length,r=0;r<s;r++)!(n=this._eventDataList[r])||n.eventName!=e||this instanceof t.DisplayObject&&this.isUseCapture!=n.useCapture||(n=n.func.apply(n.thisObj,arguments),i=i||n);return i},e}();t.EventDispatcher=e}(ns_egret||(ns_egret={}));__extends=this.__extends||function(t,e){function i(){this.constructor=t}for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n]);i.prototype=e.prototype,t.prototype=new i};!function(t){var e=function(e){function i(){e.call(this)}return __extends(i,e),i.prototype.run=function(){t.Ticker.getInstance().run(),t.Ticker.getInstance().register(this.renderLoop,this,Number.MAX_VALUE),t.Ticker.getInstance().register(this.enterFrame,this,Number.MIN_VALUE),this.touchContext.run()},i.prototype.enterFrame=function(){this.dispatchEvent(i.EVENT_ENTER_FRAME)},i.prototype.renderLoop=function(){var t=this.rendererContext;t.clearScreen(),this.dispatchEvent(i.EVENT_START_RENDER),this.stage.updateTransform(),this.stage.draw(t),this.dispatchEvent(i.EVENT_FINISH_RENDER)},i.EVENT_ENTER_FRAME="enter_frame",i.EVENT_START_RENDER="start_render",i.EVENT_FINISH_RENDER="finish_render",i}(t.EventDispatcher);t.MainContext=e}(ns_egret||(ns_egret={})),ns_egret.MainContext.instance=new ns_egret.MainContext,function(t){var e=function(){function e(){this._tick=this._preDrawCount=this._renderPerformanceCost=this._logicPerformanceCost=this._lastFrameTime=this._lastTime=0}return e.getInstance=function(){return null==e.instance&&(e.instance=new e),e.instance},e.prototype.run=function(){t.Ticker.getInstance().register(this.update,this),null==this._txt&&(this._txt=new t.TextField,this._txt.size=28,t.MainContext.instance.stage.addChild(this._txt));var e=t.MainContext.instance;e.addEventListener(t.MainContext.EVENT_ENTER_FRAME,this.onEnterFrame,this),e.addEventListener(t.MainContext.EVENT_START_RENDER,this.onStartRender,this),e.addEventListener(t.MainContext.EVENT_FINISH_RENDER,this.onFinishRender,this)},e.prototype.onEnterFrame=function(){this._lastTime=t.Ticker.now()},e.prototype.onStartRender=function(){var e=t.Ticker.now();this._logicPerformanceCost=e-this._lastTime,this._lastTime=e},e.prototype.onFinishRender=function(){var e=t.Ticker.now();this._renderPerformanceCost=e-this._lastTime,this._lastTime=e},e.prototype.update=function(){var e=(i=t.Ticker.now())-this._lastFrameTime;if(this._lastFrameTime=i,this._tick++,6==this._tick){this._tick=0;var i=(this._preDrawCount-1).toString(),n=t.MainContext.instance.rendererContext.renderCost.toString(),n=Math.ceil(this._logicPerformanceCost).toString()+","+Math.ceil(this._renderPerformanceCost).toString()+","+n;this._txt.text=i+"\n"+n+"\n"+Math.floor(1e3/e).toString()}this._preDrawCount=0},e.prototype.onDrawImage=function(){this._preDrawCount++},e}();t.Profiler=e}(ns_egret||(ns_egret={})),__extends=this.__extends||function(t,e){function i(){this.constructor=t}for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n]);i.prototype=e.prototype,t.prototype=new i},function(t){var e=function(e){function i(){e.apply(this,arguments),this._timeScale=1,this._paused=!1,this._frameRate=60}return __extends(i,e),i.prototype.run=function(){this._time=i.now(),i.requestAnimationFrame.call(window,this.enterFrame)},i.prototype.enterFrame=function(){i.requestAnimationFrame.call(window,i.instance.enterFrame),i.instance.update()},i.prototype.update=function(){if(this._eventDataList&&!this._paused){for(var e=i.now(),n=this._eventDataList.length,s=0;s<n;s++){var r=this._eventDataList[s];if(r&&"enterFrame"==r.eventName&&(!(this instanceof t.DisplayObject)||this.isUseCapture==r.useCapture)){var o=(o=e-this._time)*this._timeScale;r.func.apply(r.thisObj,[o])}}this._time=e}},i.prototype.register=function(t,i,n){void 0===n&&(n=0),e.prototype.addEventListener.call(this,"enterFrame",t,i,!1,n)},i.prototype.unregister=function(t,i){e.prototype.removeEventListener.call(this,"enterFrame",t,i,!1)},i.prototype.callLater=function(t,e,i){void 0===i&&(i=0);var n=this,s=0;this.register(function(r){0==i?(n.unregister(arguments.callee,e),t.apply(e)):(s+=r)>=i&&(n.unregister(arguments.callee,e),t.apply(e))},e)},i.prototype.setTimeScale=function(t){this._timeScale=t},i.prototype.getTimeScale=function(){return this._timeScale},i.prototype.pause=function(){this._paused=!0},i.prototype.resume=function(){this._paused=!1},i.prototype.getFrameRate=function(){return this._frameRate},i.getInstance=function(){return null==i.instance&&(i.instance=new i),i.instance},i.now=function(){return(new Date).getTime()},i.requestAnimationFrame=window.requestAnimationFrame||window.webkitRequestAnimationFrame||window.mozRequestAnimationFrame||window.oRequestAnimationFrame||window.msRequestAnimationFrame||function(t){return window.setTimeout(t,1e3/i.getInstance().getFrameRate())},i}(t.EventDispatcher);t.Ticker=e}(ns_egret||(ns_egret={})),__extends=this.__extends||function(t,e){function i(){this.constructor=t}for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n]);i.prototype=e.prototype,t.prototype=new i},function(t){var e=function(e){function i(t,i){void 0===t&&(t=1e3),void 0===i&&(i=-1),e.call(this),this._actionInterval=t,this._totalActionTimes=i}return __extends(i,e),i.prototype.start=function(){this._preTime=t.Ticker.now(),0!=this._actionTimes&&(this._actionTimes=0),t.Ticker.getInstance().register(this.onEnterFrame,this)},i.prototype.stop=function(){t.Ticker.getInstance().unregister(this.onEnterFrame,this)},i.prototype.onEnterFrame=function(){var e=t.Ticker.now();for(this._passTime=e-this._preTime;this._passTime>this._actionInterval;){if(this._passTime-=this._actionInterval,this.dispatchEvent(i.ON_TIMER),this._actionTimes++,-1!=this._actionTimes&&this._actionTimes>=this._totalActionTimes){this.stop();break}this._preTime=e}},i.ON_TIMER="onTimer",i}(t.EventDispatcher);t.Timer=e}(ns_egret||(ns_egret={})),function(t){var e=function(){function t(t,e,i,n){this.x=t,this.y=e,this.width=i,this.height=n}return t.prototype.initialize=function(t,e,i,n){return this.x=t,this.y=e,this.width=i,this.height=n,this},t.prototype.containPoint=function(t,e){return this.x<=t&&this.x+this.width>=t&&this.y<=e&&this.y+this.height>=e},t.prototype.clone=function(){return new t(this.x,this.y,this.width,this.height)},t.identity=new t(0,0,0,0),t}();t.Rectangle=e,e=function(){function t(t,e,i,n,s,r){void 0===t&&(t=1),void 0===e&&(e=0),void 0===i&&(i=0),void 0===n&&(n=1),void 0===s&&(s=0),void 0===r&&(r=0),this.a=t,this.b=e,this.c=i,this.d=n,this.tx=s,this.ty=r}return t.prototype.prepend=function(t,e,i,n,s,r){var o=this.tx;if(1!=t||0!=e||0!=i||1!=n){var a=this.a,h=this.c;this.a=a*t+this.b*i,this.b=a*e+this.b*n,this.c=h*t+this.d*i,this.d=h*e+this.d*n}return this.tx=o*t+this.ty*i+s,this.ty=o*e+this.ty*n+r,this},t.prototype.append=function(t,e,i,n,s,r){var o=this.a,a=this.b,h=this.c,u=this.d;return this.a=t*o+e*h,this.b=t*a+e*u,this.c=i*o+n*h,this.d=i*a+n*u,this.tx=s*o+r*h+this.tx,this.ty=s*a+r*u+this.ty,this},t.prototype.prependMatrix=function(t){return this.prepend(t.a,t.b,t.c,t.d,t.tx,t.ty),this},t.prototype.appendMatrix=function(t){return this.append(t.a,t.b,t.c,t.d,t.tx,t.ty),this},t.prototype.prependTransform=function(e,i,n,s,r,o,a,h,u){if(r%360){var c=r*t.DEG_TO_RAD;r=Math.cos(c),c=Math.sin(c)}else r=1,c=0;return(h||u)&&(this.tx-=h,this.ty-=u),o||a?(o*=t.DEG_TO_RAD,a*=t.DEG_TO_RAD,this.prepend(r*n,c*n,-c*s,r*s,0,0),this.prepend(Math.cos(a),Math.sin(a),-Math.sin(o),Math.cos(o),e,i)):this.prepend(r*n,c*n,-c*s,r*s,e,i),this},t.prototype.appendTransform=function(e,i,n,s,r,o,a,h,u){if(r%360){var c=r*t.DEG_TO_RAD;r=Math.cos(c),c=Math.sin(c)}else r=1,c=0;return o||a?(o*=t.DEG_TO_RAD,a*=t.DEG_TO_RAD,this.append(Math.cos(a),Math.sin(a),-Math.sin(o),Math.cos(o),e,i),this.append(r*n,c*n,-c*s,r*s,0,0)):this.append(r*n,c*n,-c*s,r*s,e,i),(h||u)&&(this.tx-=h*this.a+u*this.c,this.ty-=h*this.b+u*this.d),this},t.prototype.appendTransformFromDisplay=function(t){var e,i;return 0!=t.relativeAnchorPointX||0!=t.relativeAnchorPointY?(i=t.getBounds(),e=i.width*t.relativeAnchorPointX,i=i.height*t.relativeAnchorPointY):(e=t.anchorPointX,i=t.anchorPointY),this.identity(),this.appendTransform(t.x,t.y,t.scaleX,t.scaleY,t.rotation,t.skewX,t.skewY,e,i),this},t.prototype.rotate=function(t){var e=Math.cos(t);t=Math.sin(t);var i=this.a,n=this.c,s=this.tx;return this.a=i*e-this.b*t,this.b=i*t+this.b*e,this.c=n*e-this.d*t,this.d=n*t+this.d*e,this.tx=s*e-this.ty*t,this.ty=s*t+this.ty*e,this},t.prototype.skew=function(e,i){return e*=t.DEG_TO_RAD,i*=t.DEG_TO_RAD,this.append(Math.cos(i),Math.sin(i),-Math.sin(e),Math.cos(e),0,0),this},t.prototype.scale=function(t,e){return this.a*=t,this.d*=e,this.c*=t,this.b*=e,this.tx*=t,this.ty*=e,this},t.prototype.translate=function(t,e){return this.tx+=t,this.ty+=e,this},t.prototype.identity=function(){return this.a=this.d=1,this.b=this.c=this.tx=this.ty=0,this},t.prototype.invert=function(){var t=this.a,e=this.b,i=this.c,n=this.d,s=this.tx,r=t*n-e*i;return this.a=n/r,this.b=-e/r,this.c=-i/r,this.d=t/r,this.tx=(i*this.ty-n*s)/r,this.ty=-(t*this.ty-e*s)/r,this},t.prototype.isIdentity=function(){return 0==this.tx&&0==this.ty&&1==this.a&&0==this.b&&0==this.c&&1==this.d},t.prototype.transformPoint=function(t,e,i){return i=i||{},i.x=t*this.a+e*this.c+this.tx,i.y=t*this.b+e*this.d+this.ty,i},t.prototype.decompose=function(e){null==e&&(e={}),e.x=this.tx,e.y=this.ty,e.scaleX=Math.sqrt(this.a*this.a+this.b*this.b),e.scaleY=Math.sqrt(this.c*this.c+this.d*this.d);var i=Math.atan2(-this.c,this.d),n=Math.atan2(this.b,this.a);return i==n?(e.rotation=n/t.DEG_TO_RAD,0>this.a&&0<=this.d&&(e.rotation+=0>=e.rotation?180:-180),e.skewX=e.skewY=0):(e.skewX=i/t.DEG_TO_RAD,e.skewY=n/t.DEG_TO_RAD),e},t.transformCoords=function(t,e,n){var s=new i(0,0);return s.x=t.a*e+t.c*n+t.tx,s.y=t.d*n+t.b*e+t.ty,s},t.identity=new t,t.DEG_TO_RAD=Math.PI/180,t}(),t.Matrix2D=e;var i=function(){function t(t,e){this.x=t,this.y=e}return t.identity=new t(0,0),t}();t.Point=i}(ns_egret||(ns_egret={})),function(t){var e=function(){function e(){}return e.fatal=function(e,i){throw void 0===i&&(i=null),t.Logger.traceToConsole("Fatal",e,i),Error(t.Logger.getTraceCode("Fatal",e,i))},e.info=function(e,i){void 0===i&&(i=null),t.Logger.traceToConsole("Info",e,i)},e.warning=function(e,i){void 0===i&&(i=null),t.Logger.traceToConsole("Warning",e,i)},e.traceToConsole=function(e,i,n){console.log(t.Logger.getTraceCode(e,i,n))},e.getTraceCode=function(t,e,i){return"["+t+"]"+e+":"+(null==i?"":i)},e}();t.Logger=e}(ns_egret||(ns_egret={})),function(t){var e=function(){function t(){}return t.CENTER="center",t.LEFT="left",t.RIGHT="right",t.TOP="top",t.BOTTOM="bottom",t.BOTH="both",t.HORIZONTAL="horizontal",t.VERTICAL="vertical",t}();t.Direction=e}(ns_egret||(ns_egret={})),function(t){var e=function(){function t(){throw Error("can't create a mixin class")}return t.prototype.onActivity=function(){},t.prototype.onCancel=function(){},t}();t.ComponentBase=e,e=function(){function t(){}return t.active=function(t,e){var i,n=e.prototype;for(i in n)null==t[i]?t[i]=n[i]:console.log("warning",i);t.onActivity()},t}(),t.MixIn=e}(ns_egret||(ns_egret={})),__extends=this.__extends||function(t,e){function i(){this.constructor=t}for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n]);i.prototype=e.prototype,t.prototype=new i},function(t){var e=function(){function e(){this._originalDesignHeight=this._originalDesignWidth=this._designHeight=this._designWidth=this._frameHeight=this._frameWidth=null,this._scaleY=this._scaleX=1,this._resolutionPolicy=this._frame=null,this._frame=document.getElementById(e.canvas_div_name),this._frameWidth=this._frame.style.width,this._frameHeight=this._frame.style.height;var t=(i=document.getElementById(e.canvas_name)).width,i=i.height;this._designWidth=t,this._designHeight=i,this._originalDesignWidth=t,this._originalDesignHeight=i}return e.getInstance=function(){return null==e.instance&&(n.initialize(),r.initialize(),e.instance=new e),e.instance},e.prototype.setFrameSize=function(t,e){this._frameWidth=t,this._frameHeight=e,this._frame.style.width=t+"px",this._frame.style.height=e+"px",this._resizeEvent()},e.prototype._resizeEvent=function(){var t=this._originalDesignWidth,e=this._originalDesignHeight;0<t&&this.setDesignSize(t,e,this._resolutionPolicy)},e.prototype.setDesignSize=function(e,i,n){isNaN(e)||0==e||isNaN(i)||0==i?t.Logger.info("Resolution Error"):(this.setResolutionPolicy(n),this._designWidth=e,this._designHeight=i,this._originalDesignWidth=e,this._originalDesignHeight=i,this._resolutionPolicy.apply(this,this._designWidth,this._designHeight),t.MainContext.instance.stage.stageWidth=this._designWidth,t.MainContext.instance.stage.stageHeight=this._designHeight)},e.prototype.setResolutionPolicy=function(e){if(e instanceof i)this._resolutionPolicy=e;else switch(e){case i.FIXED_HEIGHT:this._resolutionPolicy=new i(n.EQUAL_TO_FRAME,r.FIXED_HEIGHT);break;case i.FIXED_WIDTH:this._resolutionPolicy=new i(n.EQUAL_TO_FRAME,r.FIXED_WIDTH)}null!=this._resolutionPolicy?this._resolutionPolicy.init(this):t.Logger.fatal("需要先设置resolutionPolicy")},e.prototype.getScaleX=function(){return this._scaleX},e.prototype.getScaleY=function(){return this._scaleY},e.canvas_name="gameCanvas",e.canvas_div_name="gameDiv",e}();t.StageDelegate=e;var i=function(){function t(t,e){this._contentStrategy=this._containerStrategy=null,this.setContainerStrategy(t),this.setContentStrategy(e)}return t.prototype.init=function(t){this._containerStrategy.init(t),this._contentStrategy.init(t)},t.prototype.apply=function(t,e,i){return this._containerStrategy.apply(t,e,i),this._contentStrategy.apply(t,e,i)},t.prototype.setContainerStrategy=function(t){t instanceof n&&(this._containerStrategy=t)},t.prototype.setContentStrategy=function(t){t instanceof r&&(this._contentStrategy=t)},t.FIXED_HEIGHT=1,t.FIXED_WIDTH=2,t}();t.ResolutionPolicy=i;var n=function(){function t(){}return t.initialize=function(){t.EQUAL_TO_FRAME=new s},t.prototype.init=function(t){},t.prototype.apply=function(t,e,i){},t.prototype._setupContainer=function(t,i,n){document.getElementById(e.canvas_name),document.getElementById(e.canvas_div_name);var s;(t=document.body)&&(s=t.style)&&(s.paddingTop=s.paddingTop||"0px",s.paddingRight=s.paddingRight||"0px",s.paddingBottom=s.paddingBottom||"0px",s.paddingLeft=s.paddingLeft||"0px",s.borderTop=s.borderTop||"0px",s.borderRight=s.borderRight||"0px",s.borderBottom=s.borderBottom||"0px",s.borderLeft=s.borderLeft||"0px",s.marginTop=s.marginTop||"0px",s.marginRight=s.marginRight||"0px",s.marginBottom=s.marginBottom||"0px",s.marginLeft=s.marginLeft||"0px")},t.prototype._fixContainer=function(){document.body.insertBefore(document.getElementById(e.canvas_div_name),document.body.firstChild);var t=document.body.style;t.width=window.innerWidth+"px",t.height=window.innerHeight+"px",t.overflow="hidden",(t=document.getElementById(e.canvas_div_name).style).position="fixed",t.left=t.top="0px",document.body.scrollTop=0},t.EQUAL_TO_FRAME=null,t}();t.ContainerStrategy=n;var s=function(t){function e(){t.apply(this,arguments)}return __extends(e,t),e.prototype.apply=function(t){this._setupContainer(t._frame,t._frameWidth,t._frameHeight)},e}(n);t.EqualToFrame=s;var r=function(){function t(){this._result={scale:[1,1],x:null,y:null,w:null,h:null}}return t.initialize=function(){t.FIXED_HEIGHT=new o,t.FIXED_WIDTH=new a},t.prototype.init=function(t){},t.prototype.apply=function(t,e,i){return{scale:[1,1]}},t.FIXED_HEIGHT=null,t.FIXED_WIDTH=null,t}();t.ContentStrategy=r;var o=function(t){function i(){t.apply(this,arguments)}return __extends(i,t),i.prototype.apply=function(t,i,n){var s=document.getElementById(e.canvas_name),r=document.getElementById(e.canvas_div_name),o=s.height/n,a=window.innerHeight,h=i*(o=a/n);s.width=i,s.height=n,s.style.width=h+"px",s.style.height=a+"px",r.style.width=h+"px",r.style.height=a+"px",t._scaleX=o,t._scaleY=o},i}(r);t.FixedHeight=o;var a=function(t){function i(){t.apply(this,arguments)}return __extends(i,t),i.prototype.apply=function(t,i,n){n=document.getElementById(e.canvas_name);var s=document.getElementById(e.canvas_div_name),r=document.documentElement.clientWidth,o=document.documentElement.clientHeight,a=r/i;n.width=i,n.height=o/a,n.style.width=r+"px",n.style.height=o+"px",s.style.width=r+"px",s.style.height=o+"px",t._scaleX=a,t._scaleY=a},i}(r);t.FixedWidth=a;var h=function(t){function i(t,e){this.width=t,this.height=e}return __extends(i,r),i.prototype.apply=function(t,i,n){n=document.getElementById(e.canvas_name);var s=document.getElementById(e.canvas_div_name),r=this.width,o=this.height,a=r/i;n.width=i,n.height=o/a,n.style.width=r+"px",n.style.height=o+"px",s.style.width=r+"px",s.style.height=o+"px",t._scaleX=a,t._scaleY=a},i}();t.FixedSize=h}(ns_egret||(ns_egret={})),__extends=this.__extends||function(t,e){function i(){this.constructor=t}for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n]);i.prototype=e.prototype,t.prototype=new i},function(t){var e=function(e){function n(){e.call(this),this.parent=null,this.scaleY=this.scaleX=1,this.rotation=this.relativeAnchorPointY=this.relativeAnchorPointX=this.anchorPointY=this.anchorPointX=0,this.alpha=1,this.skewY=this.skewX=0,this._isRunning=!1,this.x=this.y=0,this.visible=!0,this.worldTransform=new t.Matrix2D,this.worldAlpha=1}return __extends(n,e),n.prototype.draw=function(t){this.visible&&!unstable.cache_api.draw.call(this,t)&&(t.setAlpha(this.worldAlpha,this.blendMode),t.setTransform(this.worldTransform),this.mask&&(t.save(),t.clip(this.mask.x,this.mask.y,this.mask.width,this.mask.height)),this.render(t),this.mask&&t.restore())},n.prototype.updateTransform=function(){this.worldTransform.identity(),this.worldTransform=this.worldTransform.appendMatrix(this.parent.worldTransform);var t,e;0!=this.relativeAnchorPointX||0!=this.relativeAnchorPointY?(e=this.getBounds(),t=e.width*this.relativeAnchorPointX,e=e.height*this.relativeAnchorPointY):(t=this.anchorPointX,e=this.anchorPointY),this.worldTransform.appendTransform(this.x,this.y,this.scaleX,this.scaleY,this.rotation,this.skewX,this.skewY,t,e),this.worldAlpha=this.parent.worldAlpha*this.alpha},n.prototype.render=function(t){},n.prototype.ignoreRender=function(){var e=n.getTransformBounds(this.getBounds(),this.worldTransform);return 0>=e.x+e.width||e.x>=t.MainContext.instance.stage.stageWidth||0>=e.y+e.height||e.y>=t.MainContext.instance.stage.stageHeight},n.prototype.getBounds=function(){if(void 0!==this._contentWidth){var e,i;return 0!=this.relativeAnchorPointX||0!=this.relativeAnchorPointY?(e=this._contentWidth*this.relativeAnchorPointX,i=this._contentHeight*this.relativeAnchorPointY):(e=this.anchorPointX,i=this.anchorPointY),t.Rectangle.identity.initialize(-e,-i,this._contentWidth,this._contentHeight)}return this._measureBounds()},n.prototype.setContentSize=function(t,e){this._contentWidth=t,this._contentHeight=e},n.prototype.getConcatenatedMatrix=function(){for(var e=t.Matrix2D.identity.identity(),i=this;null!=i;){if(0!=i.relativeAnchorPointX||0!=i.relativeAnchorPointY){var n=i.getBounds();e.prependTransform(i.x,i.y,i.scaleX,i.scaleY,i.rotation,i.skewX,i.skewY,n.width*i.relativeAnchorPointX,n.height*i.relativeAnchorPointY)}else e.prependTransform(i.x,i.y,i.scaleX,i.scaleY,i.rotation,i.skewX,i.skewY,i.anchorPointX,i.anchorPointY);i=i.parent}return e},n.prototype.localToGlobal=function(e,i){void 0===e&&(e=0),void 0===i&&(i=0);var n=this.getConcatenatedMatrix();n.append(1,0,0,1,e,i);var s=t.Point.identity;return s.x=n.tx,s.y=n.ty,s},n.prototype.globalToLocal=function(e,i){void 0===e&&(e=0),void 0===i&&(i=0);var n=this.getConcatenatedMatrix();n.invert(),n.append(1,0,0,1,e,i);var s=t.Point.identity;return s.x=n.tx,s.y=n.ty,s},n.prototype.hitTest=function(t,e,i){return void 0===i&&(i=!1),this.visible&&(i||this.touchEnabled)?(i=this.getBounds(),0<t&&t<i.width&&0<e&&e<i.height?this.mask?this.mask.x<t&&t<this.mask.x+this.mask.width&&this.mask.y<e&&e<this.mask.y+this.mask.height?this:null:this:null):null},n.prototype.getMatrix=function(){return t.Matrix2D.identity.identity().appendTransformFromDisplay(this)},n.prototype._measureBounds=function(){return t.Logger.fatal("子类需要实现的方法"),t.Rectangle.identity},n.prototype.setAnchorPoint=function(t,e){this.anchorPointX=t,this.anchorPointY=e},n.prototype.setRelativeAnchorPoint=function(e,i){0>e||1<e||0>i||1<i?t.Logger.warning("相对锚点只接受0-1之间的值"):(this.relativeAnchorPointX=e,this.relativeAnchorPointY=i)},n.prototype.getOffsetPoint=function(){var e=this.anchorPointX,i=this.anchorPointY;0==this.relativeAnchorPointX&&0==this.relativeAnchorPointY||(i=this.getBounds(),e=this.relativeAnchorPointX*i.width,i=this.relativeAnchorPointY*i.height);var n=t.Point.identity;return n.x=e,n.y=i,n},n.prototype.removeFromParent=function(){this&&this.parent&&this.parent.removeChild(this)},n.prototype._onAddToStage=function(){this._isRunning=!0,this.dispatchEvent(i.ADD_TO_STAGE)},n.prototype._onRemoveFromStage=function(){this._isRunning=!1,this.dispatchEvent(i.REMOVE_FROM_STAGE)},n.prototype.isRunning=function(){return this._isRunning},n.getTransformBounds=function(t,e){var i=t.x,n=t.y,s=t.width,r=t.height,o=s*e.a,s=s*e.b,a=r*e.c,r=r*e.d,h=e.tx,u=e.ty,c=h,l=h,d=u,p=u;return(i=o+h)<c?c=i:i>l&&(l=i),(i=o+a+h)<c?c=i:i>l&&(l=i),(i=a+h)<c?c=i:i>l&&(l=i),(n=s+u)<d?d=n:n>p&&(p=n),(n=s+r+u)<d?d=n:n>p&&(p=n),(n=r+u)<d?d=n:n>p&&(p=n),t.initialize(c,d,l-c,p-d)},n}(t.EventDispatcher);t.DisplayObject=e;var i=function(){function t(){}return t.ADD_TO_STAGE="addToStage",t.REMOVE_FROM_STAGE="removeFromStage",t}();t.DisplayListEvent=i}(ns_egret||(ns_egret={}));var unstable=unstable||{};unstable.cache_api={},unstable.cache_api.cacheAsBitmap=function(t){t&&((t=new ns_egret.RenderTexture).drawToTexture(this),this.renderTexture=t)},unstable.cache_api.draw=function(t){if(this.renderTexture){var e=(s=this.renderTexture).offsetX,i=s.offsetY,n=s.getTextureWidth(),s=s.getTextureHeight();return this.updateTransform(),t.setAlpha(this.worldAlpha,this.blendMode),t.setTransform(this.worldTransform),this.mask&&(t.save(),t.clip(this.mask.x,this.mask.y,this.mask.width,this.mask.height)),t.drawImage(this.renderTexture,0,0,n,s,e,i,n/ns_egret.MainContext.instance.rendererContext.texture_scale_factor,s/ns_egret.MainContext.instance.rendererContext.texture_scale_factor),this.mask&&t.restore(),!0}return!1},ns_egret.DisplayObject.prototype.cacheAsBitmap=unstable.cache_api.cacheAsBitmap,__extends=this.__extends||function(t,e){function i(){this.constructor=t}for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n]);i.prototype=e.prototype,t.prototype=new i},function(t){var e=function(e){function i(){this._children=[],this.numChildren=0,e.call(this)}return __extends(i,e),i.prototype.setChildIndex=function(e,i){var n=this._children.indexOf(e);0>n&&t.Logger.fatal("child不在当前容器内"),this._children.splice(n,1),0>i||this._children.length<=i?this._children.push(e):this._children.splice(i,0,e)},i.prototype.addChild=function(e,i){void 0===i&&(i=-1),null!=e.parent?t.Logger.fatal("child已经被添加到显示列表"):this._children.length<i&&t.Logger.fatal("提供的索引超出范围"),-1==i?this._children.push(e):0<=i?this._children.splice(i,0,e):t.Logger.fatal("提供的索引超出范围"),e.parent=this,this.isRunning()&&e._onAddToStage(),this.numChildren++},i.prototype.removeChild=function(e){0<=(e=this._children.indexOf(e))?this.removeChildAt(e):t.Logger.fatal("child未被addChild到该parent")},i.prototype.removeChildAt=function(e){var i=this._children;0<=e&&e<i.length?(e=i.splice(e,1)[0],e.parent=null,this.isRunning()&&e._onRemoveFromStage(),this.numChildren--):t.Logger.fatal("child未被addChild到该parent")},i.prototype.getChildAt=function(t){return this._children[t]},i.prototype.getChildByName=function(t){return null},i.prototype.getChildIndex=function(t){return this._children.indexOf(t)},i.prototype.removeAllChildren=function(){for(var t=this._children;0<t.length;){var e=t.pop();e.parent=null,this.isRunning()&&e._onRemoveFromStage()}this.numChildren=0},i.prototype.updateTransform=function(){if(this.visible){e.prototype.updateTransform.call(this);for(var t=0,i=this._children.length;t<i;t++)this._children[t].updateTransform()}},i.prototype.render=function(t){if(this.visible)for(var e=0,i=this._children.length;e<i;e++)this._children[e].draw(t)},i.prototype._measureBounds=function(){for(var e=0,i=0,n=0,s=0,r=this._children.length,o=0;o<r;o++){var a;if((h=this._children[o]).visible&&(a=t.DisplayObject.getTransformBounds(h.getBounds(),h.getMatrix()))){var h=a.x,u=a.y,c=a.width+a.x,l=a.height+a.y;(h<e||0==o)&&(e=h),(c>i||0==o)&&(i=c),(u<n||0==o)&&(n=u),(l>s||0==o)&&(s=l)}}return t.Rectangle.identity.initialize(e,n,i-e,s-n)},i.prototype.hitTest=function(e,i){var n;if(!this.visible||this.mask&&(this.mask.x>e||e>this.mask.x+this.mask.width||this.mask.y>i||i>this.mask.y+this.mask.height))return null;for(var s=this._children,r=s.length-1;0<=r;r--){var o=s[r],a=o,h=a.getOffsetPoint();if((a=t.Matrix2D.identity.identity().prependTransform(a.x,a.y,a.scaleX,a.scaleY,a.rotation,0,0,h.x,h.y)).invert(),a=t.Matrix2D.transformCoords(a,e,i),o=o.hitTest(a.x,a.y,!0)){if(o.touchEnabled)return o;if(this.touchEnabled)return this;null==n&&(n=o)}}return n},i.prototype._onAddToStage=function(){e.prototype._onAddToStage.call(this);for(var t=0;t<this.numChildren;t++)this._children[t]._onAddToStage()},i.prototype._onRemoveFromStage=function(){e.prototype._onRemoveFromStage.call(this);for(var t=0;t<this.numChildren;t++)this._children[t]._onRemoveFromStage()},i}(t.DisplayObject);t.DisplayObjectContainer=e}(ns_egret||(ns_egret={})),(unstable=unstable||{}).modal_api={},unstable.modal_api.setModal=function(t){void 0==t&&(t=!0),this.touchEnabled=this._modal=t};var hitTest=ns_egret.DisplayObjectContainer.prototype.hitTest;ns_egret.DisplayObjectContainer.prototype.hitTest=function(t,e){if(0==this.visible)return null;var i=hitTest.call(this,t,e);return this._modal?i||this:i},ns_egret.DisplayObjectContainer.prototype.setModal=unstable.modal_api.setModal,__extends=this.__extends||function(t,e){function i(){this.constructor=t}for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n]);i.prototype=e.prototype,t.prototype=new i},function(t){var e=function(e){function i(){e.call(this),this._isRunning=this.touchEnabled=!0;var i=document.getElementById(t.StageDelegate.canvas_name);this.stageWidth=i.width,this.stageHeight=i.height}return __extends(i,e),i.prototype.hitTest=function(e,i){if(!this.touchEnabled)return null;var n;if(!this.visible)return this;for(var s=this._children,r=s.length-1;0<=r;r--){var o=n=s[r],a=o.getOffsetPoint();if((o=t.Matrix2D.identity.identity().prependTransform(o.x,o.y,o.scaleX,o.scaleY,o.rotation,0,0,a.x,a.y)).invert(),o=t.Matrix2D.transformCoords(o,e,i),(n=n.hitTest(o.x,o.y,!0))&&n.touchEnabled)return n}return this},i.prototype.getBounds=function(){return t.Rectangle.identity.initialize(0,0,1e5,1e5)},i.prototype.updateTransform=function(){for(var t=0,e=this._children.length;t<e;t++)this._children[t].updateTransform()},i}(t.DisplayObjectContainer);t.Stage=e}(ns_egret||(ns_egret={})),__extends=this.__extends||function(t,e){function i(){this.constructor=t}for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n]);i.prototype=e.prototype,t.prototype=new i},function(t){var e=function(e){function i(){e.call(this),this.debug=!1,this.debugColor="#ff0000"}return __extends(i,e),i.initWithTexture=function(t){if(null==t)throw Error("texture 取不到 ");var e=new i;return e.texture=t,e},i.prototype.render=function(t){if(!e.prototype.ignoreRender.call(this)){var n=this.texture;if(null!=n&&null!=n._bitmapData){var s,r,o,a;this.spriteFrame?(a=this.spriteFrame,s=a.x,r=a.y,o=a.w,a=a.h):(r=s=0,o=n.getTextureWidth(),a=n.getTextureHeight()),t.drawImage(n,s,r,o,a,0,0,o,a),(i.debug||this.debug)&&t.strokeRect(s,r,o,a,this.debugColor)}}},i.prototype._measureBounds=function(){var e,i,n=this.spriteFrame;n?(e=n.w,i=n.h):this.texture?(e=this.texture.getTextureWidth(),i=this.texture.getTextureHeight()):t.Logger.fatal("获取BitmapBounds失败");var s;return 0!=this.relativeAnchorPointX||0!=this.relativeAnchorPointY?(n=e*this.relativeAnchorPointX,s=i*this.relativeAnchorPointY):(n=this.anchorPointX,s=this.anchorPointY),t.Rectangle.identity.initialize(-n,-s,e,i)},i.debug=!1,i}(t.DisplayObject);t.Bitmap=e}(ns_egret||(ns_egret={})),__extends=this.__extends||function(t,e){function i(){this.constructor=t}for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n]);i.prototype=e.prototype,t.prototype=new i},function(t){var e=function(e){function i(){e.call(this),this.text=""}return __extends(i,e),i.prototype.render=function(t){this.text&&(this.text=this.text.toString(),this._renderText(t))},i.prototype._renderText=function(e,i){void 0===i&&(i=!1);for(var n=this._contentHeight=this._contentWidth=0,s=this.text.length;n<s;n++){var r=this.text.charAt(n),o=this.bitmapFontData[r];null==o&&t.Logger.fatal("BitmapText：异常的bitmapFontData: ",r);var r=o.offX,a=o.offY,h=o.w;i||(e.drawImage(this.texture,o.x,o.y,o.w,o.h,r,a,o.w,o.h),e.translate(h,0)),this._contentWidth+=h+r,a+o.h>this._contentHeight&&(this._contentHeight=a+o.h)}},i.prototype.getBounds=function(){this._renderText(t.MainContext.instance.rendererContext,!0);var e,i;return 0!=this.relativeAnchorPointX||0!=this.relativeAnchorPointY?(e=this._contentWidth*this.relativeAnchorPointX,i=this._contentHeight*this.relativeAnchorPointY):(e=this.anchorPointX,i=this.anchorPointY),t.Rectangle.identity.initialize(-e,-i,this._contentWidth,this._contentHeight)},i}(t.DisplayObject);t.BitmapText=e}(ns_egret||(ns_egret={})),__extends=this.__extends||function(t,e){function i(){this.constructor=t}for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n]);i.prototype=e.prototype,t.prototype=new i},function(t){var e=function(t){function e(){t.apply(this,arguments)}return __extends(e,t),e.prototype.hitTest=function(e,i){return t.prototype.hitTest.call(this,e,i)},e}(t.DisplayObject);t.Shape=e,e=function(t){function e(){this._color=16777215,this._colorDirty=!0,t.call(this)}return __extends(e,t),Object.defineProperty(e.prototype,"color",{get:function(){return this._color},set:function(t){this._colorDirty=!0,this._color=t},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"alpha",{get:function(){return this._alpha},set:function(t){this._colorDirty=!0,this._alpha=t},enumerable:!0,configurable:!0}),e.prototype.render=function(t){if(this._colorDirty){var e=this._color;this._colorBlue=255&e,this._colorGreen=(65280&e)>>8,this._colorRed=e>>16,this._colorStr="rgba("+this._colorRed+","+this._colorGreen+","+this._colorBlue+","+this._alpha+")",this._colorDirty=!1}(t=t.canvas.getContext("2d")).fillStyle=this._colorStr,t.fillRect(0,0,this._contentWidth,this._contentHeight)},e}(t.Shape),t.ShapeRect=e}(ns_egret||(ns_egret={})),__extends=this.__extends||function(t,e){function i(){this.constructor=t}for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n]);i.prototype=e.prototype,t.prototype=new i},function(t){var e=function(e){function i(){e.call(this),this.font="Arial",this.size=30,this.textColor="#ffffff",this.strokeColor="#000000",this.stroke=0,this.__hackIgnoreDrawText=!1,this.hSpacing=this.vSpacing=0,this.textAlign="left"}return __extends(i,e),i.prototype.render=function(t){this.text&&(t.setupFont(this.size+"px "+this.font,this.textAlign,this.textBaseline),this.drawText(t))},i.prototype.getBounds=function(){var e=t.MainContext.instance.rendererContext;e.setupFont(this.size+"px "+this.font,this.textAlign,this.textBaseline),this.drawText(e,!0);var i;return 0!=this.relativeAnchorPointX||0!=this.relativeAnchorPointY?(e=this._contentWidth*this.relativeAnchorPointX,i=this._contentHeight*this.relativeAnchorPointY):(e=this.anchorPointX,i=this.anchorPointY),t.Rectangle.identity.initialize(-e,-i,this._contentWidth,this._contentHeight)},i.prototype.drawText=function(t,i){void 0===i&&(i=!1),i&&(this.__hackIgnoreDrawText=!0);var n=0,s=String(this.text).split(/(?:\r\n|\r|\n)/),r=0,o=this.size+this.vSpacing,a=0;if(null==this.lineWidth||0==this.lineWidth){for(var h=0,u=a=s.length;h<u;h++){d=s[h];(c=t.measureText(d)).width>n&&(n=c.width)}for(h=0,u=a;h<u;h++)d=s[h],this._drawTextLine(t,d,r,n),r+=o}else for(n=this.lineWidth,h=0,u=s.length;h<u;h++){if(d=s[h],(c=t.measureText(d)).width>this.lineWidth)for(var c=d,l=0,d="",p=0;p<c.length;p++){var _=t.measureText(c[p]).width;l+_>this.lineWidth?0==l?(l+=_,d+=c[p],n=_):(this._drawTextLine(t,d,r,n),a++,p--,d="",l=0,r+=o):(l+=_,d+=c[p])}this._drawTextLine(t,d,r,n),a++,r+=o}return i&&(e.prototype.setContentSize.call(this,n,a*o),this.__hackIgnoreDrawText=!1),null},i.prototype.setContentSize=function(t,i){e.prototype.setContentSize.call(this,t,i),this.lineWidth=t},i.prototype._drawTextLine=function(t,e,i,n){this.__hackIgnoreDrawText||t.drawText(this,e,"left"==this.textAlign?0:"center"==this.textAlign?n/2:n,i,n)},i}(t.DisplayObject);t.TextField=e}(ns_egret||(ns_egret={})),function(t){var e=function(){function e(t){this.frames=t.frames}return e.prototype.getFrame=function(e){var i=this.frames[e];return null==i&&t.Logger.fatal("没有找到相应的frame：",e),i},e.parseFromDragonBones=function(t){var n=new e(t);n.frames={},t=t.SubTexture;for(var s in t){var r=t[s],o=new i;o.w=r.width,o.h=r.height,o.x=r.x,o.y=r.y,n.frames[r.name]=o}return n},e}();t.SpriteSheet=e;var i=function(){};t.SpriteSheetFrame=i}(ns_egret||(ns_egret={})),__extends=this.__extends||function(t,e){function i(){this.constructor=t}for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n]);i.prototype=e.prototype,t.prototype=new i},function(t){var e=function(e){function i(){e.apply(this,arguments),this._placeholderText="",this._edFontSize=14,this._textColor="#ff0000",this._placeholderFontSize=14,this._placeholderColor="#ffff00",this._preY=this._preX=0}return __extends(i,e),i.prototype._onAddToStage=function(){e.prototype._onAddToStage.call(this);var i=this.localToGlobal(),n=new t.StageText;n.open(i.x,i.y,this._contentWidth,this._contentHeight),this.addEventListener(t.TouchEvent.TOUCH_BEGAN,this.onMouseDownHandler,this),this.stageText=n},i.prototype.setText=function(t){this.stageText.setText(t)},i.prototype.getText=function(){return this.stageText.getText()},i.prototype.onMouseDownHandler=function(){},i.prototype._onRemoveFromStage=function(){this.stageText.remove()},i.prototype._measureBounds=function(){return t.Rectangle.identity},i.prototype.hitTest=function(t,e){return null},i}(t.DisplayObject);t.TextInput=e,e=function(){function t(){}return t.prototype.editBoxEditingDidBegin=function(t){},t.prototype.editBoxEditingDidEnd=function(t){},t.prototype.editBoxTextChanged=function(t,e){},t.prototype.editBoxReturn=function(t){},t}(),t.TextInputDegelete=e}(ns_egret||(ns_egret={})),__extends=this.__extends||function(t,e){function i(){this.constructor=t}for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n]);i.prototype=e.prototype,t.prototype=new i},function(t){var e=function(e){function i(i,n){e.call(this),this.data=i,this.texture=n,this._resPool={},this._currentInterval=this._interval=this._totalFrame=this._currentFrameIndex=0,this._isPlaying=!1,this._passTime=0,this._oneFrameTime=1e3/t.Ticker.getInstance().getFrameRate(),this._frameData=i}return __extends(i,e),i.prototype.gotoAndPlay=function(e){this.checkHasFrame(e),this._isPlaying=!0,this._currentInterval=this._currentFrameIndex=0,this._currentFrameName=e,this._totalFrame=this._frameData.frames[e].totalFrame,this.playNextFrame(),this._passTime=0,t.Ticker.getInstance().register(this.update,this)},i.prototype.gotoAndStop=function(t){this.checkHasFrame(t),this.stop(),this._currentInterval=this._currentFrameIndex=0,this._currentFrameName=t,this._totalFrame=this._frameData.frames[t].totalFrame,this.playNextFrame()},i.prototype.checkHasFrame=function(e){void 0==this._frameData.frames[e]&&t.Logger.fatal("MovieClip没有对应的frame：",e)},i.prototype.stop=function(){this._isPlaying=!1,t.Ticker.getInstance().unregister(this.update,this)},i.prototype.update=function(t){if(this._interval!=this._currentInterval)this._currentInterval++;else{for(var e=Math.floor((this._passTime%this._oneFrameTime+t)/this._oneFrameTime);1<=e;)1==e?this.playNextFrame():this.playNextFrame(!1),e--;this._passTime+=t}},i.prototype.playNextFrame=function(t){void 0===t&&(t=!0),this._currentInterval=0;var e=this._frameData.frames[this._currentFrameName].childrenFrame[this._currentFrameIndex];t&&(t=this.getBitmap(e.res),t.x=e.x,t.y=e.y,this.removeAllChildren(),this.addChild(t)),null!=e.action&&this.dispatchEvent(e.action),this._currentFrameIndex++,this._currentFrameIndex==this._totalFrame&&(this._currentFrameIndex=0)},i.prototype.getBitmap=function(e){var i;if(null!=this._resPool[e])i=this._resPool[e];else{var n=this._frameData.res[e];(i=t.Bitmap.initWithTexture(this.texture)).spriteFrame=n,this._resPool[e]=i}return i},i.prototype.release=function(){this._resPool={}},i.prototype.getCurrentFrameIndex=function(){return this._currentFrameIndex},i.prototype.getTotalFrame=function(){return this._totalFrame},i.prototype.setInterval=function(t){this._interval=t},i.prototype.getIsPlaying=function(){return this._isPlaying},i}(t.DisplayObjectContainer);t.MovieClip=e}(ns_egret||(ns_egret={})),__extends=this.__extends||function(t,e){function i(){this.constructor=t}for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n]);i.prototype=e.prototype,t.prototype=new i},function(t){var e=function(t){function e(){t.call(this),this._callArr=[]}return __extends(e,t),e.prototype.init=function(){this._callArr=[];for(var t=this._currentTag=0;t<this.numChildren;t++){var e=this.getChildAt(t),i=this,n=function(){var t=i._callArr.indexOf(this);i.chooseIdx(t)};this._callArr.push(n),e.addOnClick(n,n),e.useZoomOut(!1)}},e.prototype.chooseIdx=function(t){this._currentTag=t+1;for(var e=0;e<this.numChildren;e++){var i=this.getChildAt(e);e==t?i.setChoose(!0):i.setChoose(!1)}this.onClick(t)},e.prototype.setDefaultTag=function(t){this.chooseIdx(t-1)},e.prototype.addOnClick=function(t,e){this._callBack=t,this._target=e},e.prototype.onClick=function(t){this._callBack&&this._target&&this._callBack.apply(this._target,[t+1])},e.prototype.useZoomOut=function(t){for(var e=0;e<this.numChildren;e++)this.getChildAt(e).useZoomOut(t)},e.prototype.getCurrentTag=function(){var t=Math.max(this._currentTag,1);return t=Math.min(t,this.numChildren)},e}(t.DisplayObjectContainer);t.TabView=e}(ns_egret||(ns_egret={})),__extends=this.__extends||function(t,e){function i(){this.constructor=t}for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n]);i.prototype=e.prototype,t.prototype=new i},function(t){var e=function(e){function i(){e.call(this),this._frames=[],this._currentFrame=1,this._scale=1.1,this._initScaleY=this._initScaleX=0,this._canScale=!0,this._frameNumber=0,this._canScale=this.touchEnabled=!0}return __extends(i,e),i.prototype.hitTest=function(e,i){return t.DisplayObject.prototype.hitTest.call(this,e,i)},i.prototype._onAddToStage=function(){e.prototype._onAddToStage.call(this),this.addListeners(),this._initScaleX=this.scaleX,this._initScaleY=this.scaleY},i.prototype._onRemoveFromStage=function(){e.prototype._onRemoveFromStage.call(this),this.removeListeners()},i.prototype.addListeners=function(){this.addEventListener(t.TouchEvent.TOUCH_BEGAN,this.mouseDown,this)},i.prototype.removeListeners=function(){this.removeEventListener(t.TouchEvent.TOUCH_BEGAN,this.mouseDown,this),t.MainContext.instance.stage.removeEventListener(t.TouchEvent.TOUCH_END,this.mouseUp,this),t.MainContext.instance.stage.removeEventListener(t.TouchEvent.TOUCH_MOVE,this.mouseMove,this)},i.prototype.mouseDown=function(e,i){this._isMoved=!1,t.MainContext.instance.stage.addEventListener(t.TouchEvent.TOUCH_END,this.mouseUp,this),t.MainContext.instance.stage.addEventListener(t.TouchEvent.TOUCH_MOVE,this.mouseMove,this),this._startX=i.stageX,this._startY=i.stageY,this.setChoose(!0)},i.prototype.mouseUp=function(){this._isMoved||(this.setChoose(!1),this.onClick()),t.MainContext.instance.stage.removeEventListener(t.TouchEvent.TOUCH_END,this.mouseUp,this),t.MainContext.instance.stage.removeEventListener(t.TouchEvent.TOUCH_MOVE,this.mouseMove,this)},i.prototype.mouseMove=function(e,i){var n=i.stageY;10>Math.abs(i.stageX-this._startX)&&10>Math.abs(n-this._startY)||(this._isMoved=!0,this.setChoose(!1),t.MainContext.instance.stage.removeEventListener(t.TouchEvent.TOUCH_MOVE,this.mouseMove,this))},i.prototype.addOnClick=function(t,e){this._callBack=t,this._target=e},i.prototype.onClick=function(){this._callBack&&this._target&&this._callBack.apply(this._target,[])},i.prototype.setEnabled=function(t){this.touchEnabled=t},i.prototype.useZoomOut=function(t){this._canScale=t},i.prototype.initFontTextField=function(e){if(this._textField=e,e instanceof t.TextField&&(e.stroke=2),e&&null!=e.parent){if(e.parent==this)return;e.removeFromParent()}this.addChild(e)},i.prototype.setFontText=function(e,i){if(void 0===i&&(i=30),null==this._textField){this._textField=new t.TextField,this._textField.setContentSize(0,0),this._textField.textColor="#ffffff",this._textField.textAlign="center",this._textField.font="Courier-Bold",this._textField.size=i,this._textField.stroke=2,this.addChild(this._textField),this._textField.relativeAnchorPointX=.5,this._textField.relativeAnchorPointY=.5;var n=this.getBounds();this._textField.x=n.width/2,this._textField.y=n.height/2}this._textField.text=e},i.prototype.setFontColor=function(t){},i.prototype.setChoose=function(t){this.playZoomOut(!t),this.setFrameChild(t?2:1)},i.prototype.playZoomOut=function(t){this._canScale&&(this.scaleX=t?this._initScaleX:this._initScaleX*this._scale,this.scaleY=t?this._initScaleY:this._initScaleY*this._scale)},i.prototype.initFrameRes=function(t,e,i){this._currentFrame=e,this._frameRes=t,this._frames[e-1]=i},i.prototype.changeBtn=function(t){if(this._frameRes!=t){this._frameRes=t;for(var e=t=0;e<this._frames.length;e++){var i=this._frames[e];i&&(t=this.getChildIndex(i),this.removeChild(i),this._frames[e]=null)}this.setFrameChild(this._currentFrame,t)}},i.prototype.setFrameNumber=function(t,e){this._frameRes=t,2<(e=Math.max(0,e))&&(e=0),this._frameNumber=e},i.prototype.isInFrames=function(t){return 0==this._frameNumber||0<(t&this._frameNumber)},i.prototype.setFrameChild=function(e,i){if(void 0===i&&(i=0),this._frameRes){var n=this.getFrameChild(this._currentFrame),s=i;if(n&&(n.visible=!1,s=this.getChildIndex(n)),this._currentFrame=e,this.isInFrames(e)){if(null==(n=this.getFrameChild(e))){n=this.getIndexRes(this._frameRes,1,e),n=t.TextureCache.getInstance().getTexture(n),n=t.Bitmap.initWithTexture(n),this._frames[e-1]=n,n.relativeAnchorPointX=.5,n.relativeAnchorPointY=.5;var r=this.getBounds();n.x=r.width/2,n.y=r.height/2,this.addChild(n,s)}n.visible=!0}}},i.prototype.getFrameChild=function(t){return this._frames[t-1]},i.prototype.getIndexRes=function(e,i,n){var s=e.lastIndexOf(".");return s<i&&t.Logger.fatal("the argument [count] too large"),i=e.substring(0,s-i),e=e.substring(s),i+n+e},i}(t.DisplayObjectContainer);t.SimpleButton=e}(ns_egret||(ns_egret={})),__extends=this.__extends||function(t,e){function i(){this.constructor=t}for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n]);i.prototype=e.prototype,t.prototype=new i},function(t){var e=function(e){function i(){e.call(this),this._initY=this._initX=0,this._deltaTime=200,this.direction=t.Direction.BOTH,this.touchEnabled=!0,this._endY=this._endX=0,this.mask=new t.Rectangle(0,0,100,100)}return __extends(i,e),i.prototype._onAddToStage=function(){e.prototype._onAddToStage.call(this),this.addListeners()},i.prototype._onRemoveFromStage=function(){e.prototype._onRemoveFromStage.call(this),this.removeListeners()},i.prototype.setContentSize=function(t,i){e.prototype.setContentSize.call(this,t,i),this._viewWidth=t,this._viewHeight=i,this.mask.width=t,this.mask.height=i},i.prototype.setContainer=function(t,e,i){if(this._container&&this._container.removeFromParent(),this._container=t,this._initWidth=e,this._initHeight=i,this._endY=this._endX=0,null!=this._container.parent){if(this._container.parent==this)return;this._container.removeFromParent()}this.addChild(this._container,0)},i.prototype.mouseDown=function(e,i){this.touchEnabled&&null!=this._container&&(this._isMoved=!1,t.MainContext.instance.stage.addEventListener(t.TouchEvent.TOUCH_END,this.mouseUp,this),t.MainContext.instance.stage.addEventListener(t.TouchEvent.TOUCH_CANCEL,this.mouseUp,this),t.MainContext.instance.stage.addEventListener(t.TouchEvent.TOUCH_MOVE,this.mouseMove,this),console.log("begin"),t.Tween.removeTweens(this._container),this._initX=this._container.x,this._initY=this._container.y,this._endX=this._container.x,this._endY=this._container.y,this._downPX=i.stageX,this._downPY=i.stageY,this._downTime=t.Ticker.now())},i.prototype.mouseUp=function(e,i){t.MainContext.instance.stage.removeEventListener(t.TouchEvent.TOUCH_END,this.mouseUp,this),t.MainContext.instance.stage.removeEventListener(t.TouchEvent.TOUCH_CANCEL,this.mouseUp,this),t.MainContext.instance.stage.removeEventListener(t.TouchEvent.TOUCH_MOVE,this.mouseMove,this),console.log("end");if((r=t.Ticker.now())-this._downTime>this._deltaTime)this._backToPosition();else{var n=i.stageX-this._downPX,s=i.stageY-this._downPY,r=2*Math.floor(this._deltaTime/(r-this._downTime));this.direction!=t.Direction.BOTH&&this.direction!=t.Direction.HORIZONTAL||(this._endX+=n*r),this.direction!=t.Direction.BOTH&&this.direction!=t.Direction.VERTICAL||(this._endY+=s*r),n=Math.max(100*r,100),n=Math.min(n,300),(s=t.Tween.get(this._container,{onChange:this.moveList,onChangeObj:this})).to({x:this._endX,y:this._endY},n),s.call(this._backToPosition,this)}},i.prototype.mouseMove=function(e,i){var n=i.stageX-this._downPX,s=i.stageY-this._downPY;this.direction!=t.Direction.BOTH&&this.direction!=t.Direction.HORIZONTAL||(this._endX=this._initX+n),this.direction!=t.Direction.BOTH&&this.direction!=t.Direction.VERTICAL||(this._endY=this._initY+s),this._container.x=this._endX,this._container.y=this._endY,this.moveList()},i.prototype._backToPosition=function(){var e=!1;0<this._endX?(e=!0,this._endX=0):this._endX<this._viewWidth-this._initWidth&&(e=!0,this._endX=this._viewWidth>=this._initWidth?0:this._viewWidth-this._initWidth),0<this._endY?(e=!0,this._endY=0):this._endY<this._viewHeight-this._initHeight&&(e=!0,this._endY=this._viewHeight>=this._initHeight?0:this._viewHeight-this._initHeight),e&&t.Tween.get(this._container,{onChange:this.moveList,onChangeObj:this}).to({x:this._endX,y:this._endY},200)},i.prototype.moveList=function(){},i.prototype.addListeners=function(){this.addEventListener(t.TouchEvent.TOUCH_BEGAN,this.mouseDown,this)},i.prototype.removeListeners=function(){this.removeEventListener(t.TouchEvent.TOUCH_BEGAN,this.mouseDown,this),t.MainContext.instance.stage.removeEventListener(t.TouchEvent.TOUCH_CANCEL,this.mouseUp,this),t.MainContext.instance.stage.removeEventListener(t.TouchEvent.TOUCH_END,this.mouseUp,this),t.MainContext.instance.stage.removeEventListener(t.TouchEvent.TOUCH_MOVE,this.mouseMove,this),console.log("remove")},i}(t.DisplayObjectContainer);t.ScrollView=e}(ns_egret||(ns_egret={})),__extends=this.__extends||function(t,e){function i(){this.constructor=t}for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n]);i.prototype=e.prototype,t.prototype=new i},function(t){var e=function(e){function i(){e.call(this),this._currentIndex=0,this._itemArr=[],this.disappearContainer=new t.DisplayObjectContainer,this.addChild(this.disappearContainer)}return __extends(i,e),i.prototype.setContentSize=function(t,i){e.prototype.setContentSize.call(this,t,i)},i.prototype.reloadData=function(e){this._dataArr=e||[],new t.DisplayObjectContainer;var i,n;for(e=0,this.direction==t.Direction.HORIZONTAL?(i=this._itemWidth*this._dataArr.length,n=this._itemHeight,e=Math.floor(-this._container.x/this._itemWidth)):(i=this._itemWidth,n=this._itemHeight*this._dataArr.length,e=Math.floor(-this._container.y/this._itemHeight)),this._initWidth=i,this._initHeight=n,i=this._container.numChildren,n=0;n<i;n++){var s=this._container.getChildAt(n);this.initItem(s,e+n)}this._currentIndex=e,this._backToPosition()},i.prototype.showAnimation=function(){if(this.direction==t.Direction.VERTICAL)for(var e=0,i=0;e<this._container.numChildren;e++){var n=this._container.getChildAt(e);if(n.visible){var s=t.Tween.get(n);n.x=this._itemWidth,s.wait(100*i+10),s.to({x:0},200),i++}}},i.prototype.hideAnimation=function(){if(this.direction==t.Direction.VERTICAL)for(var e=0,i=0;e<this._container.numChildren;e++){var n=this._container.getChildAt(e);if(n.visible){var s=t.Tween.get(n);n.x=0,s.wait(100*i+10),s.to({x:this._itemWidth},200),i++}}},i.prototype.setList=function(e,i,n,s,r){this._dataArr=e||[],this._delegate=n,this._itemWidth=s,this._itemHeight=r,this.direction=i,e=new t.DisplayObjectContainer,this.direction==t.Direction.HORIZONTAL?this.setContainer(e,this._itemWidth*this._dataArr.length,this._itemHeight):this.setContainer(e,this._itemWidth,this._itemHeight*this._dataArr.length),this.initItemList()},i.prototype.initItemList=function(){if(0!=this._itemWidth&&0!=this._itemHeight&&0!=this._viewWidth&&0!=this._viewHeight){var e=0,e=this.direction==t.Direction.HORIZONTAL?Math.ceil(this._viewWidth/this._itemWidth)+1:Math.ceil(this._viewHeight/this._itemHeight)+1;this._itemArr=[];for(var i=0;i<e;i++){var n=this._delegate.createItemRenderer();this._container.addChild(n),this._itemArr.push(n),this.initItem(n,i)}this._currentIndex=0}},i.prototype.getCurrent=function(){var e=0;return(e=this.direction==t.Direction.HORIZONTAL?Math.floor(-this._container.x/this._itemWidth):Math.floor(-this._container.y/this._itemHeight))>this._dataArr.length-this._itemArr.length?e=this._dataArr.length-this._itemArr.length:0>e&&(e=0),e},i.prototype.moveList=function(){var t=this.getCurrent();if(t!=this._currentIndex){var e=t-this._currentIndex;if(console.log("deltaIdx "+e),console.log("current "+t),console.log("this._currentIndex "+this._currentIndex),0>e)for(r=0;r<-e;r++){var i=this._container.getChildAt(this._container.numChildren-1);this._container.setChildIndex(i,0);var n=t+(-e-1)-r;this.initItem(i,n)}else for(var s=this._container.numChildren,r=0;r<e;r++)i=this._container.getChildAt(0),this._container.setChildIndex(i,-1),n=e>=s?t+r:t+s-1-(e-1-r),this.initItem(i,n);this._currentIndex=t}},i.prototype.initItem=function(e,i){i>=this._dataArr.length?e.visible=!1:0>i?e.visible=!1:(e.visible=!0,console.log("item index "+i),this._delegate.updateItemRenderer(e,this._dataArr[i],i)),this.direction==t.Direction.HORIZONTAL?e.x=this._itemWidth*i:e.y=this._itemHeight*i},i}(t.ScrollView);t.TableView=e}(ns_egret||(ns_egret={})),function(t){var e=function(){function e(){}return e.prototype.getText=function(){return this.inputElement.value},e.prototype.setText=function(t){this.inputElement.value=t},e.prototype.open=function(e,i,n,s){void 0===n&&(n=160),void 0===s&&(s=21);var r=document.createElement("input");r.type="text",r.style.fontSize="20px",r.style.color="#FFFFFF",r.style.borderStyle="none",r.style.background="none",r.style.width=n*t.StageDelegate.getInstance().getScaleX()+"px",r.style.height=s*t.StageDelegate.getInstance().getScaleY()+"px",r.style.outline="medium";var o=t.Browser.getInstance().$new("div");o.style.position="absolute",o.position.x=e*t.StageDelegate.getInstance().getScaleX(),o.style.width=n*t.StageDelegate.getInstance().getScaleX()+"px",o.style.height=s*t.StageDelegate.getInstance().getScaleY()+"px",o.position.y=i*t.StageDelegate.getInstance().getScaleY(),o.transforms(),o.appendChild(r),(e=t.Browser.getInstance().$("#StageDelegateDiv"))||(n=document.getElementById(t.StageDelegate.canvas_div_name),s=n.clientHeight,n=n.clientWidth,e=t.Browser.getInstance().$new("div"),e.id="StageDelegateDiv",e.style.position="absolute",e.style.width=n+"px",e.style.maxHeight=s+"px",e.style.margin=0,document.getElementById(t.StageDelegate.canvas_div_name).appendChild(e),e.position.y=-s,e.transforms()),e.appendChild(o),this.div=o,this.inputElement=r},e.prototype.remove=function(){var t=this.div;t&&t.parentNode&&t.parentNode.removeChild(t)},e}();t.StageText=e}(ns_egret||(ns_egret={})),function(t){var e=function(){function e(){this.renderCost=0,this.texture_scale_factor=1}return e.prototype.clearScreen=function(){},e.prototype.clearRect=function(t,e,i,n){},e.prototype.drawImage=function(e,i,n,s,r,o,a,h,u){t.Profiler.getInstance().onDrawImage()},e.prototype.setTransform=function(t){},e.prototype.translate=function(t,e){},e.prototype.save=function(){},e.prototype.restore=function(){},e.prototype.setAlpha=function(t,e){},e.prototype.setupFont=function(t,e,i){},e.prototype.measureText=function(e){return t.Rectangle.identity},e.prototype.drawText=function(e,i,n,s,r){t.Profiler.getInstance().onDrawImage()},e.prototype.clip=function(t,e,i,n){},e.prototype.strokeRect=function(t,e,i,n,s){},e}();t.RendererContext=e,e=function(){function e(t){switch(this.type=t,t){case"add":case"layer":this.value="lighter";break;default:this.value="source-over"}}return e.getBlendMode=function(e){return e?t.BlendMode[e.toUpperCase()]:t.BlendMode.NORMAL},e.NORMAL=new e("normal"),e.ADD=new e("add"),e.LAYER=new e("layer"),e}(),t.BlendMode=e}(ns_egret||(ns_egret={})),__extends=this.__extends||function(t,e){function i(){this.constructor=t}for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n]);i.prototype=e.prototype,t.prototype=new i},function(t){var e=function(e){function i(t){this.canvas=t,this.canvasContext=t.getContext("2d"),e.call(this)}return __extends(i,e),i.prototype.clearScreen=function(){var t=this.canvas;this.canvasContext.setTransform(1,0,0,1,0,0),this.clearRect(0,0,t.width,t.height),this.renderCost=0},i.prototype.clearRect=function(t,e,i,n){this.canvasContext.clearRect(t,e,i,n)},i.prototype.drawImage=function(i,n,s,r,o,a,h,u,c){n/=t.MainContext.instance.rendererContext.texture_scale_factor,s/=t.MainContext.instance.rendererContext.texture_scale_factor,r/=t.MainContext.instance.rendererContext.texture_scale_factor,o/=t.MainContext.instance.rendererContext.texture_scale_factor,t.DEBUG&&t.DEBUG.DRAW_IMAGE&&t.DEBUG.checkDrawImage(i,n,s,r,o,a,h,u,c);var l=t.Ticker.now();i=i._bitmapData,this.canvasContext.drawImage(i,n,s,r,o,a,h,u,c),e.prototype.drawImage.call(this,i,n,s,r,o,a,h,u,c),this.renderCost+=t.Ticker.now()-l},i.prototype.setTransform=function(t){this.canvasContext.setTransform(t.a,t.b,t.c,t.d,t.tx,t.ty)},i.prototype.translate=function(t,e){this.canvasContext.translate(t,e)},i.prototype.save=function(){this.canvasContext.save()},i.prototype.restore=function(){this.canvasContext.restore()},i.prototype.setAlpha=function(e,i){e!=this.canvasContext.globalAlpha&&(this.canvasContext.globalAlpha=e),this.canvasContext.globalCompositeOperation=i?i.value:t.BlendMode.NORMAL.value},i.prototype.setupFont=function(t,e,i){var n=this.canvasContext;n.font=t,n.textAlign=e||"left",n.textBaseline=i||"top"},i.prototype.measureText=function(e){e=this.canvasContext.measureText(e);var i=t.Rectangle.identity;return i.width=e.width,i.height=e.height,i},i.prototype.drawText=function(t,i,n,s,r){var o=t.textColor,a=t.strokeColor;t=t.stroke;var h=this.canvasContext;h.fillStyle=o,h.strokeStyle=a,t&&(h.lineWidth=2*t,h.strokeText(i,n,s,r||65535)),h.fillText(i,n,s,r||65535),e.prototype.drawText.call(this,i,n,s,r,t,o,a)},i.prototype.clip=function(t,e,i,n){this.canvasContext.beginPath(),this.canvasContext.rect(t,e,i,n),this.canvasContext.clip(),this.canvasContext.closePath()},i.prototype.strokeRect=function(t,e,i,n,s){this.canvasContext.strokeStyle=s,this.canvasContext.strokeRect(t,e,i,n)},i}(t.RendererContext);t.HTML5CanvasRenderer=e}(ns_egret||(ns_egret={})),function(t){var e=function(){function e(t){this.canvas=t,this._currentTouchTarget={},this.maxTouchs=2}return e.prototype.run=function(){var t=this;"ontouchstart"in window?(this.canvas.addEventListener("touchstart",function(e){for(var i=e.changedTouches.length,n=0;n<i&&n<t.maxTouchs;n++)t.onTouchBegin(e.changedTouches[n]);e.stopPropagation(),e.preventDefault()},!1),this.canvas.addEventListener("touchmove",function(e){for(var i=e.changedTouches.length,n=0;n<i&&n<t.maxTouchs;n++)t.onTouchMove(e.changedTouches[n]);e.stopPropagation(),e.preventDefault()},!1),this.canvas.addEventListener("touchend",function(e){for(var i=e.changedTouches.length,n=0;n<i&&n<t.maxTouchs;n++)t.onTouchEnd(e.changedTouches[n]);e.stopPropagation(),e.preventDefault()},!1),this.canvas.addEventListener("touchcancel",function(e){for(var i=e.changedTouches.length,n=0;n<i&&n<t.maxTouchs;n++)t.onTouchEnd(e.changedTouches[n]);e.stopPropagation(),e.preventDefault()},!1)):(this.canvas.addEventListener("mousedown",function(e){t.onTouchBegin(e)}),this.canvas.addEventListener("mousemove",function(e){t.onTouchMove(e)}),this.canvas.addEventListener("mouseup",function(e){t.onTouchEnd(e)}))},e.prototype.onTouchBegin=function(n){var s=e.getLocation(this.canvas,n),r=s.x,o=s.y;(s=t.MainContext.instance.stage.hitTest(r,o))&&(n=this.getTouchData(n,r,o),n.target=s,n.beginTarget=s,e.dispachEvent(i.TOUCH_BEGAN,n))},e.prototype.onTouchMove=function(n){var s=e.getLocation(this.canvas,n),r=s.x,o=s.y;(s=t.MainContext.instance.stage.hitTest(r,o))&&(n=this.getTouchData(n,r,o),n.target=s,e.dispachEvent(i.TOUCH_MOVE,n))},e.prototype.onTouchEnd=function(n){var s=e.getLocation(this.canvas,n),r=s.x,o=s.y;(s=t.MainContext.instance.stage.hitTest(r,o))&&((r=(n=this.getTouchData(n,r,o)).beginTarget)&&(n.target=n.beginTarget,e.dispachEvent(i.TOUCH_CANCEL,n)),n.target=s,e.dispachEvent(i.TOUCH_END,n),r===s&&e.dispachEvent(i.TOUCH_TAP,n),delete this._currentTouchTarget[n.identifier])},e.prototype.getTouchData=function(t,e,i){var n=-1;return t.hasOwnProperty("identifier")&&(n=t.identifier),null==(t=this._currentTouchTarget[n])&&(t={}),this._currentTouchTarget[n]=t,t.stageX=e,t.stageY=i,t.identifier=n,t},e.dispachEvent=function(t,e){var n=e.target,s=i.identity;s.touchId=e.identifier,s.stageX=e.stageX,s.stageY=e.stageY,s.target=n;for(var r=[],o=n;o.parent;)r.unshift(o.parent),o=o.parent;r.push(n);for(var a=(n=r.length)-1;0<=a;a--)r.push(r[a]);for(n=r.length,a=0;a<n&&(o=r[a],o.isUseCapture=a<n/2,s.currentTarget=o,!o.dispatchEvent(t,s));a++);},e.getLocation=function(e,i){var n,s,r=document.documentElement,o=window;"function"==typeof e.getBoundingClientRect?(s=e.getBoundingClientRect(),n=s.left,s=s.top):s=n=0,n+=o.pageXOffset-r.clientLeft,s+=o.pageYOffset-r.clientTop,null!=i.pageX?(r=i.pageX,o=i.pageY):(n-=document.body.scrollLeft,s-=document.body.scrollTop,r=i.clientX,o=i.clientY);var a=t.Point.identity;return a.x=(r-n)/t.StageDelegate.getInstance().getScaleX(),a.y=(o-s)/t.StageDelegate.getInstance().getScaleY(),a},e}();t.TouchContext=e;var i=function(){function t(){}return t.prototype.getLocalPoint=function(){return this.currentTarget.globalToLocal(this.stageX,this.stageY)},t.TOUCH_BEGAN="touchBegan",t.TOUCH_END="touchEnd",t.TOUCH_CANCEL="touchCancel",t.TOUCH_TAP="touchTap",t.TOUCH_MOVE="touchMove",t.identity=new t,t}();t.TouchEvent=i}(ns_egret||(ns_egret={})),__extends=this.__extends||function(t,e){function i(){this.constructor=t}for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n]);i.prototype=e.prototype,t.prototype=new i},function(t){var e=function(e){function i(t,n){e.call(this),this.type=this.url=null,this.state=i.LOAD_STATE_INIT,this.fixedUrl=this.data=null,this.url=t;var s=t.indexOf("?");this.fixedUrl=-1<s?t.substring(0,s):t,this.type=n}return __extends(i,e),i.prototype.load=function(){switch(this.state){case i.LOAD_STATE_INIT:this.startLoading();break;case i.LOAD_STATE_LOADED:t.Ticker.getInstance().callLater(this._executeAllCallback,this)}},i.prototype.startLoading=function(){this.type==i.DATA_TYPE_IMAGE?this._loadByImage():this._loadByAjax()},i.prototype._executeAllCallback=function(t){this.state=i.LOAD_STATE_LOADED,t&&(this.data=t),this.onLoadComplete&&this.onLoadComplete(this.data),this.dispatchEvent(i.LOAD_COMPLETE,this.data)},i.prototype._loadByAjax=function(){var e=this,n=new t.URLRequest(i.prefix+this.url,function(t){t=e._processXMLHttpResponse(t),e._executeAllCallback(t)},this);n.type=this.type,t.NetContext.getInstance().send(n)},i.prototype._loadByImage=function(){var e=new Image;e.crossOrigin="Anonymous";var n=i.prefix+this.url,s=this,r=function(){var i=t.Texture.create(s.fixedUrl);i.bitmapData=e,t.TextureCache.getInstance().addTexture(s.fixedUrl,i),e.removeEventListener("load",r),e.removeEventListener("error",r),s._executeAllCallback(e)},o=function(){e.removeEventListener("error",o)};return e.addEventListener("load",r),e.addEventListener("error",o),e.src=n,e},i.prototype._setXMLHttpRequestHeader=function(t){/msie/i.test(navigator.userAgent)&&!/opera/i.test(navigator.userAgent)?this.type==i.DATA_TYPE_BINARY?t.setRequestHeader("Accept-Charset","x-user-defined"):t.setRequestHeader("Accept-Charset","utf-8"):t.overrideMimeType&&(this.type==i.DATA_TYPE_BINARY?t.overrideMimeType("text/plain; charset=x-user-defined"):t.overrideMimeType("text/plain; charset=utf-8"))},i.prototype._processXMLHttpResponse=function(t){if(this.type==i.DATA_TYPE_TEXT)return t.responseText;var e;return/msie/i.test(navigator.userAgent)&&!/opera/i.test(navigator.userAgent)||(e=t.responseText),this._stringConvertToArray(e)},i.prototype._stringConvertToArray=function(t){if(!t)return null;for(var e=new Uint8Array(t.length),i=0;i<t.length;i++)e[i]=255&t.charCodeAt(i);return e},i.create=function(e,n){if(void 0===n&&(n=""),null==i.__pool[e]){var s=e.substring(e.lastIndexOf(".")+1);(s=i.__registerMap[s])||(s=t.ResourceLoader),i.__pool[e]=new s(e,n)}return i.__pool[e]},i.registerHandler=function(t,e){i.__registerMap[t]=e},i.LOAD_COMPLETE="resource_load_complete",i.DATA_TYPE_BINARY="binary",i.DATA_TYPE_TEXT="text",i.DATA_TYPE_IMAGE="image",i.LOAD_STATE_INIT=0,i.LOAD_STATE_LOADED=1,i.__pool={},i.prefix="",i.__registerMap={},i}(t.EventDispatcher);t.ResourceLoader=e}(ns_egret||(ns_egret={})),__extends=this.__extends||function(t,e){function i(){this.constructor=t}for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n]);i.prototype=e.prototype,t.prototype=new i},function(t){var e=function(e){function i(){e.apply(this,arguments),this._resourceUrlList=null,this._currentIndex=0,this._state=t.LoadingController.LOAD_STATE_IDLE}return __extends(i,e),i.prototype.addResource=function(e,i){if(void 0===i&&(i=null),!this.checkIsLoading()){null==this._resourceUrlList&&(this._resourceUrlList=[]);var n=t.ResourceLoader.create(e,i);-1==this._resourceUrlList.indexOf(n)&&n.state!=t.ResourceLoader.LOAD_STATE_LOADED&&this._resourceUrlList.push(n)}},i.prototype.load=function(){this.checkIsLoading()||(null!=this._resourceUrlList&&0<this._resourceUrlList.length?(this._state=i.LOAD_STATE_LOADING,this._currentIndex=0,null!=this._loadingView&&this._loadingView.addToStage(),this.next()):t.Ticker.getInstance().callLater(this.onComplete,this))},i.prototype.onComplete=function(){this._state=i.LOAD_STATE_IDLE,this.destroy(),this.dispatchEvent(t.ResourceLoader.LOAD_COMPLETE)},i.prototype.checkIsLoading=function(){return this._state==i.LOAD_STATE_LOADING&&(t.Logger.info("正在加载中"),!0)},i.prototype.next=function(){this.removeResourceEvent(),this.onProgress(),this._resourceUrlList.length>this._currentIndex?(this._currentResource=this._resourceUrlList[this._currentIndex],this._currentResource.addEventListener(t.ResourceLoader.LOAD_COMPLETE,this.next,this),this._currentResource.load()):this.onComplete(),this._currentIndex++},i.prototype.removeResourceEvent=function(){this._currentResource&&(this._currentResource.removeEventListener(t.ResourceLoader.LOAD_COMPLETE,this.next,this),this._currentResource=null)},i.prototype.onProgress=function(){null!=this._loadingView&&this._loadingView.onProgress(this._currentIndex,this._resourceUrlList.length)},i.prototype.setLoadingView=function(t){null!=this._loadingView&&(this._loadingView.removeFromStage(),this._loadingView=null),this._loadingView=t},i.prototype.destroy=function(){this.removeResourceEvent(),null!=this._loadingView&&(this._loadingView.removeFromStage(),this._loadingView=null),this._resourceUrlList=null},i.LOAD_STATE_IDLE=0,i.LOAD_STATE_LOADING=1,i}(t.EventDispatcher);t.LoadingController=e,e=function(){},t.LoadingEvent=e}(ns_egret||(ns_egret={})),__extends=this.__extends||function(t,e){function i(){this.constructor=t}for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n]);i.prototype=e.prototype,t.prototype=new i},function(t){var e=function(){function e(){this._textureHeight=this._textureWidth=0}return Object.defineProperty(e.prototype,"bitmapData",{get:function(){return this._bitmapData},set:function(e){this._bitmapData=e,this._textureWidth=e.width*t.MainContext.instance.rendererContext.texture_scale_factor,this._textureHeight=e.height*t.MainContext.instance.rendererContext.texture_scale_factor},enumerable:!0,configurable:!0}),e.prototype.getTextureWidth=function(){return this._textureWidth},e.prototype.getTextureHeight=function(){return this._textureHeight},e.create=function(t){var i=new e;return i._path=t,i},e.createWithBase64=function(t){var i=new e,n=new Image;return n.src=t,i.bitmapData=n,i},e}();t.Texture=e,e=function(i){function n(){this.cacheCanvas=document.createElement("canvas"),this.offsetY=this.offsetX=0}return __extends(n,e),n.prototype.drawToTexture=function(e){var i=1/t.MainContext.instance.rendererContext.texture_scale_factor,n=this.cacheCanvas,s=e.getBounds();if(n.width=s.width,n.height=s.height,n.getContext("2d").scale(i,i),e.worldTransform.identity(),e.worldAlpha=1,e instanceof t.DisplayObjectContainer){this.offsetX=s.x,this.offsetY=s.y,e.worldTransform.append(1,0,0,1,-s.x,-s.y);for(var s=0,r=e._children.length;s<r;s++)e._children[s].updateTransform()}(n=new t.HTML5CanvasRenderer(n)).texture_scale_factor=1/i,e.render(n),this.bitmapData=this.cacheCanvas},n}(),t.RenderTexture=e}(ns_egret||(ns_egret={})),function(t){var e=function(){function e(){this._textures={},this._spritesheets={}}return e.getInstance=function(){return null==e.instance&&(e.instance=new e),e.instance},e.prototype.addTexture=function(t,e){this._textures[t]||(this._textures[t]=e)},e.prototype.removeTexture=function(t){delete this._textures[t]},e.prototype.getTexture=function(e){var i=this._textures[e];return i||t.Logger.warning("texture为空",e),i},e.prototype.addSpriteSheet=function(t,e,i){this.addTexture(t,i),this._spritesheets[t]=e},e.prototype.removeSpriteSheet=function(t){this.removeTexture(t),delete this._spritesheets[t]},e.prototype.getSpriteSheet=function(t){return this._spritesheets[t]},e}();t.TextureCache=e}(ns_egret||(ns_egret={})),function(t){var e=function(){function t(){}return t.getInstance=function(){return null==t.context&&(t.context=new t),t.context},t.prototype.send=function(t){},t.STATE_COMPLETE="XHRLoaderComplete",t.GET="GET",t.POST="POST",t.context=null,t}();t.NetContext=e;var i=function(t,i,n,s,r){void 0===s&&(s=e.GET),void 0===r&&(r=void 0),this.url=t,this.callback=i,this.thisObj=n,this.method=s,this.data=r};t.URLRequest=i}(ns_egret||(ns_egret={})),__extends=this.__extends||function(t,e){function i(){this.constructor=t}for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n]);i.prototype=e.prototype,t.prototype=new i},function(t){var e=function(e){function i(){e.apply(this,arguments)}return __extends(i,e),i.prototype.send=function(t){var e=this._getXMLHttpRequest();e.open(t.method,t.url),void 0!=t.type&&this._setXMLHttpRequestHeader(e,t.type),e.onreadystatechange=function(){4==e.readyState&&200==e.status&&t.callback.apply(t.thisObj,[e])},e.send(t.data)},i.prototype._setXMLHttpRequestHeader=function(e,i){/msie/i.test(navigator.userAgent)&&!/opera/i.test(navigator.userAgent)?i==t.ResourceLoader.DATA_TYPE_BINARY?e.setRequestHeader("Accept-Charset","x-user-defined"):e.setRequestHeader("Accept-Charset","utf-8"):e.overrideMimeType&&(i==t.ResourceLoader.DATA_TYPE_BINARY?e.overrideMimeType("text/plain; charset=x-user-defined"):e.overrideMimeType("text/plain; charset=utf-8"))},i.prototype._getXMLHttpRequest=function(){return window.XMLHttpRequest?new window.XMLHttpRequest:new ActiveXObject("MSXML2.XMLHTTP")},i}(t.NetContext);t.HTML5NetContext=e}(ns_egret||(ns_egret={})),ns_egret.Codec={name:"Jacob__Codec"},ns_egret.Utils={},ns_egret.Utils.unzip=function(){return ns_egret.Codec.GZip.gunzip.apply(ns_egret.Codec.GZip,arguments)},ns_egret.Utils.unzipBase64=function(){var t=ns_egret.Codec.Base64.decode.apply(ns_egret.Codec.Base64,arguments);return ns_egret.Codec.GZip.gunzip.apply(ns_egret.Codec.GZip,[t])},ns_egret.Utils.unzipBase64AsArray=function(t,e){e=e||1;var i,n,s,r=this.unzipBase64(t),o=[];for(i=0,s=r.length/e;i<s;i++)for(o[i]=0,n=e-1;0<=n;--n)o[i]+=r.charCodeAt(i*e+n)<<8*n;return o},ns_egret.Utils.unzipAsArray=function(t,e){e=e||1;var i,n,s,r=this.unzip(t),o=[];for(i=0,s=r.length/e;i<s;i++)for(o[i]=0,n=e-1;0<=n;--n)o[i]+=r.charCodeAt(i*e+n)<<8*n;return o},ns_egret.Utils.StringToArray=function(t){t=t.split(",");var e,i=[];for(e=0;e<t.length;e++)i.push(parseInt(t[e]));return i},ns_egret.Codec.Base64={name:"Jacob__Codec__Base64"},ns_egret.Codec.Base64._keyStr="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=",ns_egret.Codec.Base64.decode=function(t){var e,i,n,s,r,o=[],a=0;for(t=t.replace(/[^A-Za-z0-9\+\/\=]/g,"");a<t.length;)e=this._keyStr.indexOf(t.charAt(a++)),i=this._keyStr.indexOf(t.charAt(a++)),s=this._keyStr.indexOf(t.charAt(a++)),r=this._keyStr.indexOf(t.charAt(a++)),e=e<<2|i>>4,i=(15&i)<<4|s>>2,n=(3&s)<<6|r,o.push(String.fromCharCode(e)),64!=s&&o.push(String.fromCharCode(i)),64!=r&&o.push(String.fromCharCode(n));return o=o.join("")},ns_egret.Codec.Base64.decodeAsArray=function(t,e){var i,n,s,r=this.decode(t),o=[];for(i=0,s=r.length/e;i<s;i++)for(o[i]=0,n=e-1;0<=n;--n)o[i]+=r.charCodeAt(i*e+n)<<8*n;return o},ns_egret.Utils.uint8ArrayToUint32Array=function(t){if(0!=t.length%4)return null;for(var e=t.length/4,i=window.Uint32Array?new Uint32Array(e):[],n=0;n<e;n++){var s=4*n;i[n]=t[s]+256*t[s+1]+65536*t[s+2]+16777216*t[s+3]}return i},ns_egret.Codec.GZip=function(t){this.data=t,this.debug=!1,this.gpflags=void 0,this.files=0,this.unzipped=[],this.buf32k=Array(32768),this.bIdx=0,this.modeZIP=!1,this.bytepos=0,this.bb=1,this.bits=0,this.nameBuf=[],this.fileout=void 0,this.literalTree=Array(ns_egret.Codec.GZip.LITERALS),this.distanceTree=Array(32),this.treepos=0,this.Places=null,this.len=0,this.fpos=Array(17),this.fpos[0]=0,this.fmax=this.flens=void 0},ns_egret.Codec.GZip.gunzip=function(t){return new ns_egret.Codec.GZip(t).gunzip()[0][0]},ns_egret.Codec.GZip.HufNode=function(){this.b1=this.b0=0,this.jump=null,this.jumppos=-1},ns_egret.Codec.GZip.LITERALS=288,ns_egret.Codec.GZip.NAMEMAX=256,ns_egret.Codec.GZip.bitReverse=[0,128,64,192,32,160,96,224,16,144,80,208,48,176,112,240,8,136,72,200,40,168,104,232,24,152,88,216,56,184,120,248,4,132,68,196,36,164,100,228,20,148,84,212,52,180,116,244,12,140,76,204,44,172,108,236,28,156,92,220,60,188,124,252,2,130,66,194,34,162,98,226,18,146,82,210,50,178,114,242,10,138,74,202,42,170,106,234,26,154,90,218,58,186,122,250,6,134,70,198,38,166,102,230,22,150,86,214,54,182,118,246,14,142,78,206,46,174,110,238,30,158,94,222,62,190,126,254,1,129,65,193,33,161,97,225,17,145,81,209,49,177,113,241,9,137,73,201,41,169,105,233,25,153,89,217,57,185,121,249,5,133,69,197,37,165,101,229,21,149,85,213,53,181,117,245,13,141,77,205,45,173,109,237,29,157,93,221,61,189,125,253,3,131,67,195,35,163,99,227,19,147,83,211,51,179,115,243,11,139,75,203,43,171,107,235,27,155,91,219,59,187,123,251,7,135,71,199,39,167,103,231,23,151,87,215,55,183,119,247,15,143,79,207,47,175,111,239,31,159,95,223,63,191,127,255],ns_egret.Codec.GZip.cplens=[3,4,5,6,7,8,9,10,11,13,15,17,19,23,27,31,35,43,51,59,67,83,99,115,131,163,195,227,258,0,0],ns_egret.Codec.GZip.cplext=[0,0,0,0,0,0,0,0,1,1,1,1,2,2,2,2,3,3,3,3,4,4,4,4,5,5,5,5,0,99,99],ns_egret.Codec.GZip.cpdist=[1,2,3,4,5,7,9,13,17,25,33,49,65,97,129,193,257,385,513,769,1025,1537,2049,3073,4097,6145,8193,12289,16385,24577],ns_egret.Codec.GZip.cpdext=[0,0,0,0,1,1,2,2,3,3,4,4,5,5,6,6,7,7,8,8,9,9,10,10,11,11,12,12,13,13],ns_egret.Codec.GZip.border=[16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15],ns_egret.Codec.GZip.prototype.gunzip=function(){return this.outputArr=[],this.nextFile(),this.unzipped},ns_egret.Codec.GZip.prototype.readByte=function(){return this.bits+=8,this.bytepos<this.data.length?this.data.charCodeAt(this.bytepos++):-1},ns_egret.Codec.GZip.prototype.byteAlign=function(){this.bb=1},ns_egret.Codec.GZip.prototype.readBit=function(){var t;return this.bits++,t=1&this.bb,this.bb>>=1,0==this.bb&&(this.bb=this.readByte(),t=1&this.bb,this.bb=this.bb>>1|128),t},ns_egret.Codec.GZip.prototype.readBits=function(t){for(var e=0,i=t;i--;)e=e<<1|this.readBit();return t&&(e=ns_egret.Codec.GZip.bitReverse[e]>>8-t),e},ns_egret.Codec.GZip.prototype.flushBuffer=function(){this.bIdx=0},ns_egret.Codec.GZip.prototype.addBuffer=function(t){this.buf32k[this.bIdx++]=t,this.outputArr.push(String.fromCharCode(t)),32768==this.bIdx&&(this.bIdx=0)},ns_egret.Codec.GZip.prototype.IsPat=function(){for(;;){if(this.fpos[this.len]>=this.fmax)return-1;if(this.flens[this.fpos[this.len]]==this.len)return this.fpos[this.len]++;this.fpos[this.len]++}},ns_egret.Codec.GZip.prototype.Rec=function(){var t,e=this.Places[this.treepos];if(17==this.len)return-1;if(this.treepos++,this.len++,0<=(t=this.IsPat()))e.b0=t;else if(e.b0=32768,this.Rec())return-1;if(0<=(t=this.IsPat()))e.b1=t,e.jump=null;else if(e.b1=32768,e.jump=this.Places[this.treepos],e.jumppos=this.treepos,this.Rec())return-1;return this.len--,0},ns_egret.Codec.GZip.prototype.CreateTree=function(t,e,i,n){for(this.Places=t,this.treepos=0,this.flens=i,this.fmax=e,t=0;17>t;t++)this.fpos[t]=0;return this.len=0,this.Rec()?-1:0},ns_egret.Codec.GZip.prototype.DecodeValue=function(t){for(var e,i,n=0,s=t[n];;)if(e=this.readBit()){if(!(32768&s.b1))return s.b1;for(s=s.jump,e=t.length,i=0;i<e;i++)if(t[i]===s){n=i;break}}else{if(!(32768&s.b0))return s.b0;s=t[++n]}return-1},ns_egret.Codec.GZip.prototype.DeflateLoop=function(){var t,e,i,n,s;do{if(t=this.readBit(),0==(i=this.readBits(2)))for(this.byteAlign(),i=this.readByte(),i|=this.readByte()<<8,e=this.readByte(),65535&(i^~(e|=this.readByte()<<8))&&document.write("BlockLen checksum mismatch\n");i--;)e=this.readByte(),this.addBuffer(e);else if(1==i)for(;;)if(23<(i=ns_egret.Codec.GZip.bitReverse[this.readBits(7)]>>1)?199<(i=i<<1|this.readBit())?(i-=128,i=i<<1|this.readBit()):143<(i-=48)&&(i+=136):i+=256,256>i)this.addBuffer(i);else{if(256==i)break;var r;for(i-=257,s=this.readBits(ns_egret.Codec.GZip.cplext[i])+ns_egret.Codec.GZip.cplens[i],i=ns_egret.Codec.GZip.bitReverse[this.readBits(5)]>>3,8<ns_egret.Codec.GZip.cpdext[i]?(r=this.readBits(8),r|=this.readBits(ns_egret.Codec.GZip.cpdext[i]-8)<<8):r=this.readBits(ns_egret.Codec.GZip.cpdext[i]),r+=ns_egret.Codec.GZip.cpdist[i],i=0;i<s;i++)e=this.buf32k[this.bIdx-r&32767],this.addBuffer(e)}else if(2==i){var o=Array(320);for(e=257+this.readBits(5),r=1+this.readBits(5),n=4+this.readBits(4),i=0;19>i;i++)o[i]=0;for(i=0;i<n;i++)o[ns_egret.Codec.GZip.border[i]]=this.readBits(3);for(s=this.distanceTree.length,n=0;n<s;n++)this.distanceTree[n]=new ns_egret.Codec.GZip.HufNode;if(this.CreateTree(this.distanceTree,19,o,0))return this.flushBuffer(),1;s=e+r,n=0;for(;n<s;)if(0,16>(i=this.DecodeValue(this.distanceTree)))o[n++]=i;else if(16==i){var a;if(i=3+this.readBits(2),n+i>s)return this.flushBuffer(),1;for(a=n?o[n-1]:0;i--;)o[n++]=a}else{if(i=17==i?3+this.readBits(3):11+this.readBits(7),n+i>s)return this.flushBuffer(),1;for(;i--;)o[n++]=0}for(s=this.literalTree.length,n=0;n<s;n++)this.literalTree[n]=new ns_egret.Codec.GZip.HufNode;if(this.CreateTree(this.literalTree,e,o,0))return this.flushBuffer(),1;for(s=this.literalTree.length,n=0;n<s;n++)this.distanceTree[n]=new ns_egret.Codec.GZip.HufNode;for(i=[],n=e;n<o.length;n++)i[n-e]=o[n];if(this.CreateTree(this.distanceTree,r,i,0))return this.flushBuffer(),1;for(;;)if(256<=(i=this.DecodeValue(this.literalTree))){if(0==(i-=256))break;for(i--,s=this.readBits(ns_egret.Codec.GZip.cplext[i])+ns_egret.Codec.GZip.cplens[i],i=this.DecodeValue(this.distanceTree),8<ns_egret.Codec.GZip.cpdext[i]?(r=this.readBits(8),r|=this.readBits(ns_egret.Codec.GZip.cpdext[i]-8)<<8):r=this.readBits(ns_egret.Codec.GZip.cpdext[i]),r+=ns_egret.Codec.GZip.cpdist[i];s--;)e=this.buf32k[this.bIdx-r&32767],this.addBuffer(e)}else this.addBuffer(i)}}while(!t);return this.flushBuffer(),this.byteAlign(),0},ns_egret.Codec.GZip.prototype.unzipFile=function(t){var e;for(this.gunzip(),e=0;e<this.unzipped.length;e++)if(this.unzipped[e][1]==t)return this.unzipped[e][0]},ns_egret.Codec.GZip.prototype.nextFile=function(){this.outputArr=[],this.modeZIP=!1;var t=[];if(t[0]=this.readByte(),t[1]=this.readByte(),120==t[0]&&218==t[1]&&(this.DeflateLoop(),this.unzipped[this.files]=[this.outputArr.join(""),"geonext.gxt"],this.files++),31==t[0]&&139==t[1]&&(this.skipdir(),this.unzipped[this.files]=[this.outputArr.join(""),"file"],this.files++),80==t[0]&&75==t[1]&&(this.modeZIP=!0,t[2]=this.readByte(),t[3]=this.readByte(),3==t[2]&&4==t[3])){t[0]=this.readByte(),t[1]=this.readByte(),this.gpflags=this.readByte(),this.gpflags|=this.readByte()<<8,t=this.readByte(),t|=this.readByte()<<8,this.readByte(),this.readByte(),this.readByte(),this.readByte(),this.readByte(),this.readByte(),this.readByte(),this.readByte(),this.readByte(),this.readByte(),this.readByte(),this.readByte();var e=(e=this.readByte())|this.readByte()<<8,i=(i=this.readByte())|this.readByte()<<8,n=0;for(this.nameBuf=[];e--;){var s=this.readByte();"/"==s|":"==s?n=0:n<ns_egret.Codec.GZip.NAMEMAX-1&&(this.nameBuf[n++]=String.fromCharCode(s))}this.fileout||(this.fileout=this.nameBuf);for(n=0;n<i;)this.readByte(),n++;8==t&&(this.DeflateLoop(),this.unzipped[this.files]=[this.outputArr.join(""),this.nameBuf.join("")],this.files++),this.skipdir()}},ns_egret.Codec.GZip.prototype.skipdir=function(){var t,e=[];if(8&this.gpflags&&(e[0]=this.readByte(),e[1]=this.readByte(),e[2]=this.readByte(),e[3]=this.readByte(),this.readByte(),this.readByte(),this.readByte(),this.readByte(),this.readByte(),this.readByte(),this.readByte(),this.readByte()),this.modeZIP&&this.nextFile(),e[0]=this.readByte(),8!=e[0])return 0;if(this.gpflags=this.readByte(),this.readByte(),this.readByte(),this.readByte(),this.readByte(),this.readByte(),this.readByte(),4&this.gpflags)for(e[0]=this.readByte(),e[2]=this.readByte(),this.len=e[0]+256*e[1],e=0;e<this.len;e++)this.readByte();if(8&this.gpflags)for(e=0,this.nameBuf=[];t=this.readByte();)"7"!=t&&":"!=t||(e=0),e<ns_egret.Codec.GZip.NAMEMAX-1&&(this.nameBuf[e++]=t);if(16&this.gpflags)for(;this.readByte(););2&this.gpflags&&(this.readByte(),this.readByte()),this.DeflateLoop(),this.readByte(),this.readByte(),this.readByte(),this.readByte(),this.modeZIP&&this.nextFile()},function(){function t(t){throw t}function e(t,e){var i=t.split("."),n=T;!(i[0]in n)&&n.execScript&&n.execScript("var "+i[0]);for(var s;i.length&&(s=i.shift());)i.length||e===y?n=n[s]?n[s]:n[s]={}:n[s]=e}function i(t){if("string"==typeof t){var e,i;for(e=0,i=(t=t.split("")).length;e<i;e++)t[e]=(255&t[e].charCodeAt(0))>>>0}e=1,i=0;for(var n,s=t.length,r=0;0<s;){s-=n=1024<s?1024:s;do{e+=t[r++],i+=e}while(--n);e%=65521,i%=65521}return(i<<16|e)>>>0}function n(e,i){this.index="number"==typeof i?i:0,this.i=0,this.buffer=e instanceof(x?Uint8Array:Array)?e:new(x?Uint8Array:Array)(32768),2*this.buffer.length<=this.index&&t(Error("invalid index")),this.buffer.length<=this.index&&this.f()}function s(t){this.buffer=new(x?Uint16Array:Array)(2*t),this.length=0}function r(t){var e,i,n,s,r,o,a,h,u,c=t.length,l=0,d=Number.POSITIVE_INFINITY;for(h=0;h<c;++h)t[h]>l&&(l=t[h]),t[h]<d&&(d=t[h]);for(e=1<<l,i=new(x?Uint32Array:Array)(e),n=1,s=0,r=2;n<=l;){for(h=0;h<c;++h)if(t[h]===n){for(o=0,a=s,u=0;u<n;++u)o=o<<1|1&a,a>>=1;for(u=o;u<e;u+=r)i[u]=n<<16|h;++s}++n,s<<=1,r<<=1}return[i,l,d]}function o(t,e){this.h=I,this.w=0,this.input=t,this.b=0,e&&(e.lazy&&(this.w=e.lazy),"number"==typeof e.compressionType&&(this.h=e.compressionType),e.outputBuffer&&(this.a=x&&e.outputBuffer instanceof Array?new Uint8Array(e.outputBuffer):e.outputBuffer),"number"==typeof e.outputIndex&&(this.b=e.outputIndex)),this.a||(this.a=new(x?Uint8Array:Array)(32768))}function a(t,e){this.length=t,this.G=e}function h(){var e=M;switch(v){case 3===e:return[257,e-3,0];case 4===e:return[258,e-4,0];case 5===e:return[259,e-5,0];case 6===e:return[260,e-6,0];case 7===e:return[261,e-7,0];case 8===e:return[262,e-8,0];case 9===e:return[263,e-9,0];case 10===e:return[264,e-10,0];case 12>=e:return[265,e-11,1];case 14>=e:return[266,e-13,1];case 16>=e:return[267,e-15,1];case 18>=e:return[268,e-17,1];case 22>=e:return[269,e-19,2];case 26>=e:return[270,e-23,2];case 30>=e:return[271,e-27,2];case 34>=e:return[272,e-31,2];case 42>=e:return[273,e-35,3];case 50>=e:return[274,e-43,3];case 58>=e:return[275,e-51,3];case 66>=e:return[276,e-59,3];case 82>=e:return[277,e-67,4];case 98>=e:return[278,e-83,4];case 114>=e:return[279,e-99,4];case 130>=e:return[280,e-115,4];case 162>=e:return[281,e-131,5];case 194>=e:return[282,e-163,5];case 226>=e:return[283,e-195,5];case 257>=e:return[284,e-227,5];case 258===e:return[285,e-258,0];default:t("invalid length: "+e)}}function u(e,i){function n(e,i){var n,s=e.G,r=[],o=0;n=O[e.length],r[o++]=65535&n,r[o++]=n>>16&255,r[o++]=n>>24;var a;switch(v){case 1===s:a=[0,s-1,0];break;case 2===s:a=[1,s-2,0];break;case 3===s:a=[2,s-3,0];break;case 4===s:a=[3,s-4,0];break;case 6>=s:a=[4,s-5,1];break;case 8>=s:a=[5,s-7,1];break;case 12>=s:a=[6,s-9,2];break;case 16>=s:a=[7,s-13,2];break;case 24>=s:a=[8,s-17,3];break;case 32>=s:a=[9,s-25,3];break;case 48>=s:a=[10,s-33,4];break;case 64>=s:a=[11,s-49,4];break;case 96>=s:a=[12,s-65,5];break;case 128>=s:a=[13,s-97,5];break;case 192>=s:a=[14,s-129,6];break;case 256>=s:a=[15,s-193,6];break;case 384>=s:a=[16,s-257,7];break;case 512>=s:a=[17,s-385,7];break;case 768>=s:a=[18,s-513,8];break;case 1024>=s:a=[19,s-769,8];break;case 1536>=s:a=[20,s-1025,9];break;case 2048>=s:a=[21,s-1537,9];break;case 3072>=s:a=[22,s-2049,10];break;case 4096>=s:a=[23,s-3073,10];break;case 6144>=s:a=[24,s-4097,11];break;case 8192>=s:a=[25,s-6145,11];break;case 12288>=s:a=[26,s-8193,12];break;case 16384>=s:a=[27,s-12289,12];break;case 24576>=s:a=[28,s-16385,13];break;case 32768>=s:a=[29,s-24577,13];break;default:t("invalid distance")}for(n=a,r[o++]=n[0],r[o++]=n[1],r[o++]=n[2],s=0,o=r.length;s<o;++s)p[_++]=r[s];f[r[0]]++,m[r[3]]++,g=e.length+i-1,c=null}var s,r,o,h,u,c,l,d={},p=x?new Uint16Array(2*i.length):[],_=0,g=0,f=new(x?Uint32Array:Array)(286),m=new(x?Uint32Array:Array)(30),T=e.w;if(!x){for(o=0;285>=o;)f[o++]=0;for(o=0;29>=o;)m[o++]=0}for(f[256]=1,s=0,r=i.length;s<r;++s){for(o=u=0,h=3;o<h&&s+o!==r;++o)u=u<<8|i[s+o];if(d[u]===y&&(d[u]=[]),o=d[u],!(0<g--)){for(;0<o.length&&32768<s-o[0];)o.shift();if(s+3>=r){for(c&&n(c,-1),o=0,h=r-s;o<h;++o)l=i[s+o],p[_++]=l,++f[l];break}if(0<o.length){u=h=y;var A=0,w=y,C=y,b=w=y,E=i.length,C=0,b=o.length;t:for(;C<b;C++){if(h=o[b-C-1],w=3,3<A){for(w=A;3<w;w--)if(i[h+w-1]!==i[s+w-1])continue t;w=A}for(;258>w&&s+w<E&&i[h+w]===i[s+w];)++w;if(w>A&&(u=h,A=w),258===w)break}h=new a(A,s-u),c?c.length<h.length?(l=i[s-1],p[_++]=l,++f[l],n(h,0)):n(c,-1):h.length<T?c=h:n(h,0)}else c?n(c,-1):(l=i[s],p[_++]=l,++f[l])}o.push(s)}return p[_++]=256,f[256]++,e.L=f,e.K=m,x?p.subarray(0,_):p}function c(t,e){function i(t){var e=g[t][f[t]];e===c?(i(t+1),i(t+1)):--l[e],++f[t]}var n,r,o,a=t.length,h=new s(572),u=new(x?Uint8Array:Array)(a);if(!x)for(r=0;r<a;r++)u[r]=0;for(r=0;r<a;++r)0<t[r]&&h.push(r,t[r]);if(a=Array(h.length/2),n=new(x?Uint32Array:Array)(h.length/2),1===a.length)return u[h.pop().index]=1,u;for(r=0,o=h.length/2;r<o;++r)a[r]=h.pop(),n[r]=a[r].value;var c=n.length;r=new(x?Uint16Array:Array)(e);var h=new(x?Uint8Array:Array)(e),l=new(x?Uint8Array:Array)(c);o=Array(e);var d,p,_,g=Array(e),f=Array(e),m=(1<<e)-c,y=1<<e-1;for(r[e-1]=c,d=0;d<e;++d)m<y?h[d]=0:(h[d]=1,m-=y),m<<=1,r[e-2-d]=(r[e-1-d]/2|0)+c;for(r[0]=h[0],o[0]=Array(r[0]),g[0]=Array(r[0]),d=1;d<e;++d)r[d]>2*r[d-1]+h[d]&&(r[d]=2*r[d-1]+h[d]),o[d]=Array(r[d]),g[d]=Array(r[d]);for(m=0;m<c;++m)l[m]=e;for(y=0;y<r[e-1];++y)o[e-1][y]=n[y],g[e-1][y]=y;for(m=0;m<e;++m)f[m]=0;for(1===h[e-1]&&(--l[0],++f[e-1]),d=e-2;0<=d;--d){for(p=m=0,_=f[d+1],y=0;y<r[d];y++)(p=o[d+1][_]+o[d+1][_+1])>n[m]?(o[d][y]=p,g[d][y]=c,_+=2):(o[d][y]=n[m],g[d][y]=m,++m);f[d]=0,1===h[d]&&i(d)}for(n=l,r=0,o=a.length;r<o;++r)u[a[r].index]=n[r];return u}function l(e){var i,n,s,r=new(x?Uint16Array:Array)(e.length),o=[],a=[],h=0;for(i=0,n=e.length;i<n;i++)o[e[i]]=1+(0|o[e[i]]);for(i=1,n=16;i<=n;i++)a[i]=h,(h+=0|o[i])>1<<i&&t("overcommitted"),h<<=1;for(65536>h&&t("undercommitted"),i=0,n=e.length;i<n;i++)for(h=a[e[i]],a[e[i]]+=1,o=r[i]=0,s=e[i];o<s;o++)r[i]=r[i]<<1|1&h,h>>>=1;return r}function d(t,e){this.input=t,this.a=new(x?Uint8Array:Array)(32768),this.h=P.j;var i,n={};!e&&(e={})||"number"!=typeof e.compressionType||(this.h=e.compressionType);for(i in e)n[i]=e[i];n.outputBuffer=this.a,this.z=new o(this.input,n)}function p(e,i){switch(this.k=[],this.l=32768,this.e=this.g=this.c=this.q=0,this.input=x?new Uint8Array(e):e,this.s=!1,this.m=S,this.B=!1,!i&&(i={})||(i.index&&(this.c=i.index),i.bufferSize&&(this.l=i.bufferSize),i.bufferType&&(this.m=i.bufferType),i.resize&&(this.B=i.resize)),this.m){case B:this.b=32768,this.a=new(x?Uint8Array:Array)(32768+this.l+258);break;case S:this.b=0,this.a=new(x?Uint8Array:Array)(this.l),this.f=this.J,this.t=this.H,this.o=this.I;break;default:t(Error("invalid inflate mode"))}}function _(e,i){for(var n,s=e.g,r=e.e,o=e.input,a=e.c;r<i;)(n=o[a++])===y&&t(Error("input buffer is broken")),s|=n<<r,r+=8;return e.g=s>>>i,e.e=r-i,e.c=a,s&(1<<i)-1}function g(e,i){for(var n,s=e.g,r=e.e,o=e.input,a=e.c,h=i[0],u=i[1];r<u;)(n=o[a++])===y&&t(Error("input buffer is broken")),s|=n<<r,r+=8;return o=h[s&(1<<u)-1],h=o>>>16,e.g=s>>h,e.e=r-h,e.c=a,65535&o}function f(t){function e(t,e,i){var n,s,r,o;for(o=0;o<t;)switch(n=g(this,e)){case 16:for(r=3+_(this,2);r--;)i[o++]=s;break;case 17:for(r=3+_(this,3);r--;)i[o++]=0;s=0;break;case 18:for(r=11+_(this,7);r--;)i[o++]=0;s=0;break;default:s=i[o++]=n}return i}var i,n=_(t,5)+257,s=_(t,5)+1,o=_(t,4)+4,a=new(x?Uint8Array:Array)(R.length);for(i=0;i<o;++i)a[R[i]]=_(t,3);o=r(a),a=new(x?Uint8Array:Array)(n),i=new(x?Uint8Array:Array)(s),t.o(r(e.call(t,n,o,a)),r(e.call(t,s,o,i)))}function m(e,i){var n,s;switch(this.input=e,this.c=0,!i&&(i={})||(i.index&&(this.c=i.index),i.verify&&(this.M=i.verify)),n=e[this.c++],s=e[this.c++],15&n){case G:this.method=G;break;default:t(Error("unsupported compression method"))}0!=((n<<8)+s)%31&&t(Error("invalid fcheck flag:"+((n<<8)+s)%31)),32&s&&t(Error("fdict flag is not supported")),this.A=new p(e,{index:this.c,bufferSize:i.bufferSize,bufferType:i.bufferType,resize:i.resize})}var y=void 0,v=!0,T=this,x="undefined"!=typeof Uint8Array&&"undefined"!=typeof Uint16Array&&"undefined"!=typeof Uint32Array;n.prototype.f=function(){var t,e=this.buffer,i=e.length,n=new(x?Uint8Array:Array)(i<<1);if(x)n.set(e);else for(t=0;t<i;++t)n[t]=e[t];return this.buffer=n},n.prototype.d=function(t,e,i){var n=this.buffer,s=this.index,r=this.i,o=n[s];if(i&&1<e&&(t=8<e?(L[255&t]<<24|L[t>>>8&255]<<16|L[t>>>16&255]<<8|L[t>>>24&255])>>32-e:L[t]>>8-e),8>e+r)o=o<<e|t,r+=e;else for(i=0;i<e;++i)o=o<<1|t>>e-i-1&1,8==++r&&(r=0,n[s++]=L[o],o=0,s===n.length&&(n=this.f()));n[s]=o,this.buffer=n,this.i=r,this.index=s},n.prototype.finish=function(){var t,e=this.buffer,i=this.index;return 0<this.i&&(e[i]<<=8-this.i,e[i]=L[e[i]],i++),x?t=e.subarray(0,i):(e.length=i,t=e),t};var A,w=new(x?Uint8Array:Array)(256);for(A=0;256>A;++A){for(var C=E=A,b=7,E=E>>>1;E;E>>>=1)C<<=1,C|=1&E,--b;w[A]=(C<<b&255)>>>0}var L=w,w=[0,1996959894,3993919788,2567524794,124634137,1886057615,3915621685,2657392035,249268274,2044508324,3772115230,2547177864,162941995,2125561021,3887607047,2428444049,498536548,1789927666,4089016648,2227061214,450548861,1843258603,4107580753,2211677639,325883990,1684777152,4251122042,2321926636,335633487,1661365465,4195302755,2366115317,997073096,1281953886,3579855332,2724688242,1006888145,1258607687,3524101629,2768942443,901097722,1119000684,3686517206,2898065728,853044451,1172266101,3705015759,2882616665,651767980,1373503546,3369554304,3218104598,565507253,1454621731,3485111705,3099436303,671266974,1594198024,3322730930,2970347812,795835527,1483230225,3244367275,3060149565,1994146192,31158534,2563907772,4023717930,1907459465,112637215,2680153253,3904427059,2013776290,251722036,2517215374,3775830040,2137656763,141376813,2439277719,3865271297,1802195444,476864866,2238001368,4066508878,1812370925,453092731,2181625025,4111451223,1706088902,314042704,2344532202,4240017532,1658658271,366619977,2362670323,4224994405,1303535960,984961486,2747007092,3569037538,1256170817,1037604311,2765210733,3554079995,1131014506,879679996,2909243462,3663771856,1141124467,855842277,2852801631,3708648649,1342533948,654459306,3188396048,3373015174,1466479909,544179635,3110523913,3462522015,1591671054,702138776,2966460450,3352799412,1504918807,783551873,3082640443,3233442989,3988292384,2596254646,62317068,1957810842,3939845945,2647816111,81470997,1943803523,3814918930,2489596804,225274430,2053790376,3826175755,2466906013,167816743,2097651377,4027552580,2265490386,503444072,1762050814,4150417245,2154129355,426522225,1852507879,4275313526,2312317920,282753626,1742555852,4189708143,2394877945,397917763,1622183637,3604390888,2714866558,953729732,1340076626,3518719985,2797360999,1068828381,1219638859,3624741850,2936675148,906185462,1090812512,3747672003,2825379669,829329135,1181335161,3412177804,3160834842,628085408,1382605366,3423369109,3138078467,570562233,1426400815,3317316542,2998733608,733239954,1555261956,3268935591,3050360625,752459403,1541320221,2607071920,3965973030,1969922972,40735498,2617837225,3943577151,1913087877,83908371,2512341634,3803740692,2075208622,213261112,2463272603,3855990285,2094854071,198958881,2262029012,4057260610,1759359992,534414190,2176718541,4139329115,1873836001,414664567,2282248934,4279200368,1711684554,285281116,2405801727,4167216745,1634467795,376229701,2685067896,3608007406,1308918612,956543938,2808555105,3495958263,1231636301,1047427035,2932959818,3654703836,1088359270,936918e3,2847714899,3736837829,1202900863,817233897,3183342108,3401237130,1404277552,615818150,3134207493,3453421203,1423857449,601450431,3009837614,3294710456,1567103746,711928724,3020668471,3272380065,1510334235,755167117];x&&new Uint32Array(w),s.prototype.getParent=function(t){return 2*((t-2)/4|0)},s.prototype.push=function(t,e){var i,n,s,r=this.buffer;for(i=this.length,r[this.length++]=e,r[this.length++]=t;0<i&&(n=this.getParent(i),r[i]>r[n]);)s=r[i],r[i]=r[n],r[n]=s,s=r[i+1],r[i+1]=r[n+1],r[n+1]=s,i=n;return this.length},s.prototype.pop=function(){var t,e,i,n,s,r=this.buffer;for(e=r[0],t=r[1],this.length-=2,r[0]=r[this.length],r[1]=r[this.length+1],s=0;!((n=2*s+2)>=this.length)&&(n+2<this.length&&r[n+2]>r[n]&&(n+=2),r[n]>r[s]);)i=r[s],r[s]=r[n],r[n]=i,i=r[s+1],r[s+1]=r[n+1],r[n+1]=i,s=n;return{index:t,value:e,length:this.length}};var I=2,w={NONE:0,r:1,j:I,N:3},D=[];for(A=0;288>A;A++)switch(v){case 143>=A:D.push([A+48,8]);break;case 255>=A:D.push([A-144+400,9]);break;case 279>=A:D.push([A-256+0,7]);break;case 287>=A:D.push([A-280+192,8]);break;default:t("invalid literal: "+A)}o.prototype.n=function(){var e,i,s,r,o=this.input;switch(this.h){case 0:for(s=0,r=o.length;s<r;){var a=(s+=(i=x?o.subarray(s,s+65535):o.slice(s,s+65535)).length)===r,h=y,d=h=y,d=h=y,p=this.a,_=this.b;if(x){for(p=new Uint8Array(this.a.buffer);p.length<=_+i.length+5;)p=new Uint8Array(p.length<<1);p.set(this.a)}if(h=a?1:0,p[_++]=0|h,h=i.length,d=65536+~h&65535,p[_++]=255&h,p[_++]=h>>>8&255,p[_++]=255&d,p[_++]=d>>>8&255,x)p.set(i,_),_+=i.length,p=p.subarray(0,_);else{for(h=0,d=i.length;h<d;++h)p[_++]=i[h];p.length=_}this.b=_,this.a=p}break;case 1:for((s=new n(new Uint8Array(this.a.buffer),this.b)).d(1,1,v),s.d(1,2,v),i=0,a=(o=u(this,o)).length;i<a;i++)if(r=o[i],n.prototype.d.apply(s,D[r]),256<r)s.d(o[++i],o[++i],v),s.d(o[++i],5),s.d(o[++i],o[++i],v);else if(256===r)break;this.a=s.finish(),this.b=this.a.length;break;case I:r=new n(new Uint8Array(this.a),this.b);var g,f,m,T,A,w,C=[16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15],h=Array(19),p=I;for(r.d(1,1,v),r.d(p,2,v),o=u(this,o),T=l(d=c(this.L,15)),_=l(p=c(this.K,7)),g=286;257<g&&0===d[g-1];g--);for(f=30;1<f&&0===p[f-1];f--);var b=g,E=f;e=new(x?Uint32Array:Array)(b+E);var L,M,O=new(x?Uint32Array:Array)(316);for(A=new(x?Uint8Array:Array)(19),w=m=0;w<b;w++)e[m++]=d[w];for(w=0;w<E;w++)e[m++]=p[w];if(!x)for(w=0,E=A.length;w<E;++w)A[w]=0;for(w=L=0,E=e.length;w<E;w+=m){for(m=1;w+m<E&&e[w+m]===e[w];++m);if(b=m,0===e[w])if(3>b)for(;0<b--;)O[L++]=0,A[0]++;else for(;0<b;)(M=138>b?b:138)>b-3&&M<b&&(M=b-3),10>=M?(O[L++]=17,O[L++]=M-3,A[17]++):(O[L++]=18,O[L++]=M-11,A[18]++),b-=M;else if(O[L++]=e[w],A[e[w]]++,3>--b)for(;0<b--;)O[L++]=e[w],A[e[w]]++;else for(;0<b;)(M=6>b?b:6)>b-3&&M<b&&(M=b-3),O[L++]=16,O[L++]=M-3,A[16]++,b-=M}for(e=x?O.subarray(0,L):O.slice(0,L),A=c(A,7),w=0;19>w;w++)h[w]=A[C[w]];for(m=19;4<m&&0===h[m-1];m--);for(C=l(A),r.d(g-257,5,v),r.d(f-1,5,v),r.d(m-4,4,v),w=0;w<m;w++)r.d(h[w],3,v);for(w=0,h=e.length;w<h;w++)if(i=e[w],r.d(C[i],A[i],v),16<=i){switch(w++,i){case 16:a=2;break;case 17:a=3;break;case 18:a=7;break;default:t("invalid code: "+i)}r.d(e[w],a,v)}for(_=[_,p],i=(a=[T,d])[0],a=a[1],p=_[0],T=_[1],_=0,h=o.length;_<h;++_)if(s=o[_],r.d(i[s],a[s],v),256<s)r.d(o[++_],o[++_],v),d=o[++_],r.d(p[d],T[d],v),r.d(o[++_],o[++_],v);else if(256===s)break;this.a=r.finish(),this.b=this.a.length;break;default:t("invalid compression type")}return this.a},A=[];var M;for(M=3;258>=M;M++)E=h(),A[M]=E[2]<<24|E[1]<<16|E[0];var O=x?new Uint32Array(A):A,P=w;d.prototype.n=function(){var e,n,s,r,o=0;switch(r=this.a,e=G){case G:n=Math.LOG2E*Math.log(32768)-8;break;default:t(Error("invalid compression method"))}switch(n=n<<4|e,r[o++]=n,e){case G:switch(this.h){case P.NONE:s=0;break;case P.r:s=1;break;case P.j:s=2;break;default:t(Error("unsupported compression type"))}break;default:t(Error("invalid compression method"))}return e=s<<6|0,r[o++]=e|31-(256*n+e)%31,e=i(this.input),this.z.b=o,r=this.z.n(),o=r.length,x&&((r=new Uint8Array(r.buffer)).length<=o+4&&(this.a=new Uint8Array(r.length+4),this.a.set(r),r=this.a),r=r.subarray(0,o+4)),r[o++]=e>>24&255,r[o++]=e>>16&255,r[o++]=e>>8&255,r[o++]=255&e,r},e("Zlib.Deflate",d),e("Zlib.Deflate.compress",function(t,e){return new d(t,e).n()}),e("Zlib.Deflate.CompressionType",P),e("Zlib.Deflate.CompressionType.NONE",P.NONE),e("Zlib.Deflate.CompressionType.FIXED",P.r),e("Zlib.Deflate.CompressionType.DYNAMIC",P.j);var B=0,S=1,w={D:B,C:S};p.prototype.p=function(){for(;!this.s;){switch(1&(e=_(this,3))&&(this.s=v),e>>>=1){case 0:var e=this.input,i=this.c,n=this.a,s=this.b,r=y,o=y,a=y,h=n.length,r=y;switch(this.e=this.g=0,(r=e[i++])===y&&t(Error("invalid uncompressed block header: LEN (first byte)")),o=r,(r=e[i++])===y&&t(Error("invalid uncompressed block header: LEN (second byte)")),o|=r<<8,(r=e[i++])===y&&t(Error("invalid uncompressed block header: NLEN (first byte)")),a=r,(r=e[i++])===y&&t(Error("invalid uncompressed block header: NLEN (second byte)")),a|=r<<8,o===~a&&t(Error("invalid uncompressed block header: length verify")),i+o>e.length&&t(Error("input buffer is broken")),this.m){case B:for(;s+o>n.length;){if(r=h-s,o-=r,x)n.set(e.subarray(i,i+r),s),s+=r,i+=r;else for(;r--;)n[s++]=e[i++];this.b=s,n=this.f(),s=this.b}break;case S:for(;s+o>n.length;)n=this.f({v:2});break;default:t(Error("invalid inflate mode"))}if(x)n.set(e.subarray(i,i+o),s),s+=o,i+=o;else for(;o--;)n[s++]=e[i++];this.c=i,this.b=s,this.a=n;break;case 1:this.o(Y,H);break;case 2:f(this);break;default:t(Error("unknown BTYPE: "+e))}}return this.t()},A=[16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15];var R=x?new Uint16Array(A):A;A=[3,4,5,6,7,8,9,10,11,13,15,17,19,23,27,31,35,43,51,59,67,83,99,115,131,163,195,227,258,258,258];var N=x?new Uint16Array(A):A;A=[0,0,0,0,0,0,0,0,1,1,1,1,2,2,2,2,3,3,3,3,4,4,4,4,5,5,5,5,0,0,0];var k=x?new Uint8Array(A):A;A=[1,2,3,4,5,7,9,13,17,25,33,49,65,97,129,193,257,385,513,769,1025,1537,2049,3073,4097,6145,8193,12289,16385,24577];var F=x?new Uint16Array(A):A;A=[0,0,0,0,1,1,2,2,3,3,4,4,5,5,6,6,7,7,8,8,9,9,10,10,11,11,12,12,13,13];var X=x?new Uint8Array(A):A;for(E=0,C=(A=new(x?Uint8Array:Array)(288)).length;E<C;++E)A[E]=143>=E?8:255>=E?9:279>=E?7:8;var Y=r(A);for(E=0,C=(A=new(x?Uint8Array:Array)(30)).length;E<C;++E)A[E]=5;var H=r(A);for(p.prototype.o=function(t,e){var i=this.a,n=this.b;this.u=t;for(var s,r,o,a=i.length-258;256!==(s=g(this,t));)if(256>s)n>=a&&(this.b=n,i=this.f(),n=this.b),i[n++]=s;else for(o=N[s-=257],0<k[s]&&(o+=_(this,k[s])),s=g(this,e),r=F[s],0<X[s]&&(r+=_(this,X[s])),n>=a&&(this.b=n,i=this.f(),n=this.b);o--;)i[n]=i[n++-r];for(;8<=this.e;)this.e-=8,this.c--;this.b=n},p.prototype.I=function(t,e){var i=this.a,n=this.b;this.u=t;for(var s,r,o,a=i.length;256!==(s=g(this,t));)if(256>s)n>=a&&(i=this.f(),a=i.length),i[n++]=s;else for(o=N[s-=257],0<k[s]&&(o+=_(this,k[s])),s=g(this,e),r=F[s],0<X[s]&&(r+=_(this,X[s])),n+o>a&&(i=this.f(),a=i.length);o--;)i[n]=i[n++-r];for(;8<=this.e;)this.e-=8,this.c--;this.b=n},p.prototype.f=function(){var t,e,i=new(x?Uint8Array:Array)(this.b-32768),n=this.b-32768,s=this.a;if(x)i.set(s.subarray(32768,i.length));else for(t=0,e=i.length;t<e;++t)i[t]=s[t+32768];if(this.k.push(i),this.q+=i.length,x)s.set(s.subarray(n,n+32768));else for(t=0;32768>t;++t)s[t]=s[n+t];return this.b=32768,s},p.prototype.J=function(t){var e,i,n,s,r=this.input.length/this.c+1|0,o=this.input,a=this.a;return t&&("number"==typeof t.v&&(r=t.v),"number"==typeof t.F&&(r+=t.F)),2>r?(i=(o.length-this.c)/this.u[2],s=i/2*258|0,n=s<a.length?a.length+s:a.length<<1):n=a.length*r,x?(e=new Uint8Array(n)).set(a):e=a,this.a=e},p.prototype.t=function(){var t,e,i,n,s,r=0,o=this.a,a=this.k,h=new(x?Uint8Array:Array)(this.q+(this.b-32768));if(0===a.length)return x?this.a.subarray(32768,this.b):this.a.slice(32768,this.b);for(e=0,i=a.length;e<i;++e)for(n=0,s=(t=a[e]).length;n<s;++n)h[r++]=t[n];for(e=32768,i=this.b;e<i;++e)h[r++]=o[e];return this.k=[],this.buffer=h},p.prototype.H=function(){var t,e=this.b;return x?this.B?(t=new Uint8Array(e)).set(this.a.subarray(0,e)):t=this.a.subarray(0,e):(this.a.length>e&&(this.a.length=e),t=this.a),this.buffer=t},m.prototype.p=function(){var e,n=this.input;return e=this.A.p(),this.c=this.A.c,this.M&&(n[this.c++]<<24|n[this.c++]<<16|n[this.c++]<<8|n[this.c++])>>>0!==i(e)&&t(Error("invalid adler-32 checksum")),e},e("Zlib.Inflate",m),e("Zlib.Inflate.BufferType",w),w.ADAPTIVE=w.C,w.BLOCK=w.D,e("Zlib.Inflate.prototype.decompress",m.prototype.p),w=[16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15],x&&new Uint16Array(w),w=[3,4,5,6,7,8,9,10,11,13,15,17,19,23,27,31,35,43,51,59,67,83,99,115,131,163,195,227,258,258,258],x&&new Uint16Array(w),w=[0,0,0,0,0,0,0,0,1,1,1,1,2,2,2,2,3,3,3,3,4,4,4,4,5,5,5,5,0,0,0],x&&new Uint8Array(w),w=[1,2,3,4,5,7,9,13,17,25,33,49,65,97,129,193,257,385,513,769,1025,1537,2049,3073,4097,6145,8193,12289,16385,24577],x&&new Uint16Array(w),w=[0,0,0,0,1,1,2,2,3,3,4,4,5,5,6,6,7,7,8,8,9,9,10,10,11,11,12,12,13,13],x&&new Uint8Array(w),A=0,E=(w=new(x?Uint8Array:Array)(288)).length;A<E;++A)w[A]=143>=A?8:255>=A?9:279>=A?7:8;for(r(w),A=0,E=(w=new(x?Uint8Array:Array)(30)).length;A<E;++A)w[A]=5;r(w);var G=8}.call(this),function(t){var e=function(){function e(){this._isSupportDOMParser=this._xmlDict=this._parser=null,this._xmlDict={},window.DOMParser?(this._isSupportDOMParser=!0,this._parser=new DOMParser):this._isSupportDOMParser=!1}return e.getInstance=function(){return e._instance||(e._instance=new e),e._instance},e.prototype.parse=function(e){i=e;e=this.getList(e),"plist"!=(e=this.parserXML(e).documentElement).tagName&&t.Logger.fatal(i+"不是plist或者没有预加载plist");for(var i=null,n=0,s=e.childNodes.length;n<s&&1!=(i=e.childNodes[n]).nodeType;n++);return this.parseNode(i)},e.prototype.tmxParse=function(t,e){return void 0===e&&(e=!1),e||(t=this.getList(t)),this.parserXML(t)},e.prototype.parserXML=function(e){var i;return this._isSupportDOMParser?i=this._parser.parseFromString(e,"text/xml"):(i=new ActiveXObject("Microsoft.XMLDOM"),i.async="false",i.loadXML(e)),null==i&&t.Logger.info("xml not found!"),i},e.prototype.parseNode=function(t){e=null;switch(t.tagName){case"dict":e=this.parseDict(t);break;case"array":e=this.parseArray(t);break;case"string":if(1==t.childNodes.length)e=t.firstChild.nodeValue;else for(var e="",i=0;i<t.childNodes.length;i++)e+=t.childNodes[i].nodeValue;break;case"false":e=!1;break;case"true":e=!0;break;case"real":e=parseFloat(t.firstChild.nodeValue);break;case"integer":e=parseInt(t.firstChild.nodeValue,10)}return e},e.prototype.parseArray=function(t){for(var e=[],i=0,n=t.childNodes.length;i<n;i++){var s=t.childNodes[i];1==s.nodeType&&e.push(this.parseNode(s))}return e},e.prototype.parseDict=function(t){for(var e={},i=null,n=0,s=t.childNodes.length;n<s;n++){var r=t.childNodes[n];1==r.nodeType&&("key"==r.tagName?i=r.firstChild.nodeValue:e[i]=this.parseNode(r))}return e},e.prototype.getName=function(t){var e=t.lastIndexOf("/",t.length)+1,i=t.lastIndexOf(".",t.length);return t.substring(e,i)},e.prototype.getExt=function(t){var e=t.lastIndexOf(".",t.length)+1;return t.substring(e,t.length)},e.prototype.getList=function(t){return null!=this._xmlDict?this._xmlDict[t]:null},e._instance=null,e}();t.SAXParser=e}(ns_egret||(ns_egret={})),function(t){var e=function(){function e(){}return e.convert=function(e){if(1<arguments.length)t.DOM.convert(arguments);else if(1!=arguments.length||arguments[0].length)for(var i=arguments[0],n=0;n<i.length;n++)i[n]instanceof t.DisplayObjectContainer?i[n].dom||t.DOM.forSprite(i[n]):t.Logger.info("DOM转换器只支持DisplayObjectContainer"),i[n].visit=function(){},i[n].transform=function(){},t.DOM.setTransform(i[n]),i[n].visible=i[n].visible;else t.DOM.convert([arguments[0]])},e.forSprite=function(e){e.dom=t.Browser.getInstance().$new("div"),e.canvas=t.Browser.getInstance().$new("canvas"),e.canvas.width=e.width,e.canvas.height=e.height,e.dom.style.position="absolute",e.ctx=e.canvas.getContext("2d"),e.dom.appendChild(e.canvas),e.parent&&t.DOM.parentDOM(e),e.isSprite=!0},e.parentDOM=function(e){var i=e.parent;if(!i||!e.dom)return!1;if(i.dom||t.DOM.placeHolder(i),e.dom.appendTo(i.dom),i.parent)t.DOM.parentDOM(i);else if(e=t.Browser.getInstance().$("#StageDelegateDiv"))i.dom.appendTo(e);else{(e=t.Browser.getInstance().$new("div")).id="StageDelegateDiv";var n=t.StageDelegate.getInstance(),s=n.getFrameWidth(),r=n.getFrameHeight(),o=n.getDesignWidth(),a=n.getDesignHeight();0===o&&0===a&&(o=s,a=r),e.style.position="absolute",e.style.width=o+"px",e.style.maxHeight=a+"px",e.style.margin=0,e.resize(n.getScaleX(),n.getScaleY()),i.dom.appendTo(e),e.appendTo(document.getElementById(t.StageDelegate.canvas_div_name))}return!0},e.placeHolder=function(e){e.dom=t.Browser.getInstance().$new("div"),e.placeholder=!0,e.dom.style.position="absolute",e.dom.style.width=(e.width||t.MainContext.instance.stage.stageWidth)+"px",e.dom.style.maxHeight=(e.height||t.MainContext.instance.stage.stageHeight)+"px",e.dom.style.margin=0,t.DOM.setTransform(e),e.dom.transforms()},e.setTransform=function(t){t.dom&&(t.dom.position.x=t.x,t.dom.position.y=t.y,t.dom.rotation=t.rotation,t.dom.scale={x:t.scaleX,y:t.scaleY},t.dom.skew={x:t.skewX,y:t.skewX},t.dom.transforms())},e}();t.DOM=e}(ns_egret||(ns_egret={})),function(t){var e=function(){function e(){this.translate=this.isHD?function(e){return"translate3d("+e.x+"px, "+(e.y-t.MainContext.instance.stage.stageHeight)+"px, 0) "}:function(t){return console.log("translate("+t.x+"px, "+t.y+"px) "),"translate("+t.x+"px, "+t.y+"px) "},this.rotate=this.isHD?function(t){return"rotateZ("+t+"deg) "}:function(t){return"rotate("+t+"deg) "},this.ua=navigator.userAgent.toLowerCase();var e=this.ua.match(/micromessenger|qqbrowser|mqqbrowser|ucbrowser|360browser|baidubrowser|maxthon|ie|opera|firefox/)||this.ua.match(/chrome|safari/);switch(e&&0<e.length&&("micromessenger"==(e=e[0])&&(this.type="wechat"),this.type=e),this.type="unknow",this.type){case"firefox":this.pfx="Moz",this.isHD=!0;break;case"chrome":case"safari":this.pfx="webkit",this.isHD=!0;break;case"opera":this.pfx="O",this.isHD=!1;break;case"ie":this.pfx="ms",this.isHD=!1;break;default:this.pfx="webkit",this.isHD=!0}this.trans=this.pfx+"Transform",this.isMobile=-1!=this.ua.indexOf("mobile")||-1!=this.ua.indexOf("android")}return e.getInstance=function(){return null==e.instance&&(e.instance=new e),e.instance},e.prototype.$new=function(t){return this.$(document.createElement(t))},e.prototype.$=function(i){var n=document;return(i=i instanceof HTMLElement?i:n.querySelector(i))&&(i.find=i.find||this.$,i.hasClass=i.hasClass||function(t){return this.className.match(RegExp("(\\s|^)"+t+"(\\s|$)"))},i.addClass=i.addClass||function(t){return this.hasClass(t)||(this.className&&(this.className+=" "),this.className+=t),this},i.removeClass=i.removeClass||function(t){return this.hasClass(t)&&(this.className=this.className.replace(t,"")),this},i.remove=i.remove||function(){},i.appendTo=i.appendTo||function(t){return t.appendChild(this),this},i.prependTo=i.prependTo||function(t){return t.childNodes[0]?t.insertBefore(this,t.childNodes[0]):t.appendChild(this),this},i.transforms=i.transforms||function(){return this.style[e.getInstance().trans]=e.getInstance().translate(this.position)+e.getInstance().rotate(this.rotation)+e.getInstance().scale(this.scale)+e.getInstance().skew(this.skew),this},i.position=i.position||{x:0,y:0},i.rotation=i.rotation||0,i.scale=i.scale||{x:1,y:1},i.skew=i.skew||{x:0,y:0},i.translates=function(e,i){return this.position.x=e,this.position.y=i-t.MainContext.instance.stage.stageHeight,this.transforms(),this},i.rotate=function(t){return this.rotation=t,this.transforms(),this},i.resize=function(t,e){return this.scale.x=t,this.scale.y=e,this.transforms(),this},i.setSkew=function(t,e){return this.skew.x=t,this.skew.y=e,this.transforms(),this}),i},e.prototype.scale=function(t){return"scale("+t.x+", "+t.y+") "},e.prototype.skew=function(t){return"skewX("+-t.x+"deg) skewY("+t.y+"deg)"},e}();t.Browser=e}(ns_egret||(ns_egret={})),__extends=this.__extends||function(t,e){function i(){this.constructor=t}for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n]);i.prototype=e.prototype,t.prototype=new i},function(t){var e=function(e){function i(t,i,n){e.call(this),this.target=null,this.loop=this.ignoreGlobalPause=this._useTicks=!1,this._actions=this._steps=this._initQueueProps=this._curQueueProps=this.pluginData=null,this.paused=!1,this.duration=0,this._prevPos=-1,this.position=null,this._stepPosition=this._prevPosition=0,this.passive=!1,this.initialize(t,i,n)}return __extends(i,e),i.get=function(t,e,n,s){return void 0===e&&(e=null),void 0===n&&(n=null),void 0===s&&(s=!1),s&&i.removeTweens(t),new i(t,e,n)},i.removeTweens=function(e){if(e.tween_count){for(var n=i._tweens,s=n.length-1;0<=s;s--)n[s].target==e&&(n[s].paused=!0,n.splice(s,1));e.tween_count=0}else t.Logger.warning("target没有正在执行tween")},i.tick=function(t,e){void 0===e&&(e=!1);for(var n=i._tweens,s=n.length-1;0<=s;s--){var r=n[s];e&&!r.ignoreGlobalPause||r.paused||r.tick(r._useTicks?1:t)}},i._register=function(e,n){var s=e.target,r=i._tweens;if(n)s&&(s.tween_count=s.tween_count?s.tween_count+1:1),r.push(e),i._inited||(t.Ticker.getInstance().register(i.tick,null),i._inited=!0);else for(s&&s.tween_count--,s=r.length;s--;)if(r[s]==e){r.splice(s,1);break}},i.removeAllTweens=function(){for(var t=i._tweens,e=0,n=t.length;e<n;e++){var s=t[e];s.paused=!0,s.target.tweenjs_count=0}t.length=0},i.prototype.initialize=function(t,e,n){this.target=t,e&&(this._useTicks=e.useTicks,this.ignoreGlobalPause=e.ignoreGlobalPause,this.loop=e.loop,e.onChange&&this.addEventListener("change",e.onChange,e.onChangeObj),e.override&&i.removeTweens(t)),this.pluginData=n||{},this._curQueueProps={},this._initQueueProps={},this._steps=[],this._actions=[],e&&e.paused?this.paused=!0:i._register(this,!0),e&&null!=e.position&&this.setPosition(e.position,i.NONE)},i.prototype.setPosition=function(t,e){void 0===e&&(e=1),0>t&&(t=0);var i=t,n=!1;if(i>=this.duration&&(this.loop?i%=this.duration:(i=this.duration,n=!0)),i==this._prevPos)return n;var s=this._prevPos;if(this.position=this._prevPos=i,this._prevPosition=t,this.target)if(n)this._updateTargetProps(null,1);else if(0<this._steps.length){for(var r=0,o=this._steps.length;r<o&&!(this._steps[r].t>i);r++);r=this._steps[r-1],this._updateTargetProps(r,(this._stepPosition=i-r.t)/r.d)}return 0!=e&&0<this._actions.length&&(this._useTicks?this._runActions(i,i):1==e&&i<s?(s!=this.duration&&this._runActions(s,this.duration),this._runActions(0,i,!0)):this._runActions(s,i)),n&&this.setPaused(!0),this.dispatchEvent("change"),n},i.prototype._runActions=function(t,e,i){void 0===i&&(i=!1);var n=t,s=e,r=-1,o=this._actions.length,a=1;for(t>e&&(n=e,s=t,r=o,o=a=-1);(r+=a)!=o;){var h=(e=this._actions[r]).t;(h==s||h>n&&h<s||i&&h==t)&&e.f.apply(e.o,e.p)}},i.prototype._updateTargetProps=function(t,e){var n,s,r,o;if(t||1!=e){if(this.passive=!!t.v)return;t.e&&(e=t.e(e,0,1,1)),n=t.p0,s=t.p1}else this.passive=!1,n=s=this._curQueueProps;for(var a in this._initQueueProps){null==(r=n[a])&&(n[a]=r=this._initQueueProps[a]),null==(o=s[a])&&(s[a]=o=r),r=r==o||0==e||1==e||"number"!=typeof r?1==e?o:r:r+(o-r)*e;var h=!1;if(o=i._plugins[a])for(var u=0,c=o.length;u<c;u++){var l=o[u].tween(this,a,r,n,s,e,!!t&&n==s,!t);l==i.IGNORE?h=!0:r=l}h||(this.target[a]=r)}},i.prototype.setPaused=function(t){return this.paused=t,i._register(this,!t),this},i.prototype._cloneProps=function(t){var e,i={};for(e in t)i[e]=t[e];return i},i.prototype._addStep=function(t){return 0<t.d&&(this._steps.push(t),t.t=this.duration,this.duration+=t.d),this},i.prototype._appendQueueProps=function(t){var e,n,s,r,o,a;for(a in t)if(void 0===this._initQueueProps[a]){if(n=this.target[a],e=i._plugins[a])for(s=0,r=e.length;s<r;s++)n=e[s].init(this,a,n);this._initQueueProps[a]=this._curQueueProps[a]=void 0===n?null:n}for(a in t){if(n=this._curQueueProps[a],e=i._plugins[a])for(o=o||{},s=0,r=e.length;s<r;s++)e[s].step&&e[s].step(this,a,n,t[a],o);this._curQueueProps[a]=t[a]}return o&&this._appendQueueProps(o),this._curQueueProps},i.prototype._addAction=function(t){return t.t=this.duration,this._actions.push(t),this},i.prototype._set=function(t,e){for(var i in t)e[i]=t[i]},i.prototype.wait=function(t,e){if(void 0===e&&(e=!1),null==t||0>=t)return this;var i=this._cloneProps(this._curQueueProps);return this._addStep({d:t,p0:i,p1:i,v:e})},i.prototype.to=function(t,e,i){return void 0===i&&(i=void 0),(isNaN(e)||0>e)&&(e=0),this._addStep({d:e||0,p0:this._cloneProps(this._curQueueProps),e:i,p1:this._cloneProps(this._appendQueueProps(t))})},i.prototype.call=function(t,e,i){return void 0===e&&(e=void 0),void 0===i&&(i=void 0),this._addAction({f:t,p:i||[this],o:e||this.target})},i.prototype.set=function(t,e){return void 0===e&&(e=null),this._addAction({f:this._set,o:this,p:[t,e||this.target]})},i.prototype.play=function(t){return t||(t=this),this.call(t.setPaused,[!1],t)},i.prototype.pause=function(t){return t||(t=this),this.call(t.setPaused,[!0],t)},i.prototype.tick=function(t){this.paused||this.setPosition(this._prevPosition+t)},i.NONE=0,i.LOOP=1,i.REVERSE=2,i._tweens=[],i.IGNORE={},i._plugins={},i._inited=!1,i}(t.EventDispatcher);t.Tween=e}(ns_egret||(ns_egret={})),function(t){var e=function(){function e(){t.Logger.fatal("Ease不能被实例化")}return e.get=function(t){return-1>t&&(t=-1),1<t&&(t=1),function(e){return 0==t?e:0>t?e*(e*-t+1+t):e*((2-e)*t+(1-t))}},e.getPowIn=function(t){return function(e){return Math.pow(e,t)}},e.getPowOut=function(t){return function(e){return 1-Math.pow(1-e,t)}},e.getPowInOut=function(t){return function(e){return 1>(e*=2)?.5*Math.pow(e,t):1-.5*Math.abs(Math.pow(2-e,t))}},e.sineIn=function(t){return 1-Math.cos(t*Math.PI/2)},e.sineOut=function(t){return Math.sin(t*Math.PI/2)},e.sineInOut=function(t){return-.5*(Math.cos(Math.PI*t)-1)},e.getBackIn=function(t){return function(e){return e*e*((t+1)*e-t)}},e.getBackOut=function(t){return function(e){return(e-=1)*e*((t+1)*e+t)+1}},e.getBackInOut=function(t){return t*=1.525,function(e){return 1>(e*=2)?.5*e*e*((t+1)*e-t):.5*((e-=2)*e*((t+1)*e+t)+2)}},e.circIn=function(t){return-(Math.sqrt(1-t*t)-1)},e.circOut=function(t){return Math.sqrt(1-t*t)},e.circInOut=function(t){return 1>(t*=2)?-.5*(Math.sqrt(1-t*t)-1):.5*(Math.sqrt(1-(t-=2)*t)+1)},e.bounceIn=function(t){return 1-e.bounceOut(1-t)},e.bounceOut=function(t){return t<1/2.75?7.5625*t*t:t<2/2.75?7.5625*(t-=1.5/2.75)*t+.75:t<2.5/2.75?7.5625*(t-=2.25/2.75)*t+.9375:7.5625*(t-=2.625/2.75)*t+.984375},e.bounceInOut=function(t){return.5>t?.5*e.bounceIn(2*t):.5*e.bounceOut(2*t-1)+.5},e.getElasticIn=function(t,e){var i=2*Math.PI;return function(n){if(0==n||1==n)return n;var s=e/i*Math.asin(1/t);return-t*Math.pow(2,10*(n-=1))*Math.sin((n-s)*i/e)}},e.getElasticOut=function(t,e){var i=2*Math.PI;return function(n){if(0==n||1==n)return n;var s=e/i*Math.asin(1/t);return t*Math.pow(2,-10*n)*Math.sin((n-s)*i/e)+1}},e.getElasticInOut=function(t,e){var i=2*Math.PI;return function(n){var s=e/i*Math.asin(1/t);return 1>(n*=2)?-.5*t*Math.pow(2,10*(n-=1))*Math.sin((n-s)*i/e):.5*t*Math.pow(2,-10*(n-=1))*Math.sin((n-s)*i/e)+1}},e.quadIn=e.getPowIn(2),e.quadOut=e.getPowOut(2),e.quadInOut=e.getPowInOut(2),e.cubicIn=e.getPowIn(3),e.cubicOut=e.getPowOut(3),e.cubicInOut=e.getPowInOut(3),e.quartIn=e.getPowIn(4),e.quartOut=e.getPowOut(4),e.quartInOut=e.getPowInOut(4),e.quintIn=e.getPowIn(5),e.quintOut=e.getPowOut(5),e.quintInOut=e.getPowInOut(5),e.backIn=e.getBackIn(1.7),e.backOut=e.getBackOut(1.7),e.backInOut=e.getBackInOut(1.7),e.elasticIn=e.getElasticIn(1,.3),e.elasticOut=e.getElasticOut(1,.3),e.elasticInOut=e.getElasticInOut(1,.3*1.5),e}();t.Ease=e}(ns_egret||(ns_egret={})),function(t){var e=function(){function t(){}return t.getInstance=function(){return null==t.context&&(t.context=new t),t.context},t.prototype.preloadSound=function(t){},t.prototype.playMusic=function(t,e){},t.prototype.stopMusic=function(t){},t.context=null,t.isMusicPlaying=!1,t}();t.SoundContext=e}(ns_egret||(ns_egret={})),__extends=this.__extends||function(t,e){function i(){this.constructor=t}for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n]);i.prototype=e.prototype,t.prototype=new i},function(t){var e=function(e){function i(){e.call(this),this._soundList={},this._canPlay=!0,this._supportedFormat=[];var t=this._capabilities={mp3:!1,ogg:!1,wav:!1,mp4:!1,m4a:!1};this._checkCanPlay(t);for(var i in t)if(t[i]){this._soundSupported=!0;break}t=navigator.userAgent,(/Mobile/.test(t)&&(/iPhone OS/.test(t)||/iPad/.test(t)||/Firefox/.test(t))||/MSIE/.test(t))&&(this._canPlay=!1),this._getSupportedAudioFormat()}return __extends(i,e),i.prototype._checkCanPlay=function(t){var e=document.createElement("audio");if(e.canPlayType){var i=function(t){return"no"!=(t=e.canPlayType(t))&&""!=t};t.mp3=i("audio/mpeg"),t.mp4=i("audio/mp4"),t.m4a=i("audio/x-m4a")||i("audio/aac"),t.ogg=i('audio/ogg; codecs="vorbis"'),t.wav=i('audio/wav; codecs="1"')}},i.prototype.preloadSound=function(e){if(this._soundSupported){var i=this._getExtFromFullPath(e);if(this.isFormatSupported(i)&&!this._soundList.hasOwnProperty(e)&&this._canPlay){(i=new Audio(t.ResourceLoader.prefix+e)).preload="auto";var n=function(t){this.removeEventListener("canplaythrough",n,!1),this.removeEventListener("error",s,!1)},s=function(t){this.removeEventListener("canplaythrough",n,!1),this.removeEventListener("error",s,!1)};i.addEventListener("canplaythrough",n,!1),i.addEventListener("error",s,!1),this._soundList[e]=i,i.load()}}},i.prototype._getSupportedAudioFormat=function(){if(this._soundSupported){var t,e=["ogg","mp3","wav","mp4","m4a"];for(t in e){var i=e[t];this._capabilities[i]&&this._supportedFormat.push(i)}}},i.prototype.isFormatSupported=function(t){var e,i=this._supportedFormat;for(e in i)if(t===i[e])return!0;return!1},i.prototype._getExtFromFullPath=function(t){var e=t.lastIndexOf(".");return-1!==e?t.substring(e+1,t.length):""},i.prototype.playMusic=function(e,i){if(void 0===i&&(i=!0),this._soundSupported){var n,s=this._soundList;s.hasOwnProperty(this._playingMusicName)&&s[this._playingMusicName].pause(),this._playingMusicName=e,s.hasOwnProperty(this._playingMusicName)?n=s[this._playingMusicName]:(n=new Audio(t.ResourceLoader.prefix+e),n.preload="auto",s[e]=n,n.load()),n.addEventListener("pause",function(){t.SoundContext.isMusicPlaying=!1,this.removeEventListener("pause",arguments.callee,!1)},!1),isNaN(n.duration)||(n.currentTime=0),n.loop=i,n.play(),t.SoundContext.isMusicPlaying=!0}},i.prototype.stopMusic=function(e){var i=this._soundList,n=this._playingMusicName;if(i.hasOwnProperty(n)){var s=i[n];s.pause(),s.currentTime=s.duration,e&&delete i[n],t.SoundContext.isMusicPlaying=!1}},i}(t.SoundContext);t.HTML5SoundContext=e}(ns_egret||(ns_egret={})),__extends=this.__extends||function(t,e){function i(){this.constructor=t}for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n]);i.prototype=e.prototype,t.prototype=new i},function(t){var e=function(e){function i(){e.apply(this,arguments),this.viewPortWidth=400}return __extends(i,e),i.createWithFile=function(t){var e=new i;return e.initWithTMXFile(t),e},i.prototype.initWithTMXFile=function(e){(!e||0==e.length)&&t.Logger.fatal("TMXTiledMap.initWithTMXFile(): tmxFile应该是不为null的string");var i=t.TMXMapInfo.createWithFile(e);if(i){var n=i.getTilesets();(!n||0===n.length)&&t.Logger.info("TMXTiledMap.initWithTMXFile(): Map没有",e),this.buildWithMapInfo(i)}},i.prototype.buildWithMapInfo=function(t){this.mapInfo=t;var i=0,n=t.getLayers();if(n)for(var s=null,r=0,o=n.length;r<o;r++)(s=n[r])&&s.visible&&(s=this.parseLayer(s,t),e.prototype.addChild.call(this,s,i),i++)},i.prototype.parseLayer=function(e,i){var n=this.tilesetForLayer(e,i),n=t.TMXLayer.create(n,e,i);return e.ownTiles=!1,n.setupTiles(),n},i.prototype.tilesetForLayer=function(e,i){var n=e.layerWidth,s=e.layerHeight,r=i.getTilesets();if(r)for(var o=r.length-1;0<=o;o--){var a=r[o];if(a)for(var h=0;h<s;h++)for(var u=0;u<n;u++){var c=e._tiles[u+n*h];if(0!=c&&(c&t.TMX.TILE_FLIPPED_MASK)>>>0>=a.firstGid)return a}}return t.Logger.warning("TMXLayer"+e.name+"没有tiles"),null},i.prototype.getLayer=function(i){(!i||0===i.length)&&t.Logger.fatal("TMXTiledMap.getLayer(): layerName应该是不为null的string");for(var n=this.numChildren,s=0;s<n;s++){var r=e.prototype.getChildAt.call(this,s);if(r&&r.getLayerName&&r.getLayerName()==i)return r}return null},i.prototype.getObjectGroup=function(e){(!e||0===e.length)&&t.Logger.fatal("TMXTiledMap.getObjectGroup(): groupName应该是不为null的string");var i=this.mapInfo.getObjectGroups;if(i)for(var n=0,s=i.length;n<s;n++){var r=i[n];if(r&&r.getGroupName()==e)return r}return null},i.prototype.propertiesForGID=function(t){return this.mapInfo.getTileProperties()[t]},i.prototype.getProperty=function(t){return this.mapInfo.getProperties()[t.toString()]},i.prototype.setMoveX=function(e){this.x=e,e=this.numChildren;for(var i=0;i<e;i++){var n=this.getChildAt(i);if(n instanceof t.TMXLayer){if(n.visible)for(var s=0;s<n.numChildren;s++){var r=n.getChildAt(s);r.x+this.mapInfo.getTileWidth()<-this.x||r.x>-this.x+this.viewPortWidth?r.visible=!1:r.visible=!0}}else s=n.getBounds(),n.visible=!(n.x+s.width-n.anchorPointX<-this.x||n.x-n.anchorPointX>-this.x+this.viewPortWidth)}},i}(t.DisplayObjectContainer);t.TMXTiledMap=e}(ns_egret||(ns_egret={})),__extends=this.__extends||function(t,e){function i(){this.constructor=t}for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n]);i.prototype=e.prototype,t.prototype=new i},function(t){var e=function(e){function i(){e.apply(this,arguments),this._properties=this._layerOrientation=this._tileSet=this._tiles=this._mapTileHeight=this._mapTileWidth=this._layerHeight=this._layerWidth=this._texture=null,this._layerName="",this._opacity=1,this._atlasIndexArray=this._maxGID=this._minGID=null}return __extends(i,e),i.create=function(t,e,n){var s=new i;return s.initWithTilesetInfo(t,e,n),s},i.prototype.initWithTilesetInfo=function(e,i,n){this._texture=t.TextureCache.getInstance().getTexture(e.sourceImage),this._layerName=i.name,this._layerWidth=i.layerWidth,this._layerHeight=i.layerHeight,this._tiles=i._tiles,this._minGID=i._minGID,this._maxGID=i._maxGID,this._opacity=i.opacity,this.setProperties(i.getProperties()),this._tileSet=e,this._mapTileWidth=n.getTileWidth(),this._mapTileHeight=n.getTileHeight(),this._layerOrientation=n.getOrientation(),e=this.calculateLayerOffset(i.layerX,i.layerY),this.x=e.x,this.y=e.y,this._atlasIndexArray=[]},i.prototype.calculateLayerOffset=function(e,i){var n=t.Point.identity;switch(this._layerOrientation){case t.TMX.ORIENTATION_ORTHO:n.x=e*this._mapTileWidth,n.y=-i*this._mapTileHeight;break;case t.TMX.ORIENTATION_ISO:n.x=this._mapTileWidth/2*(e-i),n.y=this._mapTileHeight/2*(-e-i);break;case t.TMX.ORIENTATION_HEX:(0!==e||0!==i)&&t.Logger.info("hexagonal map还没有完成")}return n},i.prototype.setupTiles=function(){this._tileSet.imageWidth=this._texture.getTextureWidth(),this._tileSet.imageHeight=this._texture.getTextureHeight();for(var e=this._layerHeight,i=this._layerWidth,n=0;n<e;n++)for(var s=0;s<i;s++){var r=this._tiles[s+i*n];0!==r&&(this.appendTileForGID(r,s,n),this._minGID=Math.min(r,this._minGID),this._maxGID=Math.max(r,this._maxGID))}this._maxGID>=this._tileSet.firstGid&&this._minGID>=this._tileSet.firstGid||t.Logger.warning("每个layer只支持1个tileset")},i.prototype.appendTileForGID=function(t,i,n){var s=this._tileSet.rectForGID(t),s=this.reusedTileWithRect(s);return this.setupTileSprite(s,i,n,t),e.prototype.addChild.call(this,s,this._atlasIndexArray.length),s},i.prototype.reusedTileWithRect=function(e){var i=t.Bitmap.initWithTexture(t.TextureCache.getInstance().getTexture(this._tileSet.sourceImage)),n=new t.SpriteSheetFrame;return n.x=e.x,n.y=e.y,n.w=this._mapTileWidth,n.h=this._mapTileHeight,i.spriteFrame=n,i},i.prototype.setupTileSprite=function(t,e,i,n){e=this.getPositionAt(e,i),t.x=e.x,t.y=e.y},i.prototype.getPositionAt=function(e,i){var n=t.Point.identity;switch(this._layerOrientation){case t.TMX.ORIENTATION_ORTHO:n=this.positionForOrthoAt(e,i);break;case t.TMX.ORIENTATION_ISO:n=this.positionForIsoAt(e,i);break;case t.TMX.ORIENTATION_HEX:n=this.positionForHexAt(e,i);break;default:n.x=0,n.y=0}return n},i.prototype.positionForIsoAt=function(e,i){return t.Point.identity.x=this._mapTileWidth/2*(this._layerWidth+e-i-1),t.Point.identity.y=-this._mapTileHeight/2*(2*this._layerHeight-e-i-2),t.Point.identity},i.prototype.positionForOrthoAt=function(e,i){return t.Point.identity.x=e*this._mapTileWidth,t.Point.identity.y=-(this._layerHeight-i-1)*this._mapTileHeight,t.Point.identity},i.prototype.positionForHexAt=function(e,i){var n=1==e%2?-this._mapTileHeight/2:0;return t.Point.identity.x=3*e*this._mapTileWidth/4,t.Point.identity.y=-((this._layerHeight-i-1)*this._mapTileHeight+n),t.Point.identity},i.prototype.getTileGIDAt=function(e,i){return(e>=this._layerWidth||i>=this._layerHeight||0>e||0>i)&&t.Logger.fatal("TMXLayer.getTileGIDAt():提供的索引超出范围"),this._tiles&&this._atlasIndexArray?(this._tiles[0|e+i*this._layerWidth]&t.TMX.TILE_FLIPPED_MASK)>>>0:(t.Logger.info("TMXLayer.getTileGIDAt(): tileMap已经被销毁"),null)},i.prototype.getProperties=function(){return this._properties},i.prototype.setProperties=function(t){this._properties=t},i.prototype.getProperty=function(t){return this._properties[t]},i.prototype.getLayerName=function(){return this._layerName},i}(t.DisplayObjectContainer);t.TMXLayer=e}(ns_egret||(ns_egret={})),function(t){var e=function(){function t(){}return t.TILE_HORIZONTAL_FLAG=2147483648,t.TILE_VERTICAL_FLAG=1073741824,t.TILE_DIAGONAL_FLAG=536870912,t.TILE_FLIPPED_ALL=(t.TILE_HORIZONTAL_FLAG|t.TILE_VERTICAL_FLAG|t.TILE_DIAGONAL_FLAG)>>>0,t.TILE_FLIPPED_MASK=~t.TILE_FLIPPED_ALL>>>0,t.LAYER_ATTRIB_NONE=1,t.LAYER_ATTRIB_BASE64=2,t.LAYER_ATTRIB_GZIP=4,t.LAYER_ATTRIB_ZLIB=8,t.PROPERTY_NONE=0,t.PROPERTY_MAP=1,t.PROPERTY_LAYER=2,t.PROPERTY_OBJECTGROUP=3,t.PROPERTY_OBJECT=4,t.PROPERTY_TILE=5,t.ORIENTATION_ORTHO=0,t.ORIENTATION_HEX=1,t.ORIENTATION_ISO=2,t}();t.TMX=e}(ns_egret||(ns_egret={})),function(t){var e=function(){function e(){this._parentGID=this._objectGroups=this._tileSets=this._layers=this._tileHeight=this._tileWidth=this._mapHeight=this._mapWidth=this._orientation=null,this._storingCharacters=!1,this._tileProperties=this._currentString=this._TMXFileName=this._properties=null}return e.createWithFile=function(t){var i=new e;return i.initWithTMXFile(t),i},e.prototype.initWithTMXFile=function(t){this.internalInit(t),this.parseXMXFile(this._TMXFileName)},e.prototype.internalInit=function(t){this._tileSets=[],this._layers=[],this._TMXFileName=t,this._objectGroups=[],this._properties=[],this._tileProperties=[],this._currentString="",this._storingCharacters=!1},e.prototype.parseXMXFile=function(e){null==(a=t.ResourceLoader.create(e).data)&&t.Logger.fatal("tmx文件没有加载："+e);var r;if((e=t.SAXParser.getInstance().tmxParse(a,!0).documentElement).getAttribute("version"),a=e.getAttribute("orientation"),"map"==e.nodeName&&("orthogonal"==a?this.setOrientation(t.TMX.ORIENTATION_ORTHO):"isometric"==a?this.setOrientation(t.TMX.ORIENTATION_ISO):"hexagonal"==a?this.setOrientation(t.TMX.ORIENTATION_HEX):null!==a&&t.Logger.info("TMXFomat: Unsupported orientation:"+this.getOrientation()),this._mapWidth=parseFloat(e.getAttribute("width")),this._mapHeight=parseFloat(e.getAttribute("height")),this._tileWidth=parseFloat(e.getAttribute("tilewidth")),this._tileHeight=parseFloat(e.getAttribute("tileheight")),r=e.querySelectorAll("map > properties >  property"))){for(var o={},a=0;a<r.length;a++)o[r[a].getAttribute("name")]=r[a].getAttribute("value");this.setProperties(o)}for(r=e.getElementsByTagName("tileset"),"map"!==e.nodeName&&(r=[]).push(e),a=0;a<r.length;a++){if(o=(h=r[a]).getAttribute("source"))this.parseXMLFile(o);else{(o=new i).name=h.getAttribute("name")||"",o.firstGid=parseInt(h.getAttribute("firstgid"))||0,o.spacing=parseInt(h.getAttribute("spacing"))||0,o.margin=parseInt(h.getAttribute("margin"))||0,o.tileWidth=parseFloat(h.getAttribute("tilewidth")),o.tileHeight=parseFloat(h.getAttribute("tileheight"));var h=h.getElementsByTagName("image")[0].getAttribute("source"),u=-1;this._TMXFileName&&(u=this._TMXFileName.lastIndexOf("/")),-1!==u?(u=this._TMXFileName.substr(0,u+1),o.sourceImage=u+h):o.sourceImage=h,this.setTilesets(o)}}if(o=e.querySelectorAll("tile"))for(a=0;a<o.length;a++)if(r=o[a],this.setParentGID(parseInt(this._tileSets[0].firstGid)+parseInt(r.getAttribute("id")||0)),h=r.querySelectorAll("properties > property")){for(u={},r=0;r<h.length;r++){var c=h[r].getAttribute("name"),l=h[r].getAttribute("value");u[c]=l}this._tileProperties[this.getParentGID()]=u}if(o=e.getElementsByTagName("layer"))for(a=0;a<o.length;a++){for(c=(u=o[a]).getElementsByTagName("data")[0],(h=new s).name=u.getAttribute("name"),h.layerWidth=parseFloat(u.getAttribute("width")),h.layerHeight=parseFloat(u.getAttribute("height")),r=u.getAttribute("visible"),h.visible="0"!=r,r=u.getAttribute("opacity")||1,h.opacity=r?parseFloat(r):1,h.layerX=parseFloat(u.getAttribute("x"))||0,h.layerY=parseFloat(u.getAttribute("y"))||0,l="",r=0;r<c.childNodes.length;r++)l+=c.childNodes[r].nodeValue;l=l.trim(),r=c.getAttribute("compression");var d=c.getAttribute("encoding");if(r&&"gzip"!==r&&"zlib"!==r)return t.Logger.fatal("TMXMapInfo.parseXMLFile(): unsupported compression method"),null;switch(r){case"gzip":h._tiles=t.Utils.unzipBase64AsArray(l,4);break;case"zlib":r=new Zlib.Inflate(t.Codec.Base64.decodeAsArray(l,1)),h._tiles=t.Utils.uint8ArrayToUint32Array(r.decompress());break;case null:case"":if("base64"==d)h._tiles=t.Codec.Base64.decodeAsArray(l,4);else if("csv"===d)for(h._tiles=[],r=l.split(","),c=0;c<r.length;c++)h._tiles.push(parseInt(r[c]));else for(r=c.getElementsByTagName("tile"),h._tiles=[],c=0;c<r.length;c++)h._tiles.push(parseInt(r[c].getAttribute("gid")));break;default:t.Logger.info("TMXMapInfo.parseXMLFile(): Only base64 and/or gzip/zlib maps are supported")}if(u=u.querySelectorAll("properties > property")){for(c={},r=0;r<u.length;r++)c[u[r].getAttribute("name")]=u[r].getAttribute("value");h.setProperties(c)}this.setLayers(h)}if(o=e.getElementsByTagName("objectgroup"))for(a=0;a<o.length;a++){if(u=o[a],(h=new n).setGroupName(u.getAttribute("name")),h.setPositionOffsetX(parseFloat(u.getAttribute("x"))*this._tileWidth||0),h.setPositionOffsetY(parseFloat(u.getAttribute("y"))*this._tileHeight||0),c=u.querySelectorAll("objectgroup > properties > property"))for(r=0;r<c.length;r++)l={},l[c[r].getAttribute("name")]=c[r].getAttribute("value"),h.setProperties(l);if(u=u.querySelectorAll("object"))for(r=0;r<u.length;r++){if(l=u[r],c={},c.name=l.getAttribute("name")||"",c.type=l.getAttribute("type")||"",c.x=parseInt(l.getAttribute("x")||0)+h.getPositionOffsetX(),d=parseInt(l.getAttribute("y")||0)+h.getPositionOffsetY(),c.y=Math.floor(this._mapHeight*this._tileHeight)-d-c.height,c.width=parseInt(l.getAttribute("width"))||0,c.height=parseInt(l.getAttribute("height"))||0,d=l.querySelectorAll("properties > property"))for(var p=0;p<d.length;p++)c[d[p].getAttribute("name")]=d[p].getAttribute("value");(d=l.querySelectorAll("polygon"))&&0<d.length&&(d=d[0].getAttribute("points"))&&(c.polygonPoints=this.parsePointsString(d)),(l=l.querySelectorAll("polyline"))&&0<l.length&&(l=l[0].getAttribute("points"))&&(c.polylinePoints=this.parsePointsString(l)),h.addObject(c)}this.setObjectGroups(h)}return e},e.prototype.parsePointsString=function(t){if(!t)return null;var e=[];t=t.split(" ");for(var i=0;i<t.length;i++){var n=t[i].split(",");e.push({x:n[0],y:n[1]})}return e},e.prototype.getOrientation=function(){return this._orientation},e.prototype.setOrientation=function(t){this._orientation=t},e.prototype.getProperties=function(){return this._properties},e.prototype.setProperties=function(t){this._properties=t},e.prototype.getTilesets=function(){return this._tileSets},e.prototype.setTilesets=function(t){this._tileSets.push(t)},e.prototype.getParentGID=function(){return this._parentGID},e.prototype.setParentGID=function(t){this._parentGID=t},e.prototype.getLayers=function(){return this._layers},e.prototype.setLayers=function(t){this._layers.push(t)},e.prototype.getObjectGroups=function(){return this._objectGroups},e.prototype.setObjectGroups=function(t){this._objectGroups.push(t)},e.prototype.getTileProperties=function(){return this._tileProperties},e.prototype.setTileProperties=function(t){this._tileProperties.push(t)},e.prototype.getTileWidth=function(){return this._tileWidth},e.prototype.getTileHeight=function(){return this._tileHeight},e.prototype.getMapWidth=function(){return this._mapWidth},e.prototype.getMapHeight=function(){return this._mapHeight},e}();t.TMXMapInfo=e;var i=function(){function e(){this.name=""}return e.prototype.rectForGID=function(e){var i=t.Point.identity;e&=t.TMX.TILE_FLIPPED_MASK,e-=parseInt(this.firstGid,10);var n=Math.floor((this.imageWidth-2*this.margin+this.spacing)/(this.tileWidth+this.spacing));return i.x=parseInt(e%n*(this.tileWidth+this.spacing)+this.margin,10),i.y=parseInt(Math.floor(e/n)*(this.tileHeight+this.spacing)+this.margin,10),i},e}();t.TMXTilesetInfo=i;var n=function(){function t(){this._properties=[],this._objects=[]}return t.prototype.getGroupName=function(){return this._groupName},t.prototype.setGroupName=function(t){this._groupName=t},t.prototype.getPositionOffsetX=function(){return this._positionOffsetX},t.prototype.setPositionOffsetX=function(t){this._positionOffsetX=t},t.prototype.getPositionOffsetY=function(){return this._positionOffsetY},t.prototype.setPositionOffsetY=function(t){this._positionOffsetY=t},t.prototype.getProperties=function(){return this._properties},t.prototype.setProperties=function(t){this._properties.push(t)},t.prototype.getObjects=function(){return this._objects},t.prototype.addObject=function(t){this._objects.push(t)},t}();t.TMXObjectGroup=n;var s=function(){function t(){this._minGID=1e5,this._maxGID=0}return t.prototype.getProperties=function(){return this._properties},t.prototype.setProperties=function(t){this._properties=t},t}();t.TMXLayerInfo=s}(ns_egret||(ns_egret={})),__extends=this.__extends||function(t,e){function i(){this.constructor=t}for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n]);i.prototype=e.prototype,t.prototype=new i},function(t){var e=function(e){function i(){e.apply(this,arguments),this.className="VirtualJoystick",this.leftButtonWidth=79,this.leftButtonHeight=46,this.leftButtonOffset=30,this.leftTouchPointY=this.leftTouchPointX=this.bottomImageDownName=this.rightImageDownName=this.topImageDownName=this.leftImageDownName=this.bottomImageNormalName=this.rightImageNormalName=this.topImageNormalName=this.leftImageNormalName=this.bottomImageDown=this.rightImageDown=this.topImageDown=this.leftImageDown=this.bottomImageNormal=this.rightImageNormal=this.topImageNormal=this.leftImageNormal=this.bottomNode=this.rightNode=this.topNode=this.leftNode=null,this.isLeftTouching=!1,this.rightButtonImageDownName=this.rightButtonImageNormalName=this.rightButtonImageDown=this.rightButtonImageNormal=null,this.rightButtonWidth=0,this.rightTouchPointY=this.rightTouchPointX=null,this.isRightTouching=!1}return __extends(i,e),i.getInstance=function(){return null==i.instacce&&(i.instacce=new i),i.instacce},i.prototype.show=function(){this.leftContainer=new t.DisplayObjectContainer,this.leftContainer.touchEnabled=!0,this.addChild(this.leftContainer),this.leftNode=new t.DisplayObjectContainer,this.leftNode.x=-this.leftButtonWidth-this.leftButtonOffset,this.leftNode.y=-this.leftButtonHeight/2,this.leftContainer.addChild(this.leftNode),this.topNode=new t.DisplayObjectContainer,this.topNode.x=-this.leftButtonHeight/2,this.topNode.y=-this.leftButtonWidth-this.leftButtonOffset,this.leftContainer.addChild(this.topNode),this.rightNode=new t.DisplayObjectContainer,this.rightNode.x=this.leftButtonOffset,this.rightNode.y=-this.leftButtonHeight/2,this.leftContainer.addChild(this.rightNode),this.bottomNode=new t.DisplayObjectContainer,this.bottomNode.x=-this.leftButtonHeight/2,this.bottomNode.y=this.leftButtonOffset,this.leftContainer.addChild(this.bottomNode),this.rightButtonNode=new t.DisplayObjectContainer,this.addChild(this.rightButtonNode),this.resetLeft(),this.resetRight(),this.rightButtonWidth=this.rightButtonNode.getBounds().width,this.rightButtonNode.x=(t.StageDelegate.getInstance().getDesignWidth()-this.rightButtonWidth-this.x)/this.scaleX,this.rightButtonNode.y=-this.rightButtonWidth/2,this.rightButtonNode.touchEnabled=!0;var e=t.TextureCache.getInstance().getTexture("alpha_0.png"),e=t.Bitmap.initWithTexture(e),i=this.leftButtonWidth+this.leftButtonOffset;e.scaleX=e.scaleY=2*i,e.x=e.y=-i,this.leftContainer.addChild(e),this.leftContainer.addEventListener(t.TouchEvent.TOUCH_BEGAN,this.onLeftTouchBegin,this),this.leftContainer.addEventListener(t.TouchEvent.TOUCH_MOVE,this.onLeftTouchMoved,this),this.rightButtonNode.addEventListener(t.TouchEvent.TOUCH_BEGAN,this.onRightTouchBegin,this),this.rightButtonNode.addEventListener(t.TouchEvent.TOUCH_MOVE,this.onRightTouchMoved,this),t.MainContext.instance.stage.addEventListener(t.TouchEvent.TOUCH_END,this.onTouchEnded,this),t.Ticker.getInstance().register(this.update,this)},i.prototype.update=function(){null!=this.leftTouchPointX&&null!=this.leftTouchPointY&&this.isLeftTouching&&this.checkIsLeftTouchInside()&&this.sendLeftTouchEvent(),null!=this.rightTouchPointX&&null!=this.rightTouchPointY&&this.isRightTouching&&this.checkIsRightTouchInside()&&(this.changeBtnState(this.rightButtonNode,"Down"),this.dispatchEvent(i.ON_TOUCH_RIGHT))},i.prototype.resetLeft=function(){this.changeBtnState(this.leftNode,"Normal"),this.changeBtnState(this.topNode,"Normal"),this.changeBtnState(this.rightNode,"Normal"),this.changeBtnState(this.bottomNode,"Normal")},i.prototype.resetRight=function(){this.changeBtnState(this.rightButtonNode,"Normal")},i.prototype.changeBtnState=function(t,e){var i;switch(t){case this.leftNode:null==this["leftImage"+e]&&(this["leftImage"+e]=this.createBtn(this["leftImage"+e+"Name"])),i=this["leftImage"+e];break;case this.topNode:null==this["topImage"+e]&&(this["topImage"+e]=this.createBtn(this["topImage"+e+"Name"])),i=this["topImage"+e];break;case this.rightNode:null==this["rightImage"+e]&&(this["rightImage"+e]=this.createBtn(this["rightImage"+e+"Name"])),i=this["rightImage"+e];break;case this.bottomNode:null==this["bottomImage"+e]&&(this["bottomImage"+e]=this.createBtn(this["bottomImage"+e+"Name"])),i=this["bottomImage"+e];break;case this.rightButtonNode:null==this["rightButtonImage"+e]&&(this["rightButtonImage"+e]=this.createBtn(this["rightButtonImage"+e+"Name"])),i=this["rightButtonImage"+e]}t.removeAllChildren(),t.addChild(i)},i.prototype.createBtn=function(e){return t.Bitmap.initWithTexture(t.TextureCache.getInstance().getTexture(e))},i.prototype.onLeftTouchBegin=function(t,e){this.leftTouchId=e.touchId;var i=e.getLocalPoint();this.leftTouchPointX=i.x,this.leftTouchPointY=i.y,this.checkIsLeftTouchInside()&&(this.isLeftTouching=!0)},i.prototype.checkIsLeftTouchInside=function(){return this.leftTouchPointX*this.scaleX>-this.leftButtonWidth-this.leftButtonOffset&&this.leftTouchPointX*this.scaleX<this.leftButtonWidth+this.leftButtonOffset&&this.leftTouchPointY*this.scaleY>-this.leftButtonWidth-this.leftButtonOffset&&this.leftTouchPointY*this.scaleY<this.leftButtonWidth+this.leftButtonOffset},i.prototype.onLeftTouchMoved=function(t,e){var i=e.getLocalPoint();this.leftTouchPointX=i.x,this.leftTouchPointY=i.y},i.prototype.onTouchEnded=function(t,e){null!=this.leftTouchId&&this.leftTouchId!=e.touchId||(this.isLeftTouching&&(this.isLeftTouching=!1,this.resetLeft(),this.dispatchEvent(i.STOP_TOUCH_LEFT)),this.leftTouchId=null),null!=this.rightTouchId&&this.rightTouchId!=e.touchId||(this.isRightTouching&&(this.isRightTouching=!1,this.resetRight(),this.dispatchEvent(i.STOP_TOUCH_RIGHT)),this.rightTouchId=null)},i.prototype.sendLeftTouchEvent=function(){if(this.checkIsLeftTouchInside())if(this.leftTouchPointX>-this.leftButtonOffset&&this.leftTouchPointX<this.leftButtonOffset&&this.leftTouchPointY>-this.leftButtonOffset&&this.leftTouchPointY<this.leftButtonOffset)this.resetLeft();else{var t=Math.atan2(this.leftTouchPointY,this.leftTouchPointX)*(180/Math.PI);0>t&&(t+=360);var e=[];330<t||30>t?(this.changeBtnState(this.leftNode,"Normal"),this.changeBtnState(this.topNode,"Normal"),this.changeBtnState(this.rightNode,"Down"),this.changeBtnState(this.bottomNode,"Normal"),e.push(i.DIRECTION_RIGHT)):30<t&&60>t?(this.changeBtnState(this.leftNode,"Normal"),this.changeBtnState(this.topNode,"Normal"),this.changeBtnState(this.rightNode,"Down"),this.changeBtnState(this.bottomNode,"Down"),e.push(i.DIRECTION_BOTTOM,i.DIRECTION_RIGHT)):60<t&&120>t?(this.changeBtnState(this.leftNode,"Normal"),this.changeBtnState(this.topNode,"Normal"),this.changeBtnState(this.rightNode,"Normal"),this.changeBtnState(this.bottomNode,"Down"),e.push(i.DIRECTION_BOTTOM)):120<t&&150>t?(this.changeBtnState(this.leftNode,"Down"),this.changeBtnState(this.topNode,"Normal"),this.changeBtnState(this.rightNode,"Normal"),this.changeBtnState(this.bottomNode,"Down"),e.push(i.DIRECTION_BOTTOM,i.DIRECTION_LEFT)):150<t&&210>t?(this.changeBtnState(this.leftNode,"Down"),this.changeBtnState(this.topNode,"Normal"),this.changeBtnState(this.rightNode,"Normal"),this.changeBtnState(this.bottomNode,"Normal"),e.push(i.DIRECTION_LEFT)):210<t&&240>t?(this.changeBtnState(this.leftNode,"Down"),this.changeBtnState(this.topNode,"Down"),this.changeBtnState(this.rightNode,"Normal"),this.changeBtnState(this.bottomNode,"Normal"),e.push(i.DIRECTION_LEFT,i.DIRECTION_TOP)):240<t&&300>t?(this.changeBtnState(this.leftNode,"Normal"),this.changeBtnState(this.topNode,"Down"),this.changeBtnState(this.rightNode,"Normal"),this.changeBtnState(this.bottomNode,"Normal"),e.push(i.DIRECTION_TOP)):300<t&&330>t&&(this.changeBtnState(this.leftNode,"Normal"),this.changeBtnState(this.topNode,"Down"),this.changeBtnState(this.rightNode,"Down"),this.changeBtnState(this.bottomNode,"Normal"),e.push(i.DIRECTION_TOP,i.DIRECTION_RIGHT)),this.dispatchEvent(i.ON_TOUCH_LEFT,e)}},i.prototype.onRightTouchBegin=function(t,e){this.rightTouchId=e.touchId;var i=e.getLocalPoint();this.rightTouchPointX=i.x,this.rightTouchPointY=i.y,this.checkIsRightTouchInside()&&(this.isRightTouching=!0)},i.prototype.checkIsRightTouchInside=function(){return this.rightTouchPointX*this.scaleX>-this.rightButtonWidth&&this.rightTouchPointX*this.scaleX<this.rightButtonWidth&&this.rightTouchPointY*this.scaleY>-this.rightButtonWidth&&this.rightTouchPointY*this.scaleY<this.rightButtonWidth},i.prototype.onRightTouchMoved=function(t,e){var i=e.getLocalPoint();this.rightTouchPointX=i.x,this.rightTouchPointY=i.y},i.prototype.setBtnVisible=function(t,e){switch(t){case i.DIRECTION_LEFT:this.leftNode.visible=e;break;case i.DIRECTION_TOP:this.topNode.visible=e;break;case i.DIRECTION_RIGHT:this.rightNode.visible=e;break;case i.DIRECTION_BOTTOM:this.bottomNode.visible=e}},i.prototype.setButtonWidth=function(t){this.leftButtonWidth=t},i.prototype.setButtonHeight=function(t){this.leftButtonHeight=t},i.prototype.setButtonOffset=function(t){this.leftButtonOffset=t},i.prototype.setLeftImageNormalName=function(t){this.leftImageNormalName=t},i.prototype.setTopImageNormalName=function(t){this.topImageNormalName=t},i.prototype.setRightImageNormalName=function(t){this.rightImageNormalName=t},i.prototype.setBottomImageNormalName=function(t){this.bottomImageNormalName=t},i.prototype.setLeftImageDownName=function(t){this.leftImageDownName=t},i.prototype.setTopImageDownName=function(t){this.topImageDownName=t},i.prototype.setRightImageDownName=function(t){this.rightImageDownName=t},i.prototype.setBottomImageDownName=function(t){this.bottomImageDownName=t},i.prototype.setRightButtonImageNormalName=function(t){this.rightButtonImageNormalName=t},i.prototype.setRightButtonImageDownName=function(t){this.rightButtonImageDownName=t},i.DIRECTION_LEFT=1,i.DIRECTION_TOP=2,i.DIRECTION_RIGHT=3,i.DIRECTION_BOTTOM=4,i.ON_TOUCH_LEFT="VirtualJoystickClickLeft",i.ON_TOUCH_RIGHT="VirtualJoystickClickRight",i.STOP_TOUCH_LEFT="VirtualJoystickStopTouchLeft",i.STOP_TOUCH_RIGHT="VirtualJoystickStopTouchRight",i.instacce=null,i}(t.DisplayObjectContainer);t.VirtualJoystick=e}(ns_egret||(ns_egret={})),__extends=this.__extends||function(t,e){function i(){this.constructor=t}for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n]);i.prototype=e.prototype,t.prototype=new i},function(t){var e=function(e){function i(){e.call(this)}return __extends(i,e),i.prototype.onActivity=function(){e.prototype.onActivity.call(this),this.addEventListener(t.TouchEvent.TOUCH_TAP,this.onTouchTap,this)},i.prototype.onCancel=function(){e.prototype.onCancel.call(this),this.removeEventListener(t.TouchEvent.TOUCH_TAP,this.onTouchTap,this)},i.prototype.onTouchTap=function(){console.log("tap!!")},i}(t.ComponentBase);t.Button=e}(ns_egret||(ns_egret={})),__extends=this.__extends||function(t,e){function i(){this.constructor=t}for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n]);i.prototype=e.prototype,t.prototype=new i},function(t){var e=function(e){function i(i,n){void 0===n&&(n=""),e.call(this),""!=n&&(this._bg=t.Bitmap.initWithTexture(t.TextureCache.getInstance().getTexture(n)),this.addChild(this._bg));var s=t.TextureCache.getInstance().getTexture(i);this._barWidth=s.getTextureWidth(),this._bar=t.Bitmap.initWithTexture(s),this.addChild(this._bar),s={x:0,y:0,width:this._barWidth,height:s.getTextureHeight()},this._bar.mask=s}return __extends(i,e),Object.defineProperty(i.prototype,"percentage",{get:function(){return this._percentage},set:function(t){this._percentage=t,this.setProgress(this._percentage,100)},enumerable:!0,configurable:!0}),i.prototype.setOffset=function(t,e){this._bar.x=t,this._bar.y=e},i.prototype.setProgress=function(t,e){this._percentage=t/e*100,this._bar.mask.width=this._barWidth*t/e},i}(t.DisplayObjectContainer);t.ProgressBar=e}(ns_egret||(ns_egret={})),__extends=this.__extends||function(t,e){function i(){this.constructor=t}for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n]);i.prototype=e.prototype,t.prototype=new i},function(t){var e=function(e){function i(t){e.call(this),this.texture=t,this._right=this._left=this._bottom=this._top=this._defaultPadding=5,this._scaleHeight=this._scaleWidth=0}return __extends(i,e),i.prototype.setScaleGrid=function(e,i,n,s){void 0===e&&(e=this._defaultPadding),void 0===i&&(i=this._defaultPadding),void 0===n&&(n=this._defaultPadding),void 0===s&&(s=this._defaultPadding),t.DEBUG&&t.DEBUG.SCALE_BITMAP_SET_SCALE_GRID&&t.DEBUG.checkSetScaleGrid(this.texture,e,i,n,s),this._top=e,this._bottom=i,this._left=n,this._right=s},i.prototype.setContentSize=function(i,n){e.prototype.setContentSize.call(this,i,n),this.texture||t.Logger.fatal("Scale9Bitmap没有纹理"),0<parseInt(i)&&(this._scaleWidth=i),0<parseInt(n)&&(this._scaleHeight=n)},i.prototype.render=function(e){var i=(o=this.texture).getTextureWidth(),n=o.getTextureHeight(),s=this._scaleWidth,r=this._scaleHeight;(!o||0==s||0==r)&&t.Logger.fatal("ScaleBitmap需要设置ScaleSize");var o=n-this._top-this._bottom,a=i-this._left-this._right,r=r-this._top-this._bottom,h=s-this._left-this._right;this.drawImage(e,this.texture,0,0,this._left,this._top,0,0,this._left,this._top),e.translate(this._left,0),this.drawImage(e,this.texture,this._left,0,a,this._top,0,0,h,this._top),e.translate(h,0),this.drawImage(e,this.texture,i-this._right,0,this._right,this._top,0,0,this._right,this._top),e.translate(-(s-this._right),this._top),this.drawImage(e,this.texture,0,this._top,this._left,o,0,0,this._left,r),e.translate(this._left,0),this.drawImage(e,this.texture,this._left,this._top,a,o,0,0,h,r),e.translate(h,0),this.drawImage(e,this.texture,i-this._right,this._top,this._right,o,0,0,this._right,r),e.translate(-(s-this._right),r),this.drawImage(e,this.texture,0,n-this._bottom,this._left,this._bottom,0,0,this._left,this._bottom),e.translate(this._left,0),this.drawImage(e,this.texture,this._left,n-this._bottom,a,this._bottom,0,0,h,this._bottom),e.translate(h,0),this.drawImage(e,this.texture,i-this._right,n-this._bottom,this._right,this._bottom,0,0,this._right,this._bottom)},i.prototype.drawImage=function(t,e,i,n,s,r,o,a,h,u){0<s&&0<r&&t.drawImage(e,i,n,s,r,o,a,h,u)},i}(t.DisplayObject);t.Scale9Bitmap=e}(ns_egret||(ns_egret={})),__extends=this.__extends||function(t,e){function i(){this.constructor=t}for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n]);i.prototype=e.prototype,t.prototype=new i},function(t){var e=function(e){function i(){e.apply(this,arguments)}return __extends(i,e),i.create=function(t,e,n){void 0===e&&(e=null),void 0===n&&(n=null);var s=new i;return s.startLoad(t,e,n),s},i.prototype.startLoad=function(e,i,n){this._src=e,this._onLoadComplete=i,this._onLoadCompleteThisObj=n,this._resource=t.ResourceLoader.create(e,t.ResourceLoader.DATA_TYPE_IMAGE),this._resource.addEventListener(t.ResourceLoader.LOAD_COMPLETE,this.resourceLoadComplete,this),this._resource.load()},i.prototype.resourceLoadComplete=function(){this._resource.removeEventListener(t.ResourceLoader.LOAD_COMPLETE,this.resourceLoadComplete,this),this._resource=null,this.texture=t.TextureCache.getInstance().getTexture(this._src),this._onLoadComplete&&(this._onLoadComplete.call(this._onLoadCompleteThisObj),this._onLoadCompleteThisObj=this._onLoadComplete=null)},i.prototype._measureBounds=function(){return this.texture?e.prototype._measureBounds.call(this):t.Rectangle.identity.initialize(0,0,0,0)},i}(t.Bitmap);t.DynamicBitmap=e}(ns_egret||(ns_egret={}));var dragonBones,__extends=this.__extends||function(t,e){function i(){this.constructor=t}for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n]);i.prototype=e.prototype,t.prototype=new i};!function(t){!function(t){var e=function(){function t(t,e){void 0===t&&(t=0),void 0===e&&(e=0),this.x=t,this.y=e}return t.prototype.toString=function(){return"[Point (x="+this.x+" y="+this.y+")]"},t}();t.Point=e,e=function(t,e,i,n){void 0===t&&(t=0),void 0===e&&(e=0),void 0===i&&(i=0),void 0===n&&(n=0),this.x=t,this.y=e,this.width=i,this.height=n},t.Rectangle=e,e=function(){function t(){this.a=1,this.c=this.b=0,this.d=1,this.ty=this.tx=0}return t.prototype.invert=function(){var t=this.a,e=this.b,i=this.c,n=this.d,s=this.tx,r=t*n-e*i;this.a=n/r,this.b=-e/r,this.c=-i/r,this.d=t/r,this.tx=(i*this.ty-n*s)/r,this.ty=-(t*this.ty-e*s)/r},t}(),t.Matrix=e,e=function(){this.redOffset=this.redMultiplier=this.greenOffset=this.greenMultiplier=this.blueOffset=this.blueMultiplier=this.alphaOffset=this.alphaMultiplier=0},t.ColorTransform=e}(t.geom||(t.geom={}));var e=t.geom;!function(t){var e=function(t){this.type=t};t.Event=e;var i=function(t){function e(e){t.call(this,e)}return __extends(e,t),e.FADE_IN="fadeIn",e.FADE_OUT="fadeOut",e.START="start",e.COMPLETE="complete",e.LOOP_COMPLETE="loopComplete",e.FADE_IN_COMPLETE="fadeInComplete",e.FADE_OUT_COMPLETE="fadeOutComplete",e}(e);t.AnimationEvent=i,i=function(t){function e(e){t.call(this,e)}return __extends(e,t),e.Z_ORDER_UPDATED="zOrderUpdated",e}(e),t.ArmatureEvent=i,i=function(t){function e(e){t.call(this,e)}return __extends(e,t),e.ANIMATION_FRAME_EVENT="animationFrameEvent",e.BONE_FRAME_EVENT="boneFrameEvent",e}(e),t.FrameEvent=i,e=function(t){function e(e){t.call(this,e)}return __extends(e,t),e.SOUND="sound",e.BONE_FRAME_EVENT="boneFrameEvent",e}(e),t.SoundEvent=e,e=function(){function t(){}return t.prototype.hasEventListener=function(t){return!(!this._listenersMap||!this._listenersMap[t])},t.prototype.addEventListener=function(t,e){if(t&&e){this._listenersMap||(this._listenersMap={});var i=this._listenersMap[t];i&&this.removeEventListener(t,e),i?i.push(e):this._listenersMap[t]=[e]}},t.prototype.removeEventListener=function(t,e){if(this._listenersMap&&t&&e){var i=this._listenersMap[t];if(i)for(var n=i.length,s=0;s<n;s++)i[s]==e&&(1==n?(i.length=0,delete this._listenersMap[t]):i.splice(s,1))}},t.prototype.removeAllEventListeners=function(t){t?delete this._listenersMap[t]:this._listenersMap=null},t.prototype.dispatchEvent=function(t){if(t){if(i=this._listenersMap[t.type]){t.target=this;for(var e=i.concat(),i=i.length,n=0;n<i;n++)e[n](t)}}},t}(),t.EventDispatcher=e,e=function(t){function e(){if(t.call(this),e._instance)throw Error("Singleton already constructed!")}return __extends(e,t),e.getInstance=function(){return e._instance||(e._instance=new e),e._instance},e}(e),t.SoundEventManager=e}(t.events||(t.events={}));var i=t.events;!function(t){var n=function(){function t(){this.timeScale=1,this.time=.001*(new Date).getTime(),this._animatableList=[]}return t.prototype.contains=function(t){return 0<=this._animatableList.indexOf(t)},t.prototype.add=function(t){t&&-1==this._animatableList.indexOf(t)&&this._animatableList.push(t)},t.prototype.remove=function(t){0<=(t=this._animatableList.indexOf(t))&&(this._animatableList[t]=null)},t.prototype.clear=function(){this._animatableList.length=0},t.prototype.advanceTime=function(t){if(0>t){var e=.001*(new Date).getTime();t=e-this.time,this.time=e}if(t*=this.timeScale,0!=(e=this._animatableList.length)){for(var i=0,n=0;n<e;n++){var s=this._animatableList[n];s&&(i!=n&&(this._animatableList[i]=s,this._animatableList[n]=null),s.advanceTime(t),i++)}if(i!=n){for(e=this._animatableList.length;n<e;)this._animatableList[i++]=this._animatableList[n++];this._animatableList.length=i}}},t.clock=new t,t}();t.WorldClock=n;var o=function(){function t(){this.transform=new s.DBTransform,this.pivot=new e.Point,this._durationTransform=new s.DBTransform,this._durationPivot=new e.Point,this._durationColor=new e.ColorTransform}return t._borrowObject=function(){return 0==t._pool.length?new t:t._pool.pop()},t._returnObject=function(e){0>t._pool.indexOf(e)&&(t._pool[t._pool.length]=e),e.clear()},t._clear=function(){for(var e=t._pool.length;e--;)t._pool[e].clear();t._pool.length=0},t.getEaseValue=function(e,i){if(1<i){var n=.5*(1-Math.cos(e*Math.PI))-e;i-=1}else 0<i?n=Math.sin(e*t.HALF_PI)-e:0>i&&(n=1-Math.cos(e*t.HALF_PI)-e,i*=-1);return n*i+e},t.prototype.fadeIn=function(t,e,i){switch(this._bone=t,this._animationState=e,this._timeline=i,this._originTransform=this._timeline.originTransform,this._originPivot=this._timeline.originPivot,this._tweenColor=this._tweenTransform=!1,this._totalTime=this._animationState.totalTime,this.transform.x=0,this.transform.y=0,this.transform.scaleX=0,this.transform.scaleY=0,this.transform.skewX=0,this.transform.skewY=0,this.pivot.x=0,this.pivot.y=0,this._durationTransform.x=0,this._durationTransform.y=0,this._durationTransform.scaleX=0,this._durationTransform.scaleY=0,this._durationTransform.skewX=0,this._durationTransform.skewY=0,this._durationPivot.x=0,this._durationPivot.y=0,this._currentFrame=null,this._timeline.getFrameList().length){case 0:this._bone._arriveAtFrame(null,this,this._animationState,!1),this._updateState=0;break;case 1:this._updateState=-1;break;default:this._updateState=1}},t.prototype.fadeOut=function(){this.transform.skewX=r.TransformUtil.formatRadian(this.transform.skewX),this.transform.skewY=r.TransformUtil.formatRadian(this.transform.skewY)},t.prototype.update=function(e){if(this._updateState)if(0<this._updateState){1==(e=0==this._timeline.scale?1:e/this._timeline.scale)&&(e=.99999999),e+=this._timeline.offset;var i=Math.floor(e);e-=i;for(var n,s=this._totalTime*e,o=!1;!this._currentFrame||s>this._currentFramePosition+this._currentFrameDuration||s<this._currentFramePosition;)o&&this._bone._arriveAtFrame(this._currentFrame,this,this._animationState,!0),o=!0,this._currentFrame?((n=this._timeline.getFrameList().indexOf(this._currentFrame)+1)>=this._timeline.getFrameList().length&&(n=0),this._currentFrame=this._timeline.getFrameList()[n]):(n=0,this._currentFrame=this._timeline.getFrameList()[0]),this._currentFrameDuration=this._currentFrame.duration,this._currentFramePosition=this._currentFrame.position;o&&(this.tweenActive=0<=this._currentFrame.displayIndex,++n>=this._timeline.getFrameList().length&&(n=0),o=this._timeline.getFrameList()[n],0==n&&this._animationState.loop&&this._animationState.loopCount>=Math.abs(this._animationState.loop)-1&&.99999999<((this._currentFramePosition+this._currentFrameDuration)/this._totalTime+i-this._timeline.offset)*this._timeline.scale?(this._updateState=0,this._tweenEasing=NaN):0>this._currentFrame.displayIndex||0>o.displayIndex||!this._animationState.tweenEnabled?this._tweenEasing=NaN:isNaN(this._animationState.clip.tweenEasing)?this._tweenEasing=this._currentFrame.tweenEasing:this._tweenEasing=this._animationState.clip.tweenEasing,isNaN(this._tweenEasing)?this._tweenColor=this._tweenTransform=!1:(this._durationTransform.x=o.transform.x-this._currentFrame.transform.x,this._durationTransform.y=o.transform.y-this._currentFrame.transform.y,this._durationTransform.skewX=o.transform.skewX-this._currentFrame.transform.skewX,this._durationTransform.skewY=o.transform.skewY-this._currentFrame.transform.skewY,this._durationTransform.scaleX=o.transform.scaleX-this._currentFrame.transform.scaleX,this._durationTransform.scaleY=o.transform.scaleY-this._currentFrame.transform.scaleY,0==n&&(this._durationTransform.skewX=r.TransformUtil.formatRadian(this._durationTransform.skewX),this._durationTransform.skewY=r.TransformUtil.formatRadian(this._durationTransform.skewY)),this._durationPivot.x=o.pivot.x-this._currentFrame.pivot.x,this._durationPivot.y=o.pivot.y-this._currentFrame.pivot.y,this._tweenTransform=0!=this._durationTransform.x||0!=this._durationTransform.y||0!=this._durationTransform.skewX||0!=this._durationTransform.skewY||0!=this._durationTransform.scaleX||0!=this._durationTransform.scaleY||0!=this._durationPivot.x||0!=this._durationPivot.y,this._currentFrame.color&&o.color?(this._durationColor.alphaOffset=o.color.alphaOffset-this._currentFrame.color.alphaOffset,this._durationColor.redOffset=o.color.redOffset-this._currentFrame.color.redOffset,this._durationColor.greenOffset=o.color.greenOffset-this._currentFrame.color.greenOffset,this._durationColor.blueOffset=o.color.blueOffset-this._currentFrame.color.blueOffset,this._durationColor.alphaMultiplier=o.color.alphaMultiplier-this._currentFrame.color.alphaMultiplier,this._durationColor.redMultiplier=o.color.redMultiplier-this._currentFrame.color.redMultiplier,this._durationColor.greenMultiplier=o.color.greenMultiplier-this._currentFrame.color.greenMultiplier,this._durationColor.blueMultiplier=o.color.blueMultiplier-this._currentFrame.color.blueMultiplier,this._tweenColor=0!=this._durationColor.alphaOffset||0!=this._durationColor.redOffset||0!=this._durationColor.greenOffset||0!=this._durationColor.blueOffset||0!=this._durationColor.alphaMultiplier||0!=this._durationColor.redMultiplier||0!=this._durationColor.greenMultiplier||0!=this._durationColor.blueMultiplier):this._currentFrame.color?(this._tweenColor=!0,this._durationColor.alphaOffset=-this._currentFrame.color.alphaOffset,this._durationColor.redOffset=-this._currentFrame.color.redOffset,this._durationColor.greenOffset=-this._currentFrame.color.greenOffset,this._durationColor.blueOffset=-this._currentFrame.color.blueOffset,this._durationColor.alphaMultiplier=1-this._currentFrame.color.alphaMultiplier,this._durationColor.redMultiplier=1-this._currentFrame.color.redMultiplier,this._durationColor.greenMultiplier=1-this._currentFrame.color.greenMultiplier,this._durationColor.blueMultiplier=1-this._currentFrame.color.blueMultiplier):o.color?(this._tweenColor=!0,this._durationColor.alphaOffset=o.color.alphaOffset,this._durationColor.redOffset=o.color.redOffset,this._durationColor.greenOffset=o.color.greenOffset,this._durationColor.blueOffset=o.color.blueOffset,this._durationColor.alphaMultiplier=o.color.alphaMultiplier-1,this._durationColor.redMultiplier=o.color.redMultiplier-1,this._durationColor.greenMultiplier=o.color.greenMultiplier-1,this._durationColor.blueMultiplier=o.color.blueMultiplier-1):this._tweenColor=!1),this._tweenTransform||(this._animationState.blend?(this.transform.x=this._originTransform.x+this._currentFrame.transform.x,this.transform.y=this._originTransform.y+this._currentFrame.transform.y,this.transform.skewX=this._originTransform.skewX+this._currentFrame.transform.skewX,this.transform.skewY=this._originTransform.skewY+this._currentFrame.transform.skewY,this.transform.scaleX=this._originTransform.scaleX+this._currentFrame.transform.scaleX,this.transform.scaleY=this._originTransform.scaleY+this._currentFrame.transform.scaleY,this.pivot.x=this._originPivot.x+this._currentFrame.pivot.x,this.pivot.y=this._originPivot.y+this._currentFrame.pivot.y):(this.transform.x=this._currentFrame.transform.x,this.transform.y=this._currentFrame.transform.y,this.transform.skewX=this._currentFrame.transform.skewX,this.transform.skewY=this._currentFrame.transform.skewY,this.transform.scaleX=this._currentFrame.transform.scaleX,this.transform.scaleY=this._currentFrame.transform.scaleY,this.pivot.x=this._currentFrame.pivot.x,this.pivot.y=this._currentFrame.pivot.y)),this._tweenColor||(this._currentFrame.color?this._bone._updateColor(this._currentFrame.color.alphaOffset,this._currentFrame.color.redOffset,this._currentFrame.color.greenOffset,this._currentFrame.color.blueOffset,this._currentFrame.color.alphaMultiplier,this._currentFrame.color.redMultiplier,this._currentFrame.color.greenMultiplier,this._currentFrame.color.blueMultiplier,!0):this._bone._isColorChanged&&this._bone._updateColor(0,0,0,0,1,1,1,1,!1)),this._bone._arriveAtFrame(this._currentFrame,this,this._animationState,!1)),(this._tweenTransform||this._tweenColor)&&(e=(s-this._currentFramePosition)/this._currentFrameDuration,this._tweenEasing&&(e=t.getEaseValue(e,this._tweenEasing))),this._tweenTransform&&(i=this._currentFrame.transform,s=this._currentFrame.pivot,this._animationState.blend?(this.transform.x=this._originTransform.x+i.x+this._durationTransform.x*e,this.transform.y=this._originTransform.y+i.y+this._durationTransform.y*e,this.transform.skewX=this._originTransform.skewX+i.skewX+this._durationTransform.skewX*e,this.transform.skewY=this._originTransform.skewY+i.skewY+this._durationTransform.skewY*e,this.transform.scaleX=this._originTransform.scaleX+i.scaleX+this._durationTransform.scaleX*e,this.transform.scaleY=this._originTransform.scaleY+i.scaleY+this._durationTransform.scaleY*e,this.pivot.x=this._originPivot.x+s.x+this._durationPivot.x*e,this.pivot.y=this._originPivot.y+s.y+this._durationPivot.y*e):(this.transform.x=i.x+this._durationTransform.x*e,this.transform.y=i.y+this._durationTransform.y*e,this.transform.skewX=i.skewX+this._durationTransform.skewX*e,this.transform.skewY=i.skewY+this._durationTransform.skewY*e,this.transform.scaleX=i.scaleX+this._durationTransform.scaleX*e,this.transform.scaleY=i.scaleY+this._durationTransform.scaleY*e,this.pivot.x=s.x+this._durationPivot.x*e,this.pivot.y=s.y+this._durationPivot.y*e)),this._tweenColor&&(this._currentFrame.color?this._bone._updateColor(this._currentFrame.color.alphaOffset+this._durationColor.alphaOffset*e,this._currentFrame.color.redOffset+this._durationColor.redOffset*e,this._currentFrame.color.greenOffset+this._durationColor.greenOffset*e,this._currentFrame.color.blueOffset+this._durationColor.blueOffset*e,this._currentFrame.color.alphaMultiplier+this._durationColor.alphaMultiplier*e,this._currentFrame.color.redMultiplier+this._durationColor.redMultiplier*e,this._currentFrame.color.greenMultiplier+this._durationColor.greenMultiplier*e,this._currentFrame.color.blueMultiplier+this._durationColor.blueMultiplier*e,!0):this._bone._updateColor(this._durationColor.alphaOffset*e,this._durationColor.redOffset*e,this._durationColor.greenOffset*e,this._durationColor.blueOffset*e,1+this._durationColor.alphaMultiplier*e,1+this._durationColor.redMultiplier*e,1+this._durationColor.greenMultiplier*e,1+this._durationColor.blueMultiplier*e,!0))}else this._updateState=0,this._animationState.blend?(this.transform.copy(this._originTransform),this.pivot.x=this._originPivot.x,this.pivot.y=this._originPivot.y):(this.transform.x=this.transform.y=this.transform.skewX=this.transform.skewY=this.transform.scaleX=this.transform.scaleY=0,this.pivot.x=0,this.pivot.y=0),this._currentFrame=this._timeline.getFrameList()[0],this.tweenActive=0<=this._currentFrame.displayIndex,this._currentFrame.color?this._bone._updateColor(this._currentFrame.color.alphaOffset,this._currentFrame.color.redOffset,this._currentFrame.color.greenOffset,this._currentFrame.color.blueOffset,this._currentFrame.color.alphaMultiplier,this._currentFrame.color.redMultiplier,this._currentFrame.color.greenMultiplier,this._currentFrame.color.blueMultiplier,!0):this._bone._updateColor(0,0,0,0,1,1,1,1,!1),this._bone._arriveAtFrame(this._currentFrame,this,this._animationState,!1)},t.prototype.clear=function(){this._updateState=0,this._originPivot=this._originTransform=this._currentFrame=this._timeline=this._animationState=this._bone=null},t.HALF_PI=.5*Math.PI,t._pool=[],t}();t.TimelineState=o;var a=function(){function t(){this.layer=this.loop=0,this._timelineStates={}}return t._borrowObject=function(){return 0==t._pool.length?new t:t._pool.pop()},t._returnObject=function(e){0>t._pool.indexOf(e)&&(t._pool[t._pool.length]=e),e.clear()},t._clear=function(){for(var e=t._pool.length;e--;)t._pool[e].clear();t._pool.length=0},t.prototype.fadeIn=function(t,e,i,n,s,r,o,a){this.layer=r,this.clip=e,this.name=this.clip.name,this.totalTime=this.clip.duration,this._armature=t,2>Math.round(this.clip.duration*this.clip.frameRate)||1/0==n?(this.timeScale=1,this.currentTime=this.totalTime,this.loop=0<=this.loop?1:-1):(this.timeScale=n,this.currentTime=0,this.loop=s),this._pauseBeforeFadeInComplete=a,this._fadeInTime=i*this.timeScale,this._fadeState=1,this._fadeOutBeginTime=0,this._fadeOutWeight=-1,this._fadeWeight=0,this._fadeIn=!0,this._fadeOut=!1,this.loopCount=-1,this.displayControl=o,this.isPlaying=!0,this.isComplete=!1,this.weight=1,this.tweenEnabled=this.enabled=this.blend=!0,this.updateTimelineStates()},t.prototype.fadeOut=function(t,e){if(void 0===e&&(e=!1),this._armature&&!(0<=this._fadeOutWeight)){this._fadeState=-1,this._fadeOutWeight=this._fadeWeight,this._fadeOutTime=t*this.timeScale,this._fadeOutBeginTime=this.currentTime,this._fadeOut=!0,this.isPlaying=!e,this.displayControl=!1;for(var i in this._timelineStates)this._timelineStates[i].fadeOut();this.enabled=!0}},t.prototype.play=function(){this.isPlaying=!0},t.prototype.stop=function(){this.isPlaying=!1},t.prototype.getMixingTransform=function(t){return this._mixingTransforms?Number(this._mixingTransforms[t]):-1},t.prototype.addMixingTransform=function(t,e,i){if(void 0===e&&(e=2),void 0===i&&(i=!0),!this.clip||!this.clip.getTimeline(t))throw Error();if(this._mixingTransforms||(this._mixingTransforms={}),i){i=this._armature._boneList.length;for(var n,s;i--;)(n=this._armature._boneList[i]).name==t&&(s=n),s&&(s==n||s.contains(n))&&(this._mixingTransforms[n.name]=e)}else this._mixingTransforms[t]=e;this.updateTimelineStates()},t.prototype.removeMixingTransform=function(t,e){if(void 0===t&&(t=null),void 0===e&&(e=!0),t){if(e)for(var i,n,s=this._armature._boneList.length;s--;)(i=this._armature._boneList[s]).name==t&&(n=i),n&&(n==i||n.contains(i))&&delete this._mixingTransforms[i.name];else delete this._mixingTransforms[t];for(var r in this._mixingTransforms){var o=!0;break}o||(this._mixingTransforms=null)}else this._mixingTransforms=null;this.updateTimelineStates()},t.prototype.advanceTime=function(t){if(!this.enabled)return!1;var e,n;if(this._fadeIn&&(this._fadeIn=!1,this._armature.hasEventListener(i.AnimationEvent.FADE_IN)&&(e=new i.AnimationEvent(i.AnimationEvent.FADE_IN),e.animationState=this,this._armature._eventList.push(e))),this._fadeOut&&(this._fadeOut=!1,this._armature.hasEventListener(i.AnimationEvent.FADE_OUT)&&(e=new i.AnimationEvent(i.AnimationEvent.FADE_OUT),e.animationState=this,this._armature._eventList.push(e))),this.currentTime+=t*this.timeScale,this.isPlaying&&!this.isComplete){var s;this._pauseBeforeFadeInComplete?(this.isPlaying=this._pauseBeforeFadeInComplete=!1,t=0,s=Math.floor(t)):(t=this.currentTime/this.totalTime,(s=Math.floor(t))!=this.loopCount&&(-1==this.loopCount&&this._armature.hasEventListener(i.AnimationEvent.START)&&(e=new i.AnimationEvent(i.AnimationEvent.START),e.animationState=this,this._armature._eventList.push(e)),this.loopCount=s)&&(this.loop&&this.loopCount*this.loopCount>=this.loop*this.loop-1?(n=!0,t=1,s=0,this._armature.hasEventListener(i.AnimationEvent.COMPLETE)&&(e=new i.AnimationEvent(i.AnimationEvent.COMPLETE),e.animationState=this,this._armature._eventList.push(e))):this._armature.hasEventListener(i.AnimationEvent.LOOP_COMPLETE)&&(e=new i.AnimationEvent(i.AnimationEvent.LOOP_COMPLETE),e.animationState=this,this._armature._eventList.push(e))));for(var r in this._timelineStates)this._timelineStates[r].update(t);if(0<(e=this.clip.getFrameList()).length){for(t=this.totalTime*(t-s),s=!1;!this._currentFrame||t>this._currentFrame.position+this._currentFrame.duration||t<this._currentFrame.position;)s&&this._armature._arriveAtFrame(this._currentFrame,null,this,!0),s=!0,this._currentFrame?(r=e.indexOf(this._currentFrame),++r>=e.length&&(r=0),this._currentFrame=e[r]):this._currentFrame=e[0];s&&this._armature._arriveAtFrame(this._currentFrame,null,this,!1)}}if(0<this._fadeState)0==this._fadeInTime?(this._fadeWeight=1,this._fadeState=0,this.isPlaying=!0,this._armature.hasEventListener(i.AnimationEvent.FADE_IN_COMPLETE)&&(e=new i.AnimationEvent(i.AnimationEvent.FADE_IN_COMPLETE),e.animationState=this,this._armature._eventList.push(e))):(this._fadeWeight=this.currentTime/this._fadeInTime,1<=this._fadeWeight&&(this._fadeWeight=1,this._fadeState=0,this.isPlaying||(this.currentTime-=this._fadeInTime),this.isPlaying=!0,this._armature.hasEventListener(i.AnimationEvent.FADE_IN_COMPLETE)&&(e=new i.AnimationEvent(i.AnimationEvent.FADE_IN_COMPLETE),e.animationState=this,this._armature._eventList.push(e))));else if(0>this._fadeState){if(0==this._fadeOutTime)return this._fadeState=this._fadeWeight=0,this._armature.hasEventListener(i.AnimationEvent.FADE_OUT_COMPLETE)&&(e=new i.AnimationEvent(i.AnimationEvent.FADE_OUT_COMPLETE),e.animationState=this,this._armature._eventList.push(e)),!0;if(this._fadeWeight=(1-(this.currentTime-this._fadeOutBeginTime)/this._fadeOutTime)*this._fadeOutWeight,0>=this._fadeWeight)return this._fadeState=this._fadeWeight=0,this._armature.hasEventListener(i.AnimationEvent.FADE_OUT_COMPLETE)&&(e=new i.AnimationEvent(i.AnimationEvent.FADE_OUT_COMPLETE),e.animationState=this,this._armature._eventList.push(e)),!0}return n&&(this.isComplete=!0,0>this.loop&&this.fadeOut((this._fadeOutWeight||this._fadeInTime)/this.timeScale,!0)),!1},t.prototype.updateTimelineStates=function(){if(this._mixingTransforms){for(var t in this._timelineStates)null==this._mixingTransforms[t]&&this.removeTimelineState(t);for(t in this._mixingTransforms)this._timelineStates[t]||this.addTimelineState(t)}else for(t in this.clip.getTimelines())this._timelineStates[t]||this.addTimelineState(t)},t.prototype.addTimelineState=function(t){var e=this._armature.getBone(t);if(e){var i=o._borrowObject(),n=this.clip.getTimeline(t);i.fadeIn(e,this,n),this._timelineStates[t]=i}},t.prototype.removeTimelineState=function(t){o._returnObject(this._timelineStates[t]),delete this._timelineStates[t]},t.prototype.clear=function(){this.clip=null,this.enabled=!1,this._mixingTransforms=this._currentFrame=this._armature=null;for(var t in this._timelineStates)this.removeTimelineState(t)},t._pool=[],t}();t.AnimationState=a,n=function(){function t(t){this._armature=t,this._animationLayer=[],this._isPlaying=!1,this.animationNameList=[],this.tweenEnabled=!0,this.timeScale=1}return t.prototype.getLastAnimationName=function(){return this._lastAnimationState?this._lastAnimationState.name:null},t.prototype.getLastAnimationState=function(){return this._lastAnimationState},t.prototype.getAnimationDataList=function(){return this._animationDataList},t.prototype.setAnimationDataList=function(t){this._animationDataList=t,this.animationNameList.length=0;for(var e in this._animationDataList)this.animationNameList[this.animationNameList.length]=this._animationDataList[e].name},t.prototype.getIsPlaying=function(){return this._isPlaying&&!this.getIsComplete()},t.prototype.getIsComplete=function(){if(this._lastAnimationState){if(!this._lastAnimationState.isComplete)return!1;for(var t=this._animationLayer.length;t--;)for(var e=this._animationLayer[t],i=e.length;i--;)if(!e[i].isComplete)return!1;return!0}return!1},t.prototype.dispose=function(){if(this._armature){this.stop();for(var t=this._animationLayer.length;t--;){for(var e=this._animationLayer[t],i=e.length;i--;)a._returnObject(e[i]);e.length=0}this._animationLayer.length=0,this.animationNameList.length=0,this.animationNameList=this._animationDataList=this._animationLayer=this._armature=null}},t.prototype.gotoAndPlay=function(e,i,n,s,r,o,h,u,c,l){if(void 0===i&&(i=-1),void 0===n&&(n=-1),void 0===s&&(s=NaN),void 0===r&&(r=0),void 0===o&&(o=null),void 0===h&&(h=t.SAME_LAYER_AND_GROUP),void 0===u&&(u=!0),void 0===c&&(c=!0),void 0===l&&(l=!0),!this._animationDataList)return null;for(var d,p=this._animationDataList.length;p--;)if(this._animationDataList[p].name==e){d=this._animationDataList[p];break}if(!d)return null;this._isPlaying=!0,i=0>i?0>d.fadeInTime?.3:d.fadeInTime:i,n=0>n?0>d.scale?1:d.scale:n/d.duration,s=isNaN(s)?d.loop:s,r=this.addLayer(r);var _;switch(h){case t.NONE:break;case t.SAME_LAYER:for(p=(_=this._animationLayer[r]).length;p--;)(h=_[p]).fadeOut(i,c);break;case t.SAME_GROUP:for(g=this._animationLayer.length;g--;)for(p=(_=this._animationLayer[g]).length;p--;)(h=_[p]).group==o&&h.fadeOut(i,c);break;case t.ALL:for(var g=this._animationLayer.length;g--;)for(p=(_=this._animationLayer[g]).length;p--;)(h=_[p]).fadeOut(i,c);break;default:for(p=(_=this._animationLayer[r]).length;p--;)(h=_[p]).group==o&&h.fadeOut(i,c)}for(this._lastAnimationState=a._borrowObject(),this._lastAnimationState.group=o,this._lastAnimationState.tweenEnabled=this.tweenEnabled,this._lastAnimationState.fadeIn(this._armature,d,i,1/n,s,r,u,l),this.addState(this._lastAnimationState),p=(s=this._armature._slotList).length;p--;)r=s[p],(r=r.getChildArmature())&&r.animation.gotoAndPlay(e,i);return this._lastAnimationState},t.prototype.play=function(){this._animationDataList&&0!=this._animationDataList.length&&(this._lastAnimationState?this._isPlaying?this.gotoAndPlay(this._lastAnimationState.name):this._isPlaying=!0:this.gotoAndPlay(this._animationDataList[0].name))},t.prototype.stop=function(){this._isPlaying=!1},t.prototype.getState=function(t,e){void 0===e&&(e=0);var i=this._animationLayer.length;if(0==i)return null;if(e>=i&&(e=i-1),!(i=this._animationLayer[e]))return null;for(var n=i.length;n--;)if(i[n].name==t)return i[n];return null},t.prototype.hasAnimation=function(t){for(var e=this._animationDataList.length;e--;)if(this._animationDataList[e].name==t)return!0;return!1},t.prototype.advanceTime=function(t){if(this._isPlaying){t*=this.timeScale;var e,i,n,s,r,o,a,h,u,c,l,d,p,_,g,f,m,y,v,T=this._armature._boneList.length,x=T;for(T--;x--;){for(r=(s=this._armature._boneList[x]).name,o=1,_=p=d=l=c=u=h=a=0,e=this._animationLayer.length;e--;){for(g=0,n=(f=this._animationLayer[e]).length,i=0;i<n;i++)m=f[i],x==T&&m.advanceTime(t)?(this.removeState(m),i--,n--):(y=m._timelineStates[r])&&y.tweenActive&&(m=m._fadeWeight*m.weight*o,v=y.transform,y=y.pivot,a+=v.x*m,h+=v.y*m,u+=v.skewX*m,c+=v.skewY*m,l+=v.scaleX*m,d+=v.scaleY*m,p+=y.x*m,_+=y.y*m,g+=m);if(g>=o)break;o-=g}v=s.tween,y=s._tweenPivot,v.x=a,v.y=h,v.skewX=u,v.skewY=c,v.scaleX=l,v.scaleY=d,y.x=p,y.y=_}}},t.prototype.addLayer=function(t){return t>=this._animationLayer.length&&(t=this._animationLayer.length,this._animationLayer[t]=[]),t},t.prototype.addState=function(t){this._animationLayer[t.layer].push(t)},t.prototype.removeState=function(t){var e=t.layer,i=this._animationLayer[e];i.splice(i.indexOf(t),1),a._returnObject(t),0==i.length&&e==this._animationLayer.length-1&&this._animationLayer.length--},t.NONE="none",t.SAME_LAYER="sameLayer",t.SAME_GROUP="sameGroup",t.SAME_LAYER_AND_GROUP="sameLayerAndGroup",t.ALL="all",t}(),t.Animation=n}(t.animation||(t.animation={}));var n=t.animation;!function(t){var i=function(){function t(){this.skewY=this.skewX=this.y=this.x=0,this.scaleY=this.scaleX=1}return t.prototype.getRotation=function(){return this.skewX},t.prototype.setRotation=function(t){this.skewX=this.skewY=t},t.prototype.copy=function(t){this.x=t.x,this.y=t.y,this.skewX=t.skewX,this.skewY=t.skewY,this.scaleX=t.scaleX,this.scaleY=t.scaleY},t.prototype.toString=function(){return"[DBTransform (x="+this.x+" y="+this.y+" skewX="+this.skewX+" skewY="+this.skewY+" scaleX="+this.scaleX+" scaleY="+this.scaleY+")]"},t}();t.DBTransform=i;var n=function(){function t(){this.duration=this.position=0}return t.prototype.dispose=function(){},t}();t.Frame=n;var s=function(t){function n(){t.call(this),this.displayIndex=this.tweenRotate=this.tweenEasing=0,this.zOrder=NaN,this.visible=!0,this.global=new i,this.transform=new i,this.pivot=new e.Point}return __extends(n,t),n.prototype.dispose=function(){t.prototype.dispose.call(this),this.color=this.pivot=this.transform=this.global=null},n}(n);t.TransformFrame=s;var o=function(){function t(){this._frameList=[],this.duration=0,this.scale=1}return t.prototype.getFrameList=function(){return this._frameList},t.prototype.dispose=function(){for(var t=this._frameList.length;t--;)this._frameList[t].dispose();this._frameList.length=0,this._frameList=null},t.prototype.addFrame=function(t){if(!t)throw Error();if(!(0>this._frameList.indexOf(t)))throw Error();this._frameList[this._frameList.length]=t},t}();t.Timeline=o;var a=function(t){function n(){t.call(this),this.originTransform=new i,this.originPivot=new e.Point,this.offset=0,this.transformed=!1}return __extends(n,t),n.prototype.dispose=function(){this!=n.HIDE_TIMELINE&&(t.prototype.dispose.call(this),this.originPivot=this.originTransform=null)},n.HIDE_TIMELINE=new n,n}(o);t.TransformTimeline=a;var h=function(t){function e(){t.call(this),this.loop=this.frameRate=0,this.tweenEasing=NaN,this.fadeInTime=0,this._timelines={}}return __extends(e,t),e.prototype.getTimelines=function(){return this._timelines},e.prototype.dispose=function(){t.prototype.dispose.call(this);for(var e in this._timelines)this._timelines[e].dispose();this._timelines=null},e.prototype.getTimeline=function(t){return this._timelines[t]},e.prototype.addTimeline=function(t,e){if(!t)throw Error();this._timelines[e]=t},e}(o);t.AnimationData=h;var u=function(){function t(){this.transform=new i}return t.prototype.dispose=function(){this.pivot=this.transform=null},t.ARMATURE="armature",t.IMAGE="image",t}();t.DisplayData=u;var c=function(){function t(){this._displayDataList=[],this.zOrder=0,this.blendMode="normal"}return t.prototype.getDisplayDataList=function(){return this._displayDataList},t.prototype.dispose=function(){for(var t=this._displayDataList.length;t--;)this._displayDataList[t].dispose();this._displayDataList.length=0,this._displayDataList=null},t.prototype.addDisplayData=function(t){if(!t)throw Error();if(!(0>this._displayDataList.indexOf(t)))throw Error();this._displayDataList[this._displayDataList.length]=t},t.prototype.getDisplayData=function(t){for(var e=this._displayDataList.length;e--;)if(this._displayDataList[e].name==t)return this._displayDataList[e];return null},t}();t.SlotData=c;var l=function(){function t(){this.length=0,this.global=new i,this.transform=new i,this.scaleMode=1,this.fixedRotation=!1}return t.prototype.dispose=function(){this.transform=this.global=null},t}();t.BoneData=l;var d=function(){function t(){this._slotDataList=[]}return t.prototype.getSlotDataList=function(){return this._slotDataList},t.prototype.dispose=function(){for(var t=this._slotDataList.length;t--;)this._slotDataList[t].dispose();this._slotDataList.length=0,this._slotDataList=null},t.prototype.getSlotData=function(t){for(var e=this._slotDataList.length;e--;)if(this._slotDataList[e].name==t)return this._slotDataList[e];return null},t.prototype.addSlotData=function(t){if(!t)throw Error();if(!(0>this._slotDataList.indexOf(t)))throw Error();this._slotDataList[this._slotDataList.length]=t},t}();t.SkinData=d;var p=function(){function t(){this._boneDataList=[],this._skinDataList=[],this._animationDataList=[]}return t.prototype.getBoneDataList=function(){return this._boneDataList},t.prototype.getSkinDataList=function(){return this._skinDataList},t.prototype.getAnimationDataList=function(){return this._animationDataList},t.prototype.dispose=function(){for(var t=this._boneDataList.length;t--;)this._boneDataList[t].dispose();for(t=this._skinDataList.length;t--;)this._skinDataList[t].dispose();for(t=this._animationDataList.length;t--;)this._animationDataList[t].dispose();this._boneDataList.length=0,this._skinDataList.length=0,this._animationDataList.length=0,this._animationDataList=this._skinDataList=this._boneDataList=null},t.prototype.getBoneData=function(t){for(var e=this._boneDataList.length;e--;)if(this._boneDataList[e].name==t)return this._boneDataList[e];return null},t.prototype.getSkinData=function(t){if(!t)return this._skinDataList[0];for(var e=this._skinDataList.length;e--;)if(this._skinDataList[e].name==t)return this._skinDataList[e];return null},t.prototype.getAnimationData=function(t){for(var e=this._animationDataList.length;e--;)if(this._animationDataList[e].name==t)return this._animationDataList[e];return null},t.prototype.addBoneData=function(t){if(!t)throw Error();if(!(0>this._boneDataList.indexOf(t)))throw Error();this._boneDataList[this._boneDataList.length]=t},t.prototype.addSkinData=function(t){if(!t)throw Error();if(!(0>this._skinDataList.indexOf(t)))throw Error();this._skinDataList[this._skinDataList.length]=t},t.prototype.addAnimationData=function(t){if(!t)throw Error();0>this._animationDataList.indexOf(t)&&(this._animationDataList[this._animationDataList.length]=t)},t.prototype.sortBoneDataList=function(){var t=this._boneDataList.length;if(0!=t){for(var e=[];t--;){for(var i=this._boneDataList[t],n=0,s=i;s&&s.parent;)n++,s=this.getBoneData(s.parent);e[t]={level:n,boneData:i}}for(e.sort(this.sortBoneData),t=e.length;t--;)this._boneDataList[t]=e[t].boneData}},t.prototype.sortBoneData=function(t,e){return t.level>e.level?1:-1},t}();t.ArmatureData=p;var _=function(){function t(){this._armatureDataList=[],this._subTexturePivots={}}return t.prototype.getArmatureNames=function(){var t,e=[];for(t in this._armatureDataList)e[e.length]=this._armatureDataList[t].name;return e},t.prototype.getArmatureDataList=function(){return this._armatureDataList},t.prototype.dispose=function(){for(var t in this._armatureDataList)this._armatureDataList[t].dispose();this._armatureDataList.length=0,this._subTexturePivots=this._armatureDataList=null},t.prototype.getArmatureData=function(t){for(var e=this._armatureDataList.length;e--;)if(this._armatureDataList[e].name==t)return this._armatureDataList[e];return null},t.prototype.addArmatureData=function(t){if(!t)throw Error();if(!(0>this._armatureDataList.indexOf(t)))throw Error();this._armatureDataList[this._armatureDataList.length]=t},t.prototype.removeArmatureData=function(t){0<=(t=this._armatureDataList.indexOf(t))&&this._armatureDataList.splice(t,1)},t.prototype.removeArmatureDataByName=function(t){for(var e=this._armatureDataList.length;e--;)this._armatureDataList[e].name==t&&this._armatureDataList.splice(e,1)},t.prototype.getSubTexturePivot=function(t){return this._subTexturePivots[t]},t.prototype.addSubTexturePivot=function(t,i,n){var s=this._subTexturePivots[n];return s?(s.x=t,s.y=i):this._subTexturePivots[n]=s=new e.Point(t,i),s},t.prototype.removeSubTexturePivot=function(t){if(t)delete this._subTexturePivots[t];else for(t in this._subTexturePivots)delete this._subTexturePivots[t]},t}();t.SkeletonData=_,o=function(){function t(){}return t.parseTextureAtlasData=function(t,i){if(void 0===i&&(i=1),!t)throw Error();var n={};n.__name=t[r.ConstValues.A_NAME];var s,o=t[r.ConstValues.SUB_TEXTURE];for(s in o){var a=(h=o[s])[r.ConstValues.A_NAME],h=new e.Rectangle(Number(h[r.ConstValues.A_X])/i,Number(h[r.ConstValues.A_Y])/i,Number(h[r.ConstValues.A_WIDTH])/i,Number(h[r.ConstValues.A_HEIGHT])/i);n[a]=h}return n},t.parseSkeletonData=function(e){if(!e)throw Error();var i=Number(e[r.ConstValues.A_FRAME_RATE]),n=new _;n.name=e[r.ConstValues.A_NAME],e=e[r.ConstValues.ARMATURE];for(var s in e)n.addArmatureData(t.parseArmatureData(e[s],n,i));return n},t.parseArmatureData=function(e,i,n){var s=new p;s.name=e[r.ConstValues.A_NAME];var o,a=e[r.ConstValues.BONE];for(o in a)s.addBoneData(t.parseBoneData(a[o]));a=e[r.ConstValues.SKIN];for(o in a)s.addSkinData(t.parseSkinData(a[o],i));r.DBDataUtil.transformArmatureData(s),s.sortBoneDataList(),e=e[r.ConstValues.ANIMATION];for(o in e)s.addAnimationData(t.parseAnimationData(e[o],s,n));return s},t.parseBoneData=function(e){var i=new l;i.name=e[r.ConstValues.A_NAME],i.parent=e[r.ConstValues.A_PARENT],i.length=Number(e[r.ConstValues.A_LENGTH])||0;var n=Number(e[r.ConstValues.A_SCALE_MODE]);return!isNaN(n)&&n&&(i.scaleMode=n),(n=e[r.ConstValues.A_FIXED_ROTATION])&&(i.fixedRotation=n),t.parseTransform(e[r.ConstValues.TRANSFORM],i.global),i.transform.copy(i.global),i},t.parseSkinData=function(e,i){var n=new d;n.name=e[r.ConstValues.A_NAME];var s,o=e[r.ConstValues.SLOT];for(s in o)n.addSlotData(t.parseSlotData(o[s],i));return n},t.parseSlotData=function(e,i){var n=new c;n.name=e[r.ConstValues.A_NAME],n.parent=e[r.ConstValues.A_PARENT],n.zOrder=Number(e[r.ConstValues.A_Z_ORDER]),n.blendMode=e[r.ConstValues.A_BLENDMODE],n.blendMode||(n.blendMode="normal");var s,o=e[r.ConstValues.DISPLAY];for(s in o)n.addDisplayData(t.parseDisplayData(o[s],i));return n},t.parseDisplayData=function(e,i){var n=new u;return n.name=e[r.ConstValues.A_NAME],n.type=e[r.ConstValues.A_TYPE],n.pivot=i.addSubTexturePivot(0,0,n.name),t.parseTransform(e[r.ConstValues.TRANSFORM],n.transform,n.pivot),n},t.parseAnimationData=function(e,i,n){var s=new h;if(s.name=e[r.ConstValues.A_NAME],s.frameRate=n,s.loop=Number(e[r.ConstValues.A_LOOP])||0,s.fadeInTime=Number(e[r.ConstValues.A_FADE_IN_TIME]),s.duration=Number(e[r.ConstValues.A_DURATION])/n,s.scale=Number(e[r.ConstValues.A_SCALE]),e.hasOwnProperty(r.ConstValues.A_TWEEN_EASING)){u=e[r.ConstValues.A_TWEEN_EASING];s.tweenEasing=void 0==u||null==u?NaN:Number(u)}else s.tweenEasing=NaN;t.parseTimeline(e,s,t.parseMainFrame,n);var o,a,u=e[r.ConstValues.TIMELINE];for(a in u)o=u[a],e=t.parseTransformTimeline(o,s.duration,n),o=o[r.ConstValues.A_NAME],s.addTimeline(e,o);return r.DBDataUtil.addHideTimeline(s,i),r.DBDataUtil.transformAnimationData(s,i),s},t.parseTimeline=function(t,e,i,n){var s,o=0;t=t[r.ConstValues.FRAME];for(var a in t)s=i(t[a],n),s.position=o,e.addFrame(s),o+=s.duration;s&&(s.duration=e.duration-s.position)},t.parseTransformTimeline=function(e,i,n){var s=new a;return s.duration=i,t.parseTimeline(e,s,t.parseTransformFrame,n),s.scale=Number(e[r.ConstValues.A_SCALE]),s.offset=Number(e[r.ConstValues.A_OFFSET]),s},t.parseFrame=function(t,e,i){e.duration=Number(t[r.ConstValues.A_DURATION])/i,e.action=t[r.ConstValues.A_ACTION],e.event=t[r.ConstValues.A_EVENT],e.sound=t[r.ConstValues.A_SOUND]},t.parseMainFrame=function(e,i){var s=new n;return t.parseFrame(e,s,i),s},t.parseTransformFrame=function(i,n){var o=new s;if(t.parseFrame(i,o,n),o.visible=1!=Number(i[r.ConstValues.A_HIDE]),i.hasOwnProperty(r.ConstValues.A_TWEEN_EASING)){var a=i[r.ConstValues.A_TWEEN_EASING];o.tweenEasing=void 0==a||null==a?NaN:Number(a)}else o.tweenEasing=0;return o.tweenRotate=Number(i[r.ConstValues.A_TWEEN_ROTATE])||0,o.displayIndex=Number(i[r.ConstValues.A_DISPLAY_INDEX])||0,o.zOrder=Number(i[r.ConstValues.A_Z_ORDER])||0,t.parseTransform(i[r.ConstValues.TRANSFORM],o.global,o.pivot),o.transform.copy(o.global),(a=i[r.ConstValues.COLOR_TRANSFORM])&&(o.color=new e.ColorTransform,o.color.alphaOffset=Number(a[r.ConstValues.A_ALPHA_OFFSET]),o.color.redOffset=Number(a[r.ConstValues.A_RED_OFFSET]),o.color.greenOffset=Number(a[r.ConstValues.A_GREEN_OFFSET]),o.color.blueOffset=Number(a[r.ConstValues.A_BLUE_OFFSET]),o.color.alphaMultiplier=.01*Number(a[r.ConstValues.A_ALPHA_MULTIPLIER]),o.color.redMultiplier=.01*Number(a[r.ConstValues.A_RED_MULTIPLIER]),o.color.greenMultiplier=.01*Number(a[r.ConstValues.A_GREEN_MULTIPLIER]),o.color.blueMultiplier=.01*Number(a[r.ConstValues.A_BLUE_MULTIPLIER])),o},t.parseTransform=function(t,e,i){void 0===i&&(i=null),t&&(e&&(e.x=Number(t[r.ConstValues.A_X]),e.y=Number(t[r.ConstValues.A_Y]),e.skewX=Number(t[r.ConstValues.A_SKEW_X])*r.ConstValues.ANGLE_TO_RADIAN,e.skewY=Number(t[r.ConstValues.A_SKEW_Y])*r.ConstValues.ANGLE_TO_RADIAN,e.scaleX=Number(t[r.ConstValues.A_SCALE_X]),e.scaleY=Number(t[r.ConstValues.A_SCALE_Y])),i&&(i.x=Number(t[r.ConstValues.A_PIVOT_X]),i.y=Number(t[r.ConstValues.A_PIVOT_Y])))},t}(),t.DataParser=o}(t.objects||(t.objects={}));var s=t.objects;!function(e){var n=function(e){function i(){e.call(this),this._dataDic={},this._textureAtlasDic={},this._textureAtlasLoadingDic={}}return __extends(i,e),i.prototype.getSkeletonData=function(t){return this._dataDic[t]},i.prototype.addSkeletonData=function(t,e){if(void 0===e&&(e=null),!t)throw Error();if(!(e=e||t.name))throw Error("Unnamed data!");this._dataDic[e]=t},i.prototype.removeSkeletonData=function(t){delete this._dataDic[t]},i.prototype.getTextureAtlas=function(t){return this._textureAtlasDic[t]},i.prototype.addTextureAtlas=function(t,e){if(void 0===e&&(e=null),!t)throw Error();if(!(e=e||t.name))throw Error("Unnamed data!");this._textureAtlasDic[e]=t},i.prototype.removeTextureAtlas=function(t){delete this._textureAtlasDic[t]},i.prototype.dispose=function(t){if(void 0===t&&(t=!0),t){for(var e in this._dataDic)this._dataDic[e].dispose();for(e in this._textureAtlasDic)this._textureAtlasDic[e].dispose()}this._currentTextureAtlasName=this._currentDataName=this._textureAtlasLoadingDic=this._textureAtlasDic=this._dataDic=null},i.prototype.buildArmature=function(e,i,n,r,o){if(n){var a=this._dataDic[n];if(a)var h=a.getArmatureData(e)}else for(n in this._dataDic)if(a=this._dataDic[n],h=a.getArmatureData(e))break;if(!h)return null;this._currentDataName=n,this._currentTextureAtlasName=r||n,(r=this._generateArmature()).name=e;var u,c,l,d=h.getBoneDataList();for(l in d)c=d[l],u=new t.Bone,u.name=c.name,u.fixedRotation=c.fixedRotation,u.scaleMode=c.scaleMode,u.origin.copy(c.transform),h.getBoneData(c.parent)?r.addChild(u,c.parent):r.addChild(u,null);if(i&&i!=e){var p=a.getArmatureData(i);if(!p)for(n in this._dataDic)if(a=this._dataDic[n],p=a.getArmatureData(i))break}if(p?r.animation.setAnimationDataList(p.getAnimationDataList()):r.animation.setAnimationDataList(h.getAnimationDataList()),!(u=h.getSkinData(o)))throw Error();e=[],n=u.getSlotDataList();for(l in n)if(a=n[l],u=r.getBone(a.parent)){for(o=a.getDisplayDataList(),(i=this._generateSlot()).name=a.name,i._blendMode=a.blendMode,i._originZOrder=a.zOrder,i._dislayDataList=o,e.length=0,a=o.length;a--;)switch((h=o[a]).type){case s.DisplayData.ARMATURE:(h=this.buildArmature(h.name,null,this._currentDataName,this._currentTextureAtlasName,null))&&(e[a]=h);break;default:e[a]=this._generateDisplay(this._textureAtlasDic[this._currentTextureAtlasName],h.name,h.pivot.x,h.pivot.y)}i.setDisplayList(e),i._changeDisplay(0),u.addChild(i)}return r._slotsZOrderChanged=!0,r.advanceTime(0),r},i.prototype.getTextureDisplay=function(t,e,i,n){if(e)var s=this._textureAtlasDic[e];if(!s&&!e)for(e in this._textureAtlasDic){if((s=this._textureAtlasDic[e]).getRegion(t))break;s=null}return s?((isNaN(i)||isNaN(n))&&(e=this._dataDic[e])&&(e=e.getSubTexturePivot(t))&&(i=e.x,n=e.y),this._generateDisplay(s,t,i,n)):null},i.prototype._generateArmature=function(){return null},i.prototype._generateSlot=function(){return null},i.prototype._generateDisplay=function(t,e,i,n){return null},i}(i.EventDispatcher);e.BaseFactory=n}(t.factorys||(t.factorys={})),function(t){var i=function(){function t(){}return t.ANGLE_TO_RADIAN=Math.PI/180,t.DRAGON_BONES="dragonBones",t.ARMATURE="armature",t.SKIN="skin",t.BONE="bone",t.SLOT="slot",t.DISPLAY="display",t.ANIMATION="animation",t.TIMELINE="timeline",t.FRAME="frame",t.TRANSFORM="transform",t.COLOR_TRANSFORM="colorTransform",t.TEXTURE_ATLAS="TextureAtlas",t.SUB_TEXTURE="SubTexture",t.A_VERSION="version",t.A_IMAGE_PATH="imagePath",t.A_FRAME_RATE="frameRate",t.A_NAME="name",t.A_PARENT="parent",t.A_LENGTH="length",t.A_TYPE="type",t.A_FADE_IN_TIME="fadeInTime",t.A_DURATION="duration",t.A_SCALE="scale",t.A_OFFSET="offset",t.A_LOOP="loop",t.A_EVENT="event",t.A_SOUND="sound",t.A_ACTION="action",t.A_HIDE="hide",t.A_TWEEN_EASING="tweenEasing",t.A_TWEEN_ROTATE="tweenRotate",t.A_DISPLAY_INDEX="displayIndex",t.A_Z_ORDER="z",t.A_BLENDMODE="blendMode",t.A_WIDTH="width",t.A_HEIGHT="height",t.A_SCALE_MODE="scaleMode",t.A_FIXED_ROTATION="fixedRotation",t.A_X="x",t.A_Y="y",t.A_SKEW_X="skX",t.A_SKEW_Y="skY",t.A_SCALE_X="scX",t.A_SCALE_Y="scY",t.A_PIVOT_X="pX",t.A_PIVOT_Y="pY",t.A_ALPHA_OFFSET="aO",t.A_RED_OFFSET="rO",t.A_GREEN_OFFSET="gO",t.A_BLUE_OFFSET="bO",t.A_ALPHA_MULTIPLIER="aM",t.A_RED_MULTIPLIER="rM",t.A_GREEN_MULTIPLIER="gM",t.A_BLUE_MULTIPLIER="bM",t}();t.ConstValues=i;var r=function(){function t(){}return t.transformPointWithParent=function(e,i){var n=t._helpMatrix;t.transformToMatrix(i,n),n.invert();var s=e.x,r=e.y;e.x=n.a*s+n.c*r+n.tx,e.y=n.d*r+n.b*s+n.ty,e.skewX=t.formatRadian(e.skewX-i.skewX),e.skewY=t.formatRadian(e.skewY-i.skewY)},t.transformToMatrix=function(t,e){e.a=t.scaleX*Math.cos(t.skewY),e.b=t.scaleX*Math.sin(t.skewY),e.c=-t.scaleY*Math.sin(t.skewX),e.d=t.scaleY*Math.cos(t.skewX),e.tx=t.x,e.ty=t.y},t.formatRadian=function(e){return(e%=t.DOUBLE_PI)>Math.PI&&(e-=t.DOUBLE_PI),e<-Math.PI&&(e+=t.DOUBLE_PI),e},t.DOUBLE_PI=2*Math.PI,t._helpMatrix=new e.Matrix,t}();t.TransformUtil=r,i=function(){function t(){}return t.transformArmatureData=function(t){for(var e,i,n=t.getBoneDataList(),s=n.length;s--;)(e=n[s]).parent&&(i=t.getBoneData(e.parent))&&(e.transform.copy(e.global),r.transformPointWithParent(e.transform,i.global))},t.transformArmatureDataAnimations=function(e){for(var i=e.getAnimationDataList(),n=i.length;n--;)t.transformAnimationData(i[n],e)},t.transformAnimationData=function(e,i){for(var n,s,o,a,h,u,c,l,d,p,_=i.getSkinData(null),g=i.getBoneDataList(),_=_.getSlotDataList(),f=g.length;f--;)if(n=g[f],s=e.getTimeline(n.name)){o=null;for(var m in _)if((o=_[m]).parent==n.name)break;a=n.parent?e.getTimeline(n.parent):null,l=c=u=null,p=(h=s.getFrameList()).length;for(var y=0;y<p;y++){if(d=h[y],a?(t._helpTransform1.copy(d.global),t.getTimelineTransform(a,d.position,t._helpTransform2),r.transformPointWithParent(t._helpTransform1,t._helpTransform2),d.transform.copy(t._helpTransform1)):d.transform.copy(d.global),d.transform.x-=n.transform.x,d.transform.y-=n.transform.y,d.transform.skewX-=n.transform.skewX,d.transform.skewY-=n.transform.skewY,d.transform.scaleX-=n.transform.scaleX,d.transform.scaleY-=n.transform.scaleY,!s.transformed&&o&&(d.zOrder-=o.zOrder),u||((u=s.originTransform).copy(d.transform),u.skewX=r.formatRadian(u.skewX),u.skewY=r.formatRadian(u.skewY),c=s.originPivot,c.x=d.pivot.x,c.y=d.pivot.y),d.transform.x-=u.x,d.transform.y-=u.y,d.transform.skewX=r.formatRadian(d.transform.skewX-u.skewX),d.transform.skewY=r.formatRadian(d.transform.skewY-u.skewY),d.transform.scaleX-=u.scaleX,d.transform.scaleY-=u.scaleY,s.transformed||(d.pivot.x-=c.x,d.pivot.y-=c.y),l){var v=d.transform.skewX-l.transform.skewX;l.tweenRotate?0<l.tweenRotate?(0>v&&(d.transform.skewX+=2*Math.PI,d.transform.skewY+=2*Math.PI),1<l.tweenRotate&&(d.transform.skewX+=2*Math.PI*(l.tweenRotate-1),d.transform.skewY+=2*Math.PI*(l.tweenRotate-1))):(0<v&&(d.transform.skewX-=2*Math.PI,d.transform.skewY-=2*Math.PI),1>l.tweenRotate&&(d.transform.skewX+=2*Math.PI*(l.tweenRotate+1),d.transform.skewY+=2*Math.PI*(l.tweenRotate+1))):(d.transform.skewX=l.transform.skewX+r.formatRadian(d.transform.skewX-l.transform.skewX),d.transform.skewY=l.transform.skewY+r.formatRadian(d.transform.skewY-l.transform.skewY))}l=d}s.transformed=!0}},t.getTimelineTransform=function(t,e,i){for(var s,o=t.getFrameList(),a=o.length;a--;)if((t=o[a]).position<=e&&t.position+t.duration>e){s=t.tweenEasing,a==o.length-1||isNaN(s)||e==t.position?i.copy(t.global):(e=(e-t.position)/t.duration,s&&(e=n.TimelineState.getEaseValue(e,s)),o=o[a+1],i.x=t.global.x+(o.global.x-t.global.x)*e,i.y=t.global.y+(o.global.y-t.global.y)*e,i.skewX=r.formatRadian(t.global.skewX+(o.global.skewX-t.global.skewX)*e),i.skewY=r.formatRadian(t.global.skewY+(o.global.skewY-t.global.skewY)*e),i.scaleX=t.global.scaleX+(o.global.scaleX-t.global.scaleX)*e,i.scaleY=t.global.scaleY+(o.global.scaleY-t.global.scaleY)*e);break}},t.addHideTimeline=function(t,e){for(var i,n=e.getBoneDataList(),r=n.length;r--;)i=n[r],i=i.name,t.getTimeline(i)||t.addTimeline(s.TransformTimeline.HIDE_TIMELINE,i)},t._helpTransform1=new s.DBTransform,t._helpTransform2=new s.DBTransform,t}(),t.DBDataUtil=i}(t.utils||(t.utils={}));var r=t.utils,o=function(){function t(){this.global=new s.DBTransform,this.origin=new s.DBTransform,this.offset=new s.DBTransform,this.tween=new s.DBTransform,this.tween.scaleX=this.tween.scaleY=0,this._globalTransformMatrix=new e.Matrix,this._visible=!0,this._isDisplayOnStage=this._isColorChanged=!1,this._scaleType=0,this.fixedRotation=!1}return t.prototype.getVisible=function(){return this._visible},t.prototype.setVisible=function(t){this._visible=t},t.prototype._setParent=function(t){this.parent=t},t.prototype._setArmature=function(t){this.armature&&this.armature._removeDBObject(this),(this.armature=t)&&this.armature._addDBObject(this)},t.prototype.dispose=function(){this._globalTransformMatrix=this.tween=this.offset=this.origin=this.global=this.armature=this.parent=null},t.prototype._update=function(){if(this.global.scaleX=(this.origin.scaleX+this.tween.scaleX)*this.offset.scaleX,this.global.scaleY=(this.origin.scaleY+this.tween.scaleY)*this.offset.scaleY,this.parent){var t=this.origin.x+this.offset.x+this.tween.x,e=this.origin.y+this.offset.y+this.tween.y,i=this.parent._globalTransformMatrix;this._globalTransformMatrix.tx=this.global.x=i.a*t+i.c*e+i.tx,this._globalTransformMatrix.ty=this.global.y=i.d*e+i.b*t+i.ty,this.fixedRotation?(this.global.skewX=this.origin.skewX+this.offset.skewX+this.tween.skewX,this.global.skewY=this.origin.skewY+this.offset.skewY+this.tween.skewY):(this.global.skewX=this.origin.skewX+this.offset.skewX+this.tween.skewX+this.parent.global.skewX,this.global.skewY=this.origin.skewY+this.offset.skewY+this.tween.skewY+this.parent.global.skewY),this.parent.scaleMode>=this._scaleType&&(this.global.scaleX*=this.parent.global.scaleX,this.global.scaleY*=this.parent.global.scaleY)}else this._globalTransformMatrix.tx=this.global.x=this.origin.x+this.offset.x+this.tween.x,this._globalTransformMatrix.ty=this.global.y=this.origin.y+this.offset.y+this.tween.y,this.global.skewX=this.origin.skewX+this.offset.skewX+this.tween.skewX,this.global.skewY=this.origin.skewY+this.offset.skewY+this.tween.skewY;this._globalTransformMatrix.a=this.global.scaleX*Math.cos(this.global.skewY),this._globalTransformMatrix.b=this.global.scaleX*Math.sin(this.global.skewY),this._globalTransformMatrix.c=-this.global.scaleY*Math.sin(this.global.skewX),this._globalTransformMatrix.d=this.global.scaleY*Math.cos(this.global.skewX)},t}();t.DBObject=o;var a=function(t){function e(e){t.call(this),this._displayBridge=e,this._displayList=[],this._displayIndex=-1,this._scaleType=1,this._offsetZOrder=this._tweenZorder=this._originZOrder=0,this._isHideDisplay=this._isDisplayOnStage=!1,this._blendMode="normal",this._displayBridge.updateBlendMode(this._blendMode)}return __extends(e,t),e.prototype.getZOrder=function(){return this._originZOrder+this._tweenZorder+this._offsetZOrder},e.prototype.setZOrder=function(t){this.getZOrder()!=t&&(this._offsetZOrder=t-this._originZOrder-this._tweenZorder,this.armature&&(this.armature._slotsZOrderChanged=!0))},e.prototype.getDisplay=function(){var t=this._displayList[this._displayIndex];return t instanceof u?t.getDisplay():t},e.prototype.setDisplay=function(t){this._displayList[this._displayIndex]=t,this._setDisplay(t)},e.prototype.getBlendMode=function(){return this._blendMode},e.prototype.setBlendMode=function(t){this._blendMode!=t&&(this._blendMode=t,this._displayBridge.getDisplay()&&this._displayBridge.updateBlendMode(this._blendMode))},e.prototype.getChildArmature=function(){var t=this._displayList[this._displayIndex];return t instanceof u?t:null},e.prototype.setChildArmature=function(t){(this._displayList[this._displayIndex]=t)&&this._setDisplay(t.getDisplay())},e.prototype.getDisplayList=function(){return this._displayList},e.prototype.setDisplayList=function(t){if(!t)throw Error();for(var e=this._displayList.length=t.length;e--;)this._displayList[e]=t[e];0<=this._displayIndex&&(t=this._displayIndex,this._displayIndex=-1,this._changeDisplay(t))},e.prototype._setDisplay=function(t){this._displayBridge.getDisplay()?this._displayBridge.setDisplay(t):(this._displayBridge.setDisplay(t),this.armature&&(this._displayBridge.addDisplay(this.armature.getDisplay(),-1),this.armature._slotsZOrderChanged=!0)),this.updateChildArmatureAnimation(),t&&this._displayBridge.updateBlendMode(this._blendMode),!this._isHideDisplay&&this._displayBridge.getDisplay()?this._isDisplayOnStage=!0:this._isDisplayOnStage=!1},e.prototype._changeDisplay=function(t){if(0>t)this._isHideDisplay||(this._isHideDisplay=!0,this._displayBridge.removeDisplay(),this.updateChildArmatureAnimation());else{if(this._isHideDisplay){this._isHideDisplay=!1;var e=!0;this.armature&&(this._displayBridge.addDisplay(this.armature.getDisplay(),-1),this.armature._slotsZOrderChanged=!0)}var i=this._displayList.length;t>=i&&0<i&&(t=i-1),this._displayIndex!=t?(this._displayIndex=t,(t=this._displayList[this._displayIndex])instanceof u?this._setDisplay(t.getDisplay()):this._setDisplay(t),this._dislayDataList&&this._displayIndex<=this._dislayDataList.length&&this.origin.copy(this._dislayDataList[this._displayIndex].transform)):e&&this.updateChildArmatureAnimation()}!this._isHideDisplay&&this._displayBridge.getDisplay()?this._isDisplayOnStage=!0:this._isDisplayOnStage=!1},e.prototype.setVisible=function(t){t!=this._visible&&(this._visible=t,this._updateVisible(this._visible))},e.prototype._setArmature=function(e){t.prototype._setArmature.call(this,e),this.armature?(this.armature._slotsZOrderChanged=!0,this._displayBridge.addDisplay(this.armature.getDisplay(),-1)):this._displayBridge.removeDisplay()},e.prototype.dispose=function(){this._displayBridge&&(t.prototype.dispose.call(this),this._displayBridge.dispose(),this._displayList.length=0,this._dislayDataList=this._displayList=this._displayBridge=null)},e.prototype._update=function(){if(t.prototype._update.call(this),this._isDisplayOnStage){var e=this.parent._tweenPivot.x,i=this.parent._tweenPivot.y;if(e||i){var n=this.parent._globalTransformMatrix;this._globalTransformMatrix.tx+=n.a*e+n.c*i,this._globalTransformMatrix.ty+=n.b*e+n.d*i}this._displayBridge.updateTransform(this._globalTransformMatrix,this.global)}},e.prototype._updateVisible=function(t){this._displayBridge.setVisible(this.parent.getVisible()&&this._visible&&t)},e.prototype.updateChildArmatureAnimation=function(){var t=this.getChildArmature();if(t)if(this._isHideDisplay)t.animation.stop(),t.animation._lastAnimationState=null;else{var e=this.armature?this.armature.animation.getLastAnimationName():null;e&&t.animation.hasAnimation(e)?t.animation.gotoAndPlay(e):t.animation.play()}},e}(o);t.Slot=a;var h=function(t){function n(){t.call(this),this._children=[],this._scaleType=2,this._tweenPivot=new e.Point,this.scaleMode=1}return __extends(n,t),n.prototype.setVisible=function(t){if(this._visible!=t)for(this._visible=t,t=this._children.length;t--;){var e=this._children[t];e instanceof a&&e._updateVisible(this._visible)}},n.prototype._setArmature=function(e){for(t.prototype._setArmature.call(this,e),e=this._children.length;e--;)this._children[e]._setArmature(this.armature)},n.prototype.dispose=function(){if(this._children){t.prototype.dispose.call(this);for(var e=this._children.length;e--;)this._children[e].dispose();this._children.length=0,this.slot=this._tweenPivot=this._children=null}},n.prototype.contains=function(t){if(!t)throw Error();if(t==this)return!1;for(;t!=this&&null!=t;)t=t.parent;return t==this},n.prototype.addChild=function(t){if(!t)throw Error();if(t==this||t instanceof n&&t.contains(this))throw Error("An Bone cannot be added as a child to itself or one of its children (or children's children, etc.)");t.parent&&t.parent.removeChild(t),this._children[this._children.length]=t,t._setParent(this),t._setArmature(this.armature),!this.slot&&t instanceof a&&(this.slot=t)},n.prototype.removeChild=function(t){if(!t)throw Error();var e=this._children.indexOf(t);if(!(0<=e))throw Error();this._children.splice(e,1),t._setParent(null),t._setArmature(null),t==this.slot&&(this.slot=null)},n.prototype.getSlots=function(){for(var t=[],e=this._children.length;e--;)this._children[e]instanceof a&&t.unshift(this._children[e]);return t},n.prototype._arriveAtFrame=function(t,e,s,r){if(t){if(e=s.getMixingTransform(name),!s.displayControl||2!=e&&-1!=e||this.displayController&&this.displayController!=s.name||!this.slot||(0<=(e=t.displayIndex)&&!isNaN(t.zOrder)&&t.zOrder!=this.slot._tweenZorder&&(this.slot._tweenZorder=t.zOrder,this.armature._slotsZOrderChanged=!0),this.slot._changeDisplay(e),this.slot._updateVisible(t.visible)),t.event&&this.armature.hasEventListener(i.FrameEvent.BONE_FRAME_EVENT)&&(e=new i.FrameEvent(i.FrameEvent.BONE_FRAME_EVENT),e.bone=this,e.animationState=s,e.frameLabel=t.event,this.armature._eventList.push(e)),t.sound&&n._soundManager.hasEventListener(i.SoundEvent.SOUND)&&(e=new i.SoundEvent(i.SoundEvent.SOUND),e.armature=this.armature,e.animationState=s,e.sound=t.sound,n._soundManager.dispatchEvent(e)),t.action)for(var o in this._children)this._children[o]instanceof a&&(s=this._children[o].getChildArmature())&&s.animation.gotoAndPlay(t.action)}else this.slot&&this.slot._changeDisplay(-1)},n.prototype._updateColor=function(t,e,i,n,s,r,o,a,h){(h||this._isColorChanged)&&this.slot._displayBridge.updateColor(t,e,i,n,s,r,o,a),this._isColorChanged=h},n._soundManager=i.SoundEventManager.getInstance(),n}(o);t.Bone=h;var u=function(t){function e(e){t.call(this),this.animation=new n.Animation(this),this._display=e,this._slotsZOrderChanged=!1,this._slotList=[],this._boneList=[],this._eventList=[]}return __extends(e,t),e.prototype.getDisplay=function(){return this._display},e.prototype.dispose=function(){if(this.animation){this.animation.dispose();for(var t=this._slotList.length;t--;)this._slotList[t].dispose();for(t=this._boneList.length;t--;)this._boneList[t].dispose();this._slotList.length=0,this._boneList.length=0,this._eventList.length=0,this.animation=this._display=this._eventList=this._boneList=this._slotList=null}},e.prototype.advanceTime=function(t){this.animation.advanceTime(t),t*=this.animation.timeScale;for(n=this._boneList.length;n--;)this._boneList[n]._update();for(var e,n=this._slotList.length;n--;)(e=this._slotList[n])._update(),e._isDisplayOnStage&&(e=e.getChildArmature())&&e.advanceTime(t);if(this._slotsZOrderChanged&&(this.updateSlotsZOrder(),this.hasEventListener(i.ArmatureEvent.Z_ORDER_UPDATED)&&this.dispatchEvent(new i.ArmatureEvent(i.ArmatureEvent.Z_ORDER_UPDATED))),this._eventList.length){for(t=this._eventList.length,n=0;n<t;n++)this.dispatchEvent(this._eventList[n]);this._eventList.length=0}},e.prototype.getSlots=function(t){return void 0===t&&(t=!0),t?this._slotList.concat():this._slotList},e.prototype.getBones=function(t){return void 0===t&&(t=!0),t?this._boneList.concat():this._boneList},e.prototype.getSlot=function(t){for(var e=this._slotList.length;e--;)if(this._slotList[e].name==t)return this._slotList[e];return null},e.prototype.getSlotByDisplay=function(t){if(t)for(var e=this._slotList.length;e--;)if(this._slotList[e].getDisplay()==t)return this._slotList[e];return null},e.prototype.removeSlot=function(t){if(!t)throw Error();if(!(0<=this._slotList.indexOf(t)))throw Error();t.parent.removeChild(t)},e.prototype.removeSlotByName=function(t){t&&(t=this.getSlot(t))&&this.removeSlot(t)},e.prototype.getBone=function(t){for(var e=this._boneList.length;e--;)if(this._boneList[e].name==t)return this._boneList[e];return null},e.prototype.getBoneByDisplay=function(t){return(t=this.getSlotByDisplay(t))?t.parent:null},e.prototype.removeBone=function(t){if(!t)throw Error();if(!(0<=this._boneList.indexOf(t)))throw Error();t.parent?t.parent.removeChild(t):t._setArmature(null)},e.prototype.removeBoneByName=function(t){t&&(t=this.getBone(t))&&this.removeBone(t)},e.prototype.addChild=function(t,e){if(!t)throw Error();if(e){var i=this.getBone(e);if(!i)throw Error();i.addChild(t)}else t.parent&&t.parent.removeChild(t),t._setArmature(this)},e.prototype.updateSlotsZOrder=function(){this._slotList.sort(this.sortSlot);for(var t,e=this._slotList.length;e--;)(t=this._slotList[e])._isDisplayOnStage&&t._displayBridge.addDisplay(this._display,-1);this._slotsZOrderChanged=!1},e.prototype._addDBObject=function(t){t instanceof a?0>this._slotList.indexOf(t)&&(this._slotList[this._slotList.length]=t):t instanceof h&&0>this._boneList.indexOf(t)&&(this._boneList[this._boneList.length]=t,this._sortBoneList())},e.prototype._removeDBObject=function(t){t instanceof a?0<=(t=this._slotList.indexOf(t))&&this._slotList.splice(t,1):t instanceof h&&0<=(t=this._boneList.indexOf(t))&&this._boneList.splice(t,1)},e.prototype._sortBoneList=function(){var t=this._boneList.length;if(0!=t){for(var e,i,n,s=[];t--;){for(e=0,n=i=this._boneList[t];n;)e++,n=n.parent;s[t]={level:e,bone:i}}for(s.sort(this.sortBone),t=s.length;t--;)this._boneList[t]=s[t].bone}},e.prototype._arriveAtFrame=function(t,n,s,r){t.event&&this.hasEventListener(i.FrameEvent.ANIMATION_FRAME_EVENT)&&(n=new i.FrameEvent(i.FrameEvent.ANIMATION_FRAME_EVENT),n.animationState=s,n.frameLabel=t.event,this._eventList.push(n)),t.sound&&e._soundManager.hasEventListener(i.SoundEvent.SOUND)&&(n=new i.SoundEvent(i.SoundEvent.SOUND),n.armature=this,n.animationState=s,n.sound=t.sound,e._soundManager.dispatchEvent(n)),t.action&&s.isPlaying&&this.animation.gotoAndPlay(t.action)},e.prototype.sortSlot=function(t,e){return t.getZOrder()<e.getZOrder()?1:-1},e.prototype.sortBone=function(t,e){return t.level<e.level?1:-1},e._soundManager=i.SoundEventManager.getInstance(),e}(i.EventDispatcher);t.Armature=u}(dragonBones||(dragonBones={})),__extends=this.__extends||function(t,e){function i(){this.constructor=t}for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n]);i.prototype=e.prototype,t.prototype=new i},function(t){!function(t){var e=function(){function t(){}return t.prototype.getVisible=function(){return!!this._display&&this._display.visible},t.prototype.setVisible=function(t){this._display&&(this._display.visible=t)},t.prototype.getDisplay=function(){return this._display},t.prototype.setDisplay=function(t){if(this._display!=t){if(this._display){var e=this._display.parent;if(e)var i=-1;this.removeDisplay()}this._display=t,this.addDisplay(e,i)}},t.prototype.dispose=function(){this._display=null},t.prototype.updateTransform=function(e,i){this._display.x=e.tx,this._display.y=e.ty,this._display.skewX=i.skewX*t.RADIAN_TO_ANGLE,this._display.skewY=i.skewY*t.RADIAN_TO_ANGLE,this._display.scaleX=i.scaleX,this._display.scaleY=i.scaleY},t.prototype.updateColor=function(t,e,i,n,s,r,o,a){this._display&&(this._display.alpha=s)},t.prototype.updateBlendMode=function(t){this._display&&(this._display.blendMode=ns_egret.BlendMode.getBlendMode(t))},t.prototype.addDisplay=function(t,e){t&&this._display&&(this._display.parent&&this._display.parent.removeChild(this._display),0>e?t.addChild(this._display):t.addChild(this._display,Math.min(e,t.numChildren)))},t.prototype.removeDisplay=function(){this._display&&this._display.parent&&this._display.parent.removeChild(this._display)},t.RADIAN_TO_ANGLE=180/Math.PI,t}();t.DragonBonesEgretBridge=e}(t.display||(t.display={}));var e=t.display;!function(e){var i=function(){function e(t,e,i){void 0===i&&(i=1),this.texture=t,this.scale=i,this.parseData(e)}return e.prototype.dispose=function(){this.texture=null},e.prototype.getRegion=function(t){throw Error("error")},e.prototype.parseData=function(e){this.name=e[t.utils.ConstValues.A_NAME],this.spriteSheet=ns_egret.SpriteSheet.parseFromDragonBones(e)},e}();e.EgretTextureAtlas=i}(t.textures||(t.textures={})),function(i){var n=function(i){function n(){i.call(this)}return __extends(n,i),n.prototype._generateArmature=function(){return new t.Armature(new ns_egret.DisplayObjectContainer)},n.prototype._generateSlot=function(){return new t.Slot(new e.DragonBonesEgretBridge)},n.prototype._generateDisplay=function(t,e,i,n){var s=ns_egret.Bitmap.initWithTexture(t.texture);return t=t.spriteSheet.getFrame(e),s.spriteFrame=t,s.setAnchorPoint(i,n),s},n}(t.factorys.BaseFactory);i.EgretFactory=n}(t.factorys||(t.factorys={}))}(dragonBones||(dragonBones={})),function(t){var e=function(){function e(){}return e.checkDrawImage=function(e,i,n,s,r,o,a,h,u){null==e&&t.Logger.fatal("texture为空"),(e.getTextureWidth()<i+s||e.getTextureHeight()<n+r)&&t.Logger.fatal("提供的尺寸超出texture尺寸")},e.checkAddEventListener=function(e,i,n,s,r){(null==i||void 0==i)&&t.Logger.fatal("addEventListener侦听函数不能为空")},e.checkSetScaleGrid=function(e,i,n,s,r){e||t.Logger.fatal("Scale9Bitmap没有纹理"),(0>parseInt(i)||0>parseInt(n)||0>parseInt(s)||0>parseInt(r))&&t.Logger.fatal("传入的值不能为负数"),e.getTextureWidth()<s+r&&t.Logger.fatal("传入的宽度超出范围"),e.getTextureHeight()<i+n&&t.Logger.fatal("传入的高度超出范围")},e.TRACE_RENDER_LOOP=function(e){void 0===e&&(e=0);var i=t.Ticker.getInstance(),n=t.MainContext.instance;switch(e){case 0:i.unregister(n.renderLoop,n);break;case 1:n.renderLoop();break;case 2:i.register(n.renderLoop,n)}},e.DRAW_IMAGE=!0,e.ADD_EVENT_LISTENER=!0,e.SCALE_BITMAP_SET_SCALE_GRID=!0,e}();t.DEBUG=e}(ns_egret||(ns_egret={})),egret_h5={prefix:"",loadScript:function(t,e){var i=0;if(-1<navigator.userAgent.indexOf("Trident/5")){var n=function(){egret_h5.loadSingleScript(egret_h5.prefix+t[i],function(){++i>=t.length?e():n()})};n()}else t.forEach(function(n,s){egret_h5.loadSingleScript(egret_h5.prefix+n,function(){++i>=t.length&&e()})})},loadSingleScript:function(t,e){var i=document.createElement("script");i.hasOwnProperty("async")&&(i.async=!1),i.src=t,i.addEventListener("load",function(){this.removeEventListener("load",arguments.callee,!1),e()},!1),document.body.appendChild(i)},startGame:function(){var t=document.getElementById(ns_egret.StageDelegate.canvas_name);context=ns_egret.MainContext.instance,context.rendererContext=new ns_egret.HTML5CanvasRenderer(t),context.touchContext=new ns_egret.TouchContext(t),context.stage=new ns_egret.Stage,ns_egret.ResourceLoader.prefix="assets/480/",ns_egret.RendererContext.CONTENT_SCALE_FACTOR=1,ns_egret.NetContext.context=new ns_egret.HTML5NetContext,context.run(),app&&app.startGame&&app.startGame()},preloadScript:function(t,e){egret_h5.preloadList||(egret_h5.preloadList=[]),egret_h5.preloadList=egret_h5.preloadList.concat(t.map(function(t){return e+t}))},startLoading:function(){egret_h5.loadScript(egret_h5.preloadList,egret_h5.startGame)}};var utils,__extends=this.__extends||function(t,e){function i(){this.constructor=t}for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n]);i.prototype=e.prototype,t.prototype=new i},GameApp=function(){function t(){}return t.prototype.startGame=function(){MyInfo=new UserInfo,MyInfo.statistics("enterGame"),this.initLoader(),ns_egret.SoundContext.context=new ns_egret.HTML5SoundContext;var t=new ns_egret.EqualToFrame,e=ns_egret.Browser.getInstance().isMobile?new ns_egret.FixedWidth:new ns_egret.FixedSize(480,800),t=new ns_egret.ResolutionPolicy(t,e);ns_egret.StageDelegate.getInstance().setDesignSize(480,800,t),t=document.getElementById(ns_egret.StageDelegate.canvas_name),ns_egret.MainContext.instance.stage.stageWidth=t.width,ns_egret.MainContext.instance.stage.stageHeight=t.height,ns_egret.NetContext.context=new ns_egret.HTML5NetContext,ns_egret.ResourceLoader.prefix="assets/400/",(t=new ns_egret.LoadingController).addResource("ui_egretLogo.png",ns_egret.ResourceLoader.DATA_TYPE_IMAGE),t.addResource("ui_notice_codename.png",ns_egret.ResourceLoader.DATA_TYPE_IMAGE),t.addResource("ui_word_get_award.png",ns_egret.ResourceLoader.DATA_TYPE_IMAGE),t.addResource("ui_word_get_award_2.png",ns_egret.ResourceLoader.DATA_TYPE_IMAGE),t.addResource("ui_word_zaipao.png",ns_egret.ResourceLoader.DATA_TYPE_IMAGE),t.addResource("ui_word_mi.png",ns_egret.ResourceLoader.DATA_TYPE_IMAGE),t.addResource("ui_get_award.png",ns_egret.ResourceLoader.DATA_TYPE_IMAGE),t.addResource("ui_award_1.png",ns_egret.ResourceLoader.DATA_TYPE_IMAGE),t.addResource("ui_gift_1.png",ns_egret.ResourceLoader.DATA_TYPE_IMAGE),t.addResource("ui_gift_2.png",ns_egret.ResourceLoader.DATA_TYPE_IMAGE),t.addResource("ui_gift_3.png",ns_egret.ResourceLoader.DATA_TYPE_IMAGE),t.addResource("ui_return_1.png",ns_egret.ResourceLoader.DATA_TYPE_IMAGE),t.addResource("ui_reset_1.png",ns_egret.ResourceLoader.DATA_TYPE_IMAGE),t.addResource("number.png",ns_egret.ResourceLoader.DATA_TYPE_IMAGE),t.addResource("number.json",ns_egret.ResourceLoader.DATA_TYPE_TEXT),t.addResource("combo_number.png",ns_egret.ResourceLoader.DATA_TYPE_IMAGE),t.addResource("combo_number.json",ns_egret.ResourceLoader.DATA_TYPE_TEXT),t.addResource("ui_logo.png?v=2",ns_egret.ResourceLoader.DATA_TYPE_IMAGE),t.addResource("ui_chuzhan_1.png",ns_egret.ResourceLoader.DATA_TYPE_IMAGE),t.addResource("ui_tanchuang_1.png",ns_egret.ResourceLoader.DATA_TYPE_IMAGE),t.addResource("ui_chendi_1.png",ns_egret.ResourceLoader.DATA_TYPE_IMAGE),t.addResource("ui_title_fail.png",ns_egret.ResourceLoader.DATA_TYPE_IMAGE),t.addResource("ui_title_success.png",ns_egret.ResourceLoader.DATA_TYPE_IMAGE),t.addResource("ui_title_1.png",ns_egret.ResourceLoader.DATA_TYPE_IMAGE),t.addResource("ui_font_score.png",ns_egret.ResourceLoader.DATA_TYPE_IMAGE),t.addResource("ui_font_best.png",ns_egret.ResourceLoader.DATA_TYPE_IMAGE),t.addResource("role2.png",ns_egret.ResourceLoader.DATA_TYPE_IMAGE),t.addResource("role2.json",ns_egret.ResourceLoader.DATA_TYPE_TEXT),t.addResource("background.jpg?v=2",ns_egret.ResourceLoader.DATA_TYPE_IMAGE),t.addResource("wall.jpg?v=3",ns_egret.ResourceLoader.DATA_TYPE_IMAGE),t.addResource("roof.png?v=2",ns_egret.ResourceLoader.DATA_TYPE_IMAGE),t.addResource("bubble.png",ns_egret.ResourceLoader.DATA_TYPE_IMAGE),t.addResource("ui_anger_bg.png",ns_egret.ResourceLoader.DATA_TYPE_IMAGE),t.addResource("ui_score_bg.png",ns_egret.ResourceLoader.DATA_TYPE_IMAGE),t.addResource("ui_progress.png",ns_egret.ResourceLoader.DATA_TYPE_IMAGE),t.addResource("anger.png",ns_egret.ResourceLoader.DATA_TYPE_IMAGE),t.addResource("qiao.png",ns_egret.ResourceLoader.DATA_TYPE_IMAGE),t.addResource("bird.png?v=2",ns_egret.ResourceLoader.DATA_TYPE_IMAGE),t.addResource("bird.json?v=2",ns_egret.ResourceLoader.DATA_TYPE_TEXT),t.addResource("death.png?v=2",ns_egret.ResourceLoader.DATA_TYPE_IMAGE),t.addResource("death.json?v=2",ns_egret.ResourceLoader.DATA_TYPE_TEXT),t.addResource("maxAnger.png",ns_egret.ResourceLoader.DATA_TYPE_IMAGE),t.addResource("maxAnger.json",ns_egret.ResourceLoader.DATA_TYPE_TEXT),t.addResource("monkey.png?v=2",ns_egret.ResourceLoader.DATA_TYPE_IMAGE),t.addResource("monkey.json?v=2",ns_egret.ResourceLoader.DATA_TYPE_TEXT),t.addResource("monkeyRun.png",ns_egret.ResourceLoader.DATA_TYPE_IMAGE),t.addResource("monkeyRun2.png",ns_egret.ResourceLoader.DATA_TYPE_IMAGE),t.addResource("monkeyRun.json",ns_egret.ResourceLoader.DATA_TYPE_TEXT),t.addResource("horizontalMonster.png",ns_egret.ResourceLoader.DATA_TYPE_IMAGE),t.addResource("horizontalMonster.json",ns_egret.ResourceLoader.DATA_TYPE_TEXT),t.addResource("hit.png",ns_egret.ResourceLoader.DATA_TYPE_IMAGE),t.addResource("hit.json",ns_egret.ResourceLoader.DATA_TYPE_TEXT),t.addResource("lianji.png",ns_egret.ResourceLoader.DATA_TYPE_IMAGE),t.addResource("chendi_bg.png",ns_egret.ResourceLoader.DATA_TYPE_IMAGE),t.addResource("jindutiao_1.png",ns_egret.ResourceLoader.DATA_TYPE_IMAGE),t.addResource("jindutiao_2.png",ns_egret.ResourceLoader.DATA_TYPE_IMAGE),t.addResource("ui_lucheng.png",ns_egret.ResourceLoader.DATA_TYPE_IMAGE),t.addResource("ui_lucheng2.png",ns_egret.ResourceLoader.DATA_TYPE_IMAGE),t.addResource("bananaAnger.png",ns_egret.ResourceLoader.DATA_TYPE_IMAGE),t.addResource("ui_ninbenzhou.png",ns_egret.ResourceLoader.DATA_TYPE_IMAGE),t.addResource("duihua-1.png",ns_egret.ResourceLoader.DATA_TYPE_IMAGE),t.addResource("duihua-2.png",ns_egret.ResourceLoader.DATA_TYPE_IMAGE),t.addResource("duihua-3.png",ns_egret.ResourceLoader.DATA_TYPE_IMAGE),t.addResource("zilaiye.png",ns_egret.ResourceLoader.DATA_TYPE_IMAGE),t.addResource("hand.png",ns_egret.ResourceLoader.DATA_TYPE_IMAGE),Const.HAS_RANK?(t.addResource("paihang.png",ns_egret.ResourceLoader.DATA_TYPE_IMAGE),t.addResource("button-qianwangduihuan-1.png",ns_egret.ResourceLoader.DATA_TYPE_IMAGE),t.addResource("qingliuaia.png",ns_egret.ResourceLoader.DATA_TYPE_IMAGE),t.addResource("dewanjia.png",ns_egret.ResourceLoader.DATA_TYPE_IMAGE),t.addResource("nin.png",ns_egret.ResourceLoader.DATA_TYPE_IMAGE),t.addResource("mi_2.png",ns_egret.ResourceLoader.DATA_TYPE_IMAGE),t.addResource("gong.png",ns_egret.ResourceLoader.DATA_TYPE_IMAGE),t.addResource("jisha.png",ns_egret.ResourceLoader.DATA_TYPE_IMAGE),t.addResource("zhiguai.png",ns_egret.ResourceLoader.DATA_TYPE_IMAGE),t.addResource("zongji.png",ns_egret.ResourceLoader.DATA_TYPE_IMAGE),t.addResource("fen.png",ns_egret.ResourceLoader.DATA_TYPE_IMAGE),t.addResource("cent.png",ns_egret.ResourceLoader.DATA_TYPE_IMAGE),t.addResource("mingren.png",ns_egret.ResourceLoader.DATA_TYPE_IMAGE)):t.addResource("ui_mingren.png",ns_egret.ResourceLoader.DATA_TYPE_IMAGE),t.setLoadingView(new LoadingUI),t.addEventListener(ns_egret.ResourceLoader.LOAD_COMPLETE,this.resourceLoadComplete,this),t.load()},t.prototype.initLoader=function(){var t=function(t){function e(e){t.call(this,e,ns_egret.ResourceLoader.DATA_TYPE_TEXT)}return __extends(e,t),e.prototype.onLoadComplete=function(t){this.data=JSON.parse(t)},e}(ns_egret.ResourceLoader);ns_egret.ResourceLoader.registerHandler("json",t)},t.prototype.resourceLoadComplete=function(){var t=ns_egret.MainContext.instance.stage,e=utils.createBitmap("background.jpg");t.addChild(e),gameContainer=new ns_egret.DisplayObjectContainer,t.addChild(gameContainer),topContainer=new ns_egret.DisplayObjectContainer,t.addChild(topContainer),(t=new StateMachine).changeState(new LoginState),this.stateMachine=t},t.prototype.restartGame=function(){!this.stateMachine.state.angerContainer.maxAnger&&!this.role.isGod&&this.role.canDeath&&(this.role.hasBuff?this.role.removeBuff():(system.hitTest.reset(),this.stateMachine.state.onDeath(),this.role.death(),999999999<=MyInfo.score&&(MyInfo.statistics("pass100score"),localStorage.setItem("guide","complete"))))},t}(),Const=function(){function t(){}return t.ROLE_V_X=5,t.BIRD_V_X=8,t.G=1,t.HORIZON=200,t.JUMP_X=10,t.SHOW_AWARD_TICK=600,t.WALL_WIDTH=70,t.SLIVER_GIFT=9999999,t.GOLD_GIFT=9999999,t.COMBO_CANCEL_TIME=1500,t.CAMERA_SPEED=10,t.COMBO_MAX=7,t.SCORE_MAX=1e3,t.BUILDING_SCORE=25,t.BUILDING_AND_MONKEY_SCORE=50,t.FLYING_SCORE=30,t.VERTICAL_MONKEY_SCORE=0,t.HORIZONTAL_MONKEY_SCORE=70,t.SUPER_VERTICAL_MONKEY_SCORE=100,t.JUMP_MONKEY_SCORE=400,t.HAS_RANK=!0,t.GUIDE_STOP_LIST=[1010,2180,3400,4400],t}();!function(t){t.createBitmap=function(t){var e=new ns_egret.Bitmap;return t=ns_egret.TextureCache.getInstance().getTexture(t),e.texture=t,e},t.scaleDialog=function(t){t.scaleX=t.scaleY=0,ns_egret.Tween.get(t).to({scaleX:1,scaleY:1},400,ns_egret.Ease.backOut)},t.createGift=function(){return 99999999>MyInfo.score?t.createBitmap("ui_gift_1.png"):99999999>MyInfo.score?t.createBitmap("ui_gift_2.png"):t.createBitmap("ui_gift_3.png")},t.addHitMC=function(t){var e=ns_egret.ResourceLoader.create("hit.json").data,i=ns_egret.TextureCache.getInstance().getTexture("hit.png");(e=new ns_egret.MovieClip(e,i)).gotoAndPlay("run"),e.setInterval(2),e.relativeAnchorPointX=e.relativeAnchorPointY=.5,t=t.localToGlobal(),e.x=t.x-40,e.y=t.y-20,ns_egret.MainContext.instance.stage.addChild(e),e.addEventListener("playComplete",function(){this.stop(),this.parent.removeChild(this)},e)}}(utils||(utils={}));var StateMachine=function(){function t(){}return t.prototype.changeState=function(t){this.state&&this.state.onExit(),t.onEnter(),this.state=t},t}(),State=function(){function t(){}return t.prototype.onEnter=function(){},t.prototype.onExit=function(){},t}(),GameState=function(t){function e(){t.apply(this,arguments),this._tick=0,this._isDeath=!1,this.monsterMoveY=this.moveY=0,this._isFirstClick=this._guideBirdAdded=this._guideBuildingAdded=!1,this._lastTime=0}return __extends(e,t),e.prototype.onEnter=function(){this._tick=MyInfo.killNumber=0;var t=ns_egret.MainContext.instance.stage,e=new Background;e.create(),e.add(),gameContainer.addChild(e.view),this.role=new MainRole,this.role.create(),this.role.add(),gameContainer.addChild(this.role.view),app.role=this.role,this.allCombo=new Combo,topContainer=new ns_egret.DisplayObjectContainer,t.addChild(topContainer),this.initAnger(),this.initScore(),-1!=MyInfo.guideStep?(this.angerContainer.onGetAnger(),this.angerContainer.onGetAnger(),null==this._guideUI&&(this._guideUI=new GuideUI,this._guideUI.y=t.stageHeight-150),t.addChild(this._guideUI),this._guideUI.setText("小子！要想成为一名优秀的忍者，首先要训练的就是洞察力和反应力。"),this.role.mc.gotoAndStop("run"),t.addEventListener(ns_egret.TouchEvent.TOUCH_TAP,this.guideBeginClick,this)):ns_egret.Ticker.getInstance().register(this.run,this)},e.prototype.guideBeginClick=function(){var t=ns_egret.MainContext.instance.stage;t.removeEventListener(ns_egret.TouchEvent.TOUCH_TAP,this.guideBeginClick,this),ns_egret.Ticker.getInstance().register(this.run,this),t.removeChild(this._guideUI),this.role.mc.gotoAndPlay("run")},e.prototype.addMonkey=function(t,e){var i=JSON.parse(ns_egret.ResourceLoader.create("monkey.json?v=2").data),n=ns_egret.TextureCache.getInstance().getTexture("monkey.png"),n=(i=new Monkey(i,n)).view.getBounds();t<ns_egret.MainContext.instance.stage.stageWidth/2?i.view.x=n.width/6:(i.view.x=ns_egret.MainContext.instance.stage.stageWidth-n.width/6,i.view.scaleX=-1),i.view.y=e-n.height/2.5,i.add()},e.prototype.initAnger=function(){var t=ns_egret.MainContext.instance.stage;this.angerContainer=new AngerContainer,topContainer.addChild(this.angerContainer),this.angerContainer.y=t.stageHeight-100},e.prototype.initScore=function(){var t=utils.createBitmap("ui_score_bg.png"),e=utils.createBitmap("ui_lucheng.png");t.x=100,t.y=65,e.x=95,e.y=63,topContainer.addChild(t),topContainer.addChild(e),this.currentScoreFont=new UIFont(MyInfo.score),this.currentScoreFont.scaleX=this.currentScoreFont.scaleY=.4,this.currentScoreFont.x=t.x,this.currentScoreFont.y=t.y+15,topContainer.addChild(this.currentScoreFont),this.progress=new ns_egret.ProgressBar("ui_lucheng2.png"),this.progress.x=t.x+58,this.progress.y=t.y+20,this.progress.setProgress(0,100),topContainer.addChild(this.progress),(e=utils.createBitmap("ui_gift_1.png")).scaleX=e.scaleY=.2,e.x=t.x+55,e.y=t.y+-15,topContainer.addChild(e),(e=new UIFont(100)).scaleX=e.scaleY=.25,e.x=t.x+60,e.y=t.y+30,topContainer.addChild(e),(e=utils.createBitmap("ui_gift_2.png")).scaleX=e.scaleY=.2,e.x=t.x+115,e.y=t.y+-15,topContainer.addChild(e),(e=new UIFont(300)).scaleX=e.scaleY=.25,e.x=t.x+120,e.y=t.y+30,topContainer.addChild(e),(e=utils.createBitmap("ui_gift_3.png")).scaleX=e.scaleY=.2,e.x=t.x+240,e.y=t.y+-15,topContainer.addChild(e),(e=new UIFont(1e3,4)).scaleX=e.scaleY=.25,e.x=t.x+240,e.y=t.y+30,topContainer.addChild(e)},e.prototype.onGetAnger=function(){this.angerContainer.onGetAnger()},e.prototype.onGetBanana=function(){this.angerContainer.onGetBanana()},e.prototype.onCombo=function(){this.allCombo.onCombo()},e.prototype.resetCombo=function(){this.allCombo.resetCombo()},e.prototype.run=function(t){for(this.allCombo.addCombotime(t),this.allCombo.getComboTime()>=Const.COMBO_CANCEL_TIME&&this.allCombo.comboReset(),this._lastTime+=t;this._lastTime>1e3/60;){if(this._lastTime-=1e3/60,system.render.run(),this._isDeath)system.render.onCameraMove(-Const.CAMERA_SPEED);else if(t=Const.CAMERA_SPEED,15<(t=Const.CAMERA_SPEED+Math.floor(this.moveY/2e4))&&(t=15),app.role.isGod&&(t*=2),system.render.onCameraMove(t),this.moveY+=t,this.monsterMoveY+=10,this.addMonster(),-1!=MyInfo.guideStep){t=ns_egret.MainContext.instance.stage;var e=(e=Const.GUIDE_STOP_LIST[MyInfo.guideStep-1])-(800-t.stageHeight);this.moveY>=e&&(ns_egret.Ticker.getInstance().unregister(app.stateMachine.state.run,app.stateMachine.state),ns_egret.MainContext.instance.stage.addEventListener(ns_egret.TouchEvent.TOUCH_TAP,this.guideJump,this),this.role.mc.gotoAndStop("run"),t.addChild(this._guideUI),this._isFirstClick=!0,1==MyInfo.guideStep?this._guideUI.setText("注意！撞到屋檐会掉下来。需要点击屏幕跳跃来躲避屋檐。"):2==MyInfo.guideStep?this._guideUI.setText("猴子可是个讨厌的家伙，你可以跳过去击杀他们。"):3==MyInfo.guideStep?this._guideUI.setText("击杀飞怪可以得到勾玉，攒够足够的勾玉可以释放奥义。"):4==MyInfo.guideStep&&(this._guideUI.setText("好了，基本教学就到这里了，接下来就看你的了。"),this._isFirstClick=!1))}this._tick++,MyInfo.score>=Const.SCORE_MAX&&(Const.HAS_RANK&&MyInfo.score?(app.stateMachine.changeState(new InputState),app.stateMachine.state.onAdd()):app.stateMachine.changeState(new ResultState))}this._isDeath||MyInfo.setScore(this._tick/20),this.currentScoreFont.updateText(MyInfo.score),this.progress.setProgress(MyInfo.score,Const.SCORE_MAX)},e.prototype.guideJump=function(){var t=ns_egret.MainContext.instance.stage;this._isFirstClick?(this._isFirstClick=!1,ns_egret.MainContext.instance.stage.removeChild(this._guideUI),null==this._hand&&(this._hand=utils.createBitmap("hand.png"),this._hand.x=200,this._hand.y=t.stageHeight-270),ns_egret.Tween.get(this._hand,{loop:!0}).to({scaleX:.7,scaleY:.7},600).to({scaleX:1,scaleY:1},600),t.addChild(this._hand)):(this._hand.scaleX=this._hand.scaleY=1,ns_egret.Tween.removeTweens(this._hand),this._hand.isRunning()?t.removeChild(this._hand):this._guideUI.isRunning()&&ns_egret.MainContext.instance.stage.removeChild(this._guideUI),t.removeEventListener(ns_egret.TouchEvent.TOUCH_TAP,this.guideJump,this),MyInfo.setGuideStep(MyInfo.guideStep+1),ns_egret.Ticker.getInstance().register(this.run,this),-1!=MyInfo.guideStep?this.role.jump():this.role.mc.gotoAndPlay("run"))},e.prototype.addMonster=function(){if(1!=MyInfo.guideStep||this._guideBuildingAdded)if(3!=MyInfo.guideStep||this._guideBirdAdded){0==this.monsterMoveY%1500&&MyInfo.score>=Const.BUILDING_SCORE&&(i=new Building("roof.png"),e=i.view.getBounds(),.5>Math.random()?(i.view.scaleX=.7,i.view.scaleY=.7,i.view.x=ns_egret.MainContext.instance.stage.stageWidth-.7*e.width):(i.view.scaleX=-.7,i.view.scaleY=.7,i.view.x=.7*e.width),i.view.y=-150,i.add(),.5<Math.random()&&MyInfo.score>=Const.BUILDING_AND_MONKEY_SCORE&&this.addMonkey(i.view.x,i.view.y)),0==this.monsterMoveY%3200&&MyInfo.score>=Const.FLYING_SCORE&&(i=JSON.parse(ns_egret.ResourceLoader.create("bird.json?v=2").data),e=ns_egret.TextureCache.getInstance().getTexture("bird.png"),i=new Bird(i,e),i.view.x=-100,i.view.y=-300,i.add()),0==this.monsterMoveY%15e3&&(i=new Bubble,i.view.x=150*Math.random()+100,i.view.y=-300,i.add());var t,e=1400;300<MyInfo.score&&(e=1100-Math.floor(MyInfo.score/Const.CAMERA_SPEED)*Const.CAMERA_SPEED),0==this.monsterMoveY%e&&(t=[],MyInfo.score>=Const.VERTICAL_MONKEY_SCORE&&t.push("vertical"),MyInfo.score>=Const.SUPER_VERTICAL_MONKEY_SCORE&&t.push("super"),MyInfo.score>=Const.HORIZONTAL_MONKEY_SCORE&&t.push("horizontal"),MyInfo.score>=Const.JUMP_MONKEY_SCORE&&t.push("jumpMonster")),t&&0!=t.length&&("vertical"==(t=t[Math.floor(Math.random()*t.length)])?(i=ns_egret.ResourceLoader.create("monkeyRun.json").data,e=ns_egret.TextureCache.getInstance().getTexture("monkeyRun.png"),i=new Monster(i,e)):"super"==t?(i=ns_egret.ResourceLoader.create("monkeyRun.json").data,e=ns_egret.TextureCache.getInstance().getTexture("monkeyRun2.png"),i=new SuperMonster(i,e)):"jumpMonster"==t?(i=ns_egret.ResourceLoader.create("monkeyRun.json").data,e=ns_egret.TextureCache.getInstance().getTexture("monkeyRun.png"),i=new JumpMonster(i,e)):"horizontal"==t?(i=ns_egret.ResourceLoader.create("horizontalMonster.json").data,e=ns_egret.TextureCache.getInstance().getTexture("horizontalMonster.png"),i=new HorizontalMonster(i,e),t=new Bridge,t.view.y=-275,t.add()):"flying"==t&&(i=ns_egret.ResourceLoader.create("bird.json").data,e=ns_egret.TextureCache.getInstance().getTexture("bird.png"),i=new Bird(i,e),i.view.x=-100),i&&(i.view.y=-300,i.add()))}else this._guideBirdAdded=!0,i=JSON.parse(ns_egret.ResourceLoader.create("bird.json?v=2").data),e=ns_egret.TextureCache.getInstance().getTexture("bird.png"),i=new Bird(i,e),i.view.x=-100,i.view.y=-300,i.add();else{this._guideBuildingAdded=!0;var i,e=(i=new Building("roof.png")).view.getBounds();i.view.scaleX=-.7,i.view.scaleY=.7,i.view.x=.7*e.width,i.view.y=-150,i.add()}},e.prototype.onDeath=function(){this._isDeath=!0},e.prototype.onExit=function(){ns_egret.Ticker.getInstance().unregister(this.run,this),system.render.reset(),system.hitTest.reset(),this.role.view.visible=!1,gameContainer.removeAllChildren(),topContainer.removeAllChildren()},e}(State),LoginState=function(t){function e(){t.apply(this,arguments)}return __extends(e,t),e.prototype.onEnter=function(){var t=new LoginUI;BoxManager.getInstance().addBox(t),this.login=t},e.prototype.onExit=function(){BoxManager.getInstance().removeBox(this.login)},e}(State),InputState=function(t){function e(){t.apply(this,arguments)}return __extends(e,t),e.prototype.onEnter=function(){var t=new NameInputUI;BoxManager.getInstance().addBox(t),t.y=40+(ns_egret.MainContext.instance.stage.stageHeight-550>>1),this.input=t},e.prototype.onAdd=function(){this.input.add(MyInfo.score,MyInfo.killNumber)},e.prototype.onExit=function(){BoxManager.getInstance().removeBox(this.input)},e}(State),ResultState=function(t){function e(){t.apply(this,arguments)}return __extends(e,t),e.prototype.onEnter=function(){this.current=new FailUI,BoxManager.getInstance().addBox(this.current)},e.prototype.onExit=function(){this.current.parent&&BoxManager.getInstance().removeBox(this.current),BoxManager.getInstance().clearAllBox()},e}(State),app=new GameApp,UserInfo=function(){function t(){this.killNumber=this.bestScore=this.score=this.currentWeek=0,this.serverAddress="js/api.php",this.secret="#kjutg98@aa",this._statisticsList=[],this.guideStep=-1,null==localStorage.getItem("guide")&&(this.guideStep=1)}return t.prototype.setGuideStep=function(t){this.guideStep=t,t>Const.GUIDE_STOP_LIST.length&&(this.guideStep=-1)},t.prototype.setScore=function(t){this.score=Math.floor(t),this.score>this.bestScore&&(this.bestScore=this.score)},t.prototype.addKill=function(){this.killNumber++},t.prototype.statistics=function(t){-1==this._statisticsList.indexOf(t)&&(this._statisticsList.push(t),t="js/statistics.php?gId=ninja_up&act="+t+"&sign="+hex_md5("ninja_up"+t+this.secret),t=new ns_egret.URLRequest(t,function(){},this),ns_egret.NetContext.getInstance().send(t))},t}(),Combo=function(t){function e(){this.initCombo(),this.comboTime=this.combo=0,this.initComboProgress(),this.role=app.role}return __extends(e,t),e.prototype.initCombo=function(){this.comboContainer=new ns_egret.DisplayObjectContainer,gameContainer.addChild(this.comboContainer);var t=utils.createBitmap("lianji.png"),e=utils.createBitmap("chendi_bg.png");t.y=e.getBounds().height/4,this.comboContainer.addChild(e),this.comboContainer.addChild(t),this.combo=0,this.comboFont=new ComboFont(this.combo),this.comboContainer.addChild(this.comboFont),this.comboFont.x=2*e.getBounds().width/5,this.comboFont.y=e.getBounds().height/4,this.comboFont.scaleX=.8,this.comboFont.scaleY=.8,this.comboContainer.visible=!1,this.comboContainer.x=0,this.comboContainer.y=110},e.prototype.initComboProgress=function(){this.comboProgressContainer=new ns_egret.DisplayObjectContainer,this.comboProgressBar=new ns_egret.ProgressBar("jindutiao_2.png","jindutiao_1.png"),this.comboProgressBar.setProgress(this.combo,Const.COMBO_MAX),this.comboProgressContainer.addChild(this.comboProgressBar),gameContainer.addChild(this.comboProgressContainer),this.comboProgressContainer.y=this.comboContainer.y+3*this.comboContainer.getBounds().height/4,this.comboProgressContainer.x=-this.comboProgressContainer.getBounds().width},e.prototype.onCombo=function(){if(!this.role._isDead&&!this.role.isGod){if(this.comboTime=0,this.combo+=1,1<this.combo){var t=this.comboContainer.getBounds().width;this.comboFont.updateText(this.combo),10>this.comboFont.getValue()?this.comboFont.x=2*t/5:this.comboFont.x=t/5,this.comboContainer.visible=!0,2<this.combo&&(ns_egret.Tween.removeTweens(this.comboContainer),ns_egret.Tween.get(this.comboContainer).to({scaleX:1.2,scaleY:1.2},100).to({scaleX:1,scaleY:1},100)),ns_egret.Tween.removeTweens(this.comboProgressContainer),ns_egret.Tween.get(this.comboProgressContainer).to({x:0},300),ns_egret.Tween.removeTweens(this.comboProgressBar),ns_egret.Tween.get(this.comboProgressBar).to({percentage:100*this.combo/Const.COMBO_MAX},300)}this.combo==Const.COMBO_MAX&&(this.role.beGod(),this.combo=0,ns_egret.Tween.removeTweens(this.comboProgressBar),ns_egret.Tween.get(this.comboProgressBar).to({percentage:100},1e3))}},e.prototype.resetCombo=function(){this.comboContainer.visible=!1,this.comboProgressContainer.visible=!1,this.combo-=1},e.prototype.addCombotime=function(t){this.comboTime+=t},e.prototype.comboReset=function(){this.combo=this.comboTime=0,this.comboContainer.visible=!1,ns_egret.Tween.get(this.comboProgressContainer).to({x:-this.comboProgressContainer.getBounds().width},300),ns_egret.Tween.get(this.comboProgressBar).to({percentage:100*this.combo/Const.COMBO_MAX},300)},e.prototype.getComboTime=function(){return this.comboTime},e}(ns_egret.DisplayObjectContainer),__extends=this.__extends||function(t,e){function i(){this.constructor=t}for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n]);i.prototype=e.prototype,t.prototype=new i},GameObject=function(){function t(){}return t.prototype.run=function(){},t.prototype.create=function(){},t.prototype.getHitBounds=function(){return ns_egret.DisplayObject.getTransformBounds(this.view.getBounds(),this.view.worldTransform)},t.prototype.add=function(){system.render.add(this)},t.prototype.remove=function(){this._isDead=!0,app.stateMachine.state.onCombo()},t.prototype.onCameraMove=function(t){},t.prototype.checkAdd=function(){-200<this.view.y&&null==this.view.parent?(gameContainer.addChild(this.view),system.hitTest.addHitList(this)):null!=this.view.parent&&this.view.y>ns_egret.MainContext.instance.stage.stageHeight+200&&(this.view.visible=!1,system.hitTest.removeHitList(this))},t}(),MainRole=function(t){function e(){t.apply(this,arguments),this._vy=this._vx=0,this.canDeath=!0,this.isBack=this.godJumping=this.isGod=this.hasBuff=!1}return __extends(e,t),e.prototype.create=function(){this.container=new ns_egret.DisplayObjectContainer;var t=ns_egret.ResourceLoader.create("role2.json").data,e=ns_egret.TextureCache.getInstance().getTexture("role2.png");this.mc=new ns_egret.MovieClip(t,e),this.mc.relativeAnchorPointX=this.mc.relativeAnchorPointY=.5,this.mc.setInterval(6),this.container.addChild(this.mc),this.view=this.container,this.view.y=ns_egret.MainContext.instance.stage.stageHeight-Const.HORIZON,this.view.x=Const.WALL_WIDTH,this.changeAction("run"),ns_egret.Ticker.getInstance().callLater(this.addEvent,this)},e.prototype.addEvent=function(){ns_egret.MainContext.instance.stage.addEventListener(ns_egret.TouchEvent.TOUCH_BEGAN,this.onTouch,this)},e.prototype.onTouch=function(){this.isGod||-1!=MyInfo.guideStep||this.jump()},e.prototype.run=function(){if(!this._isDead){for(var t=system.hitTest.hitTest(this),e=0;e<t.length;e++)t[e].remove();this.move()}},e.prototype.beGod=function(){1!=this.isGod&&(this.isGod=!0,this._vx=0,ns_egret.Tween.get(this.view).to({x:Const.WALL_WIDTH},100).call(this.godJump,this))},e.prototype.beNormal=function(){this._vx=this._vy=0,this.isBack=!0,ns_egret.Tween.get(this.view).to({x:Const.WALL_WIDTH,y:ns_egret.MainContext.instance.stage.stageHeight-Const.HORIZON},1e3).call(this.lateBeNormal,this)},e.prototype.lateBeNormal=function(){this.changeAction("run"),this.isBack=this.godJumping=!1,this.view.scaleX=1,this.canDeath=this.isGod=!1,ns_egret.Ticker.getInstance().callLater(this.notbegod,this,1e3)},e.prototype.notbegod=function(){this.canDeath=!0},e.prototype.godJump=function(){this._vx=Const.JUMP_X,this.godJumping=!0,this.changeAction("jump")},e.prototype.move=function(){if(this.godJumping)this.isBack||(150>this.view.y&&this.beNormal(),this.view.x+=this._vx,this.view.x<Const.WALL_WIDTH?(this._vx=Const.JUMP_X,this._vy=0):this.view.x>ns_egret.MainContext.instance.stage.stageWidth-Const.WALL_WIDTH&&(this._vx=-Const.JUMP_X,this._vy=0),this.view.y+=this._vy,this._vy-=.1);else{this.view.x+=this._vx,this.view.x<Const.WALL_WIDTH?(this.view.x=Const.WALL_WIDTH,this._vx=0,this.view.scaleX=1,this.changeAction("run")):this.view.x>ns_egret.MainContext.instance.stage.stageWidth-Const.WALL_WIDTH&&(this.view.x=ns_egret.MainContext.instance.stage.stageWidth-Const.WALL_WIDTH,this._vx=0,this.view.scaleX=-1,this.changeAction("run"));var t;t=this.view.x<ns_egret.MainContext.instance.stage.stageWidth/2?this.view.x-Const.WALL_WIDTH:Math.abs(this.view.x-ns_egret.MainContext.instance.stage.stageWidth+Const.WALL_WIDTH),this.view.y=ns_egret.MainContext.instance.stage.stageHeight-Const.HORIZON-t/3}},e.prototype.jump=function(){this.view.x==Const.WALL_WIDTH?(this._vx=Const.JUMP_X,this.changeAction("jump")):this.view.x==ns_egret.MainContext.instance.stage.stageWidth-Const.WALL_WIDTH&&(this._vx=-Const.JUMP_X,this.changeAction("jump"))},e.prototype.stop=function(){},e.prototype.death=function(){app.stateMachine.state.resetCombo(),this.changeAction("death"),this._isDead=!0,this._vx=0;(t=ns_egret.MainContext.instance.stage).removeEventListener(ns_egret.TouchEvent.TOUCH_BEGAN,this.onTouch,this),ns_egret.Tween.get(this.view).to({x:t.stageWidth/2,y:8*t.stageHeight/10},600);var t=JSON.parse(ns_egret.ResourceLoader.create("death.json?v=2").data),e=ns_egret.TextureCache.getInstance().getTexture("death.png"),t=new ns_egret.MovieClip(t,e),e=this.view.localToGlobal();t.x=e.x,t.y=e.y,t.relativeAnchorPointX=t.relativeAnchorPointY=.5,gameContainer.addChild(t),t.gotoAndPlay("run"),t.addEventListener("playComplete",function(){this.stop(),this.parent.removeChild(this)},t),ns_egret.Ticker.getInstance().callLater(function(){Const.HAS_RANK&&MyInfo.score?(app.stateMachine.changeState(new InputState),app.stateMachine.state.onAdd()):app.stateMachine.changeState(new ResultState)},this,1500)},e.prototype.remove=function(){},e.prototype.changeAction=function(t){this._isDead||("run"==t?this.view.setContentSize(110,80):"jump"==t&&this.view.setContentSize(150,80),this.mc.gotoAndPlay(t))},e.prototype.getHitBounds=function(){return 0<this._vx?ns_egret.Rectangle.identity.initialize(this.view.worldTransform.tx-this.view._contentWidth*this.mc.relativeAnchorPointX,this.view.worldTransform.ty-this.view._contentHeight*this.mc.relativeAnchorPointY,this.view._contentWidth,this.view._contentHeight+10):ns_egret.Rectangle.identity.initialize(this.view.worldTransform.tx-this.view._contentWidth*this.mc.relativeAnchorPointX,this.view.worldTransform.ty-this.view._contentHeight*this.mc.relativeAnchorPointY,this.view._contentWidth,this.view._contentHeight)},e.prototype.addBuff=function(){this.hasBuff=!0,null==this.bubble&&(this.bubble=utils.createBitmap("bubble.png"),this.bubble.scaleX=this.bubble.scaleY=.5,this.bubble.relativeAnchorPointX=this.bubble.relativeAnchorPointY=.5),this.bubble.parent||this.container.addChild(this.bubble)},e.prototype.removeBuff=function(){this.hasBuff=!1,this.container.removeChild(this.bubble)},e}(GameObject),Bubble=function(t){function e(){var t=utils.createBitmap("bubble.png");t.scaleX=t.scaleY=.5,this.view=t}return __extends(e,GameObject),e.prototype.onCameraMove=function(t){this.view.y+=t,this.checkAdd()},e.prototype.remove=function(){system.hitTest.removeHitList(this),this.view.visible=!1,app.role.addBuff()},e}(),Background=function(t){function e(){t.apply(this,arguments)}return __extends(e,t),e.prototype.create=function(){var t=new ns_egret.DisplayObjectContainer,e=new ns_egret.DisplayObjectContainer;t.addChild(e);for(var i=-3;228>i;i++){var n=utils.createBitmap("wall.jpg"),s=n.getBounds();n.x=ns_egret.MainContext.instance.stage.stageWidth-s.width+20,n.y=-i*n.getBounds().height,e.addChild(n),(n=utils.createBitmap("wall.jpg")).x=s.width-20,n.y=-i*s.height,n.scaleX=-1,e.addChild(n)}this.view=t,this.wall=e},e.prototype.onCameraMove=function(t){this.wall.y+=2*t/5},e.prototype.run=function(){},e}(GameObject),Building=function(t){function e(t){this.view=utils.createBitmap(t)}return __extends(e,GameObject),e.prototype.onCameraMove=function(t){this.view.y+=2*t/5,this.checkAdd()},e.prototype.remove=function(){0==app.role._vx&&(system.hitTest.removeHitList(this),app.restartGame())},e.prototype.getHitBounds=function(){return 0<this.view.scaleX?ns_egret.Rectangle.identity.initialize(this.view.worldTransform.tx+40,this.view.worldTransform.ty+30,70,10):ns_egret.Rectangle.identity.initialize(this.view.worldTransform.tx-110,this.view.worldTransform.ty+30,70,10)},e}(),Monster=function(t){function e(t,i){e.addNumber++;var n=new ns_egret.MovieClip(t,i);n.gotoAndPlay("run"),n.setInterval(5),n.relativeAnchorPointY=.5,this._mc=this.view=n,-1!=MyInfo.guideStep&&1==e.addNumber?this.setLeft():.5>Math.random()?this.setRight():this.setLeft()}return __extends(e,t),e.prototype.setLeft=function(){this._mc.x=Const.WALL_WIDTH,this._mc.scaleX=.5,this._mc.scaleY=.5,this._mc.rotation=90},e.prototype.setRight=function(){this._mc.x=ns_egret.MainContext.instance.stage.stageWidth-Const.WALL_WIDTH,this._mc.scaleX=-.5,this._mc.scaleY=.5,this._mc.rotation=270},e.prototype.onCameraMove=function(t){this.view.y+=4*t/5,this.checkAdd()},e.prototype.getHitBounds=function(){return 90==this.view.rotation?ns_egret.Rectangle.identity.initialize(this.view.worldTransform.tx-60,this.view.worldTransform.ty+10,50,50):ns_egret.Rectangle.identity.initialize(this.view.worldTransform.tx,this.view.worldTransform.ty,50,50)},e.prototype.remove=function(){t.prototype.remove.call(this),system.hitTest.removeHitList(this),0!=app.role._vx?(this.view.visible=!1,MyInfo.addKill(),utils.addHitMC(this.view)):(this.view.visible=!1,app.restartGame())},e.addNumber=0,e}(GameObject),SuperMonster=function(t){function e(){t.apply(this,arguments),this._isUp=!1}return __extends(e,t),e.prototype.onCameraMove=function(t){this._isUp?this.view.y-=1.1*t:(this.view.y+=.8*t,this.view.y>ns_egret.MainContext.instance.stage.stageHeight+150&&(this._isUp=!0,this.view.scaleX*=-1)),this.checkAdd()},e}(Monster),JumpMonster=function(t){function e(e,i){t.call(this,e,i),this.vy=this.vx=0,this.jumpedOver=this.jumped=!1,this.jumpHigh=150,this.isStand=!1,this._mc.scaleX*=.8,this._mc.scaleY*=.8}return __extends(e,t),e.prototype.jump=function(){this.jumped=!0,this.vy=this.tempVy,this.view.x==Const.WALL_WIDTH?(this.vx=Const.JUMP_X,this.view.rotation=0,this._mc.gotoAndPlay("jump")):this.view.x==ns_egret.MainContext.instance.stage.stageWidth-Const.WALL_WIDTH&&(this.vx=-Const.JUMP_X,this.view.rotation=0,this._mc.gotoAndPlay("jump"))},e.prototype.stand=function(){this.isStand=!0,this.tempVy=this.vy,this.vy=0,ns_egret.Ticker.getInstance().callLater(this.jump,this,500)},e.prototype.run=function(){this.view.x+=this.vx},e.prototype.onCameraMove=function(t){this.isStand||(this.vy=2*t/3),this.view.y+=this.vy,this.checkAdd(),this.jumped&&this.jumpedOver||this.view.y>this.jumpHigh&&(this.isStand?this.jumped&&this.jumpOver():this.stand())},e.prototype.jumpOver=function(){!(this.view.x!=Const.WALL_WIDTH&&this.view.x!=ns_egret.MainContext.instance.stage.stageWidth-Const.WALL_WIDTH)&&!this.jumpedOver&&(this.vx=0,this._mc.gotoAndPlay("run"),this.view.scaleX=-this.view.scaleX,this.view.x==Const.WALL_WIDTH?(this._mc.rotation=90,this.jumpedOver=!0):this.view.x==ns_egret.MainContext.instance.stage.stageWidth-Const.WALL_WIDTH&&(this._mc.rotation=270,this.jumpedOver=!0))},e}(Monster),HorizontalMonster=function(t){function e(t,e){this.mc=new ns_egret.MovieClip(t,e),this.vx=Const.BIRD_V_X,this.mc.gotoAndPlay("run"),this.mc.setInterval(4),this.mc.relativeAnchorPointX=this.mc.relativeAnchorPointY=.5,this.mc.scaleX=.5,this.mc.scaleY=.5,this.view=this.mc}return __extends(e,t),e.prototype.run=function(){this.mc.x<=Const.WALL_WIDTH?(this.vx=Const.BIRD_V_X,this.mc.scaleX=.5):this.view.x>=ns_egret.MainContext.instance.stage.stageWidth-Const.WALL_WIDTH&&(this.vx=-Const.BIRD_V_X,this.mc.scaleX=-.5),this.mc.x+=this.vx},e.prototype.onCameraMove=function(t){this.view.y+=2*t/5,this.checkAdd()},e.prototype.remove=function(){t.prototype.remove.call(this),system.hitTest.removeHitList(this),0!=app.role._vx?(MyInfo.addKill(),this.view.visible=!1,utils.addHitMC(this.view)):(this.view.visible=!1,app.restartGame())},e}(GameObject),Bridge=function(t){function e(){var t=new ns_egret.DisplayObjectContainer,e=utils.createBitmap("qiao.png");e.x=47,e.scaleX=.9,t.addChild(e),(e=utils.createBitmap("qiao.png")).x=ns_egret.MainContext.instance.stage.stageWidth-47,e.scaleX=-.9,t.addChild(e),this.view=t}return __extends(e,GameObject),e.prototype.checkAdd=function(){-200<this.view.y&&null==this.view.parent?gameContainer.addChild(this.view):null!=this.view.parent&&this.view.y>ns_egret.MainContext.instance.stage.stageHeight+200&&(this.view.visible=!1)},e.prototype.onCameraMove=function(t){this.view.y+=2*t/5,this.checkAdd()},e}(),Bird=function(t){function e(t,e){var i=new ns_egret.MovieClip(t,e);this._tick=this.speed=this.vx=0,this._isAppear=!1,i.gotoAndPlay("run"),i.setInterval(6),i.relativeAnchorPointX=i.relativeAnchorPointY=.5,this.view=i}return __extends(e,t),e.prototype.run=function(){!this._isAppear&&!app.stateMachine.state._isDeath&&(3==MyInfo.guideStep||app.role.view.x<ns_egret.MainContext.instance.stage.stageWidth/2?(this._isAppear=!0,this.view.x=ns_egret.MainContext.instance.stage.stageWidth-30,this.view.scaleX*=-1):app.role.view.x>ns_egret.MainContext.instance.stage.stageWidth/2&&(this._isAppear=!0,this.view.x=20)),0==this.vx&&this._isAppear&&(this._tick++,this.view.y=50,90<this._tick&&(this.vx=this.view.x>ns_egret.MainContext.instance.stage.stageWidth/2?.8*-this.speed/1.15:.8*this.speed/1.15)),this.view.x+=this.vx},e.prototype.onCameraMove=function(t){this.speed=t,this.view.y+=t,this.checkAdd()},e.prototype.remove=function(){t.prototype.remove.call(this),system.hitTest.removeHitList(this),0!=app.role._vx?(MyInfo.addKill(),this.view.visible=!1,app.stateMachine.state.onGetAnger(),utils.addHitMC(this.view)):(this.view.visible=!1,app.restartGame())},e}(GameObject),Banana=function(t){function e(t,e){var i=new ns_egret.MovieClip(t,e);this.vx=0,this.vy=1,this.speed=Const.BIRD_V_X,i.gotoAndPlay("banana"),i.setInterval(6),i.scaleX=i.scaleY=2,this.view=i}return __extends(e,t),e.prototype.run=function(){this.view.x+=this.vx},e.prototype.onCameraMove=function(t){this.view.y+=t/this.vy,this.checkAdd()},e.prototype.remove=function(){t.prototype.remove.call(this),system.hitTest.removeHitList(this),0!=app.role._vx?(MyInfo.addKill(),this.view.visible=!1,app.stateMachine.state.onGetBanana(),utils.addHitMC(this.view)):this.view.x>Const.WALL_WIDTH&&this.view.x<ns_egret.MainContext.instance.stage.stageWidth-Const.WALL_WIDTH&&(this.view.visible=!1,app.restartGame())},e.prototype.setVy=function(t){void 0===t&&(t=2),this.vy=t},e.prototype.setVx=function(){this.vx=this.view.x<ns_egret.MainContext.instance.stage.stageWidth/2?this.speed:-this.speed},e}(GameObject),Monkey=function(t){function e(t,e){this.mc=new ns_egret.MovieClip(t,e),this.delay=0,this.data=t,this.texture=e,this.mc.gotoAndPlay("stand"),this.mc.setInterval(3),this.view=this.mc,this.delayValue=Math.round(4*Math.random())+1}return __extends(e,t),e.prototype.run=function(){var t=ns_egret.MainContext.instance.stage;!this._isDead&&this.view.y>=t.stageHeight-700&&(this.delay++,this.delay==this.delayValue&&(this.mc.gotoAndPlay("attack"),this.mc.addEventListener("attackComplete",this.attackComplete,this),this.mc.addEventListener("startAttack",this.startAttack,this)))},e.prototype.attackComplete=function(){this.mc.gotoAndPlay("stand"),this.mc.removeEventListener("attackComplete",this.attackComplete,this)},e.prototype.startAttack=function(){this.throw(2),this.mc.removeEventListener("startAttack",this.attackComplete,this),300<MyInfo.score&&.5<Math.random()&&ns_egret.Ticker.getInstance().callLater(function(){this.throw(1.5)},this,100)},e.prototype.onCameraMove=function(t){this.view.y+=2*t/5,this.checkAdd()},e.prototype.remove=function(){t.prototype.remove.call(this),system.hitTest.removeHitList(this),0!=app.role._vx?(MyInfo.addKill(),this.view.visible=!1,utils.addHitMC(this.view)):(this.view.visible=!1,app.restartGame())},e.prototype.throw=function(t){var e=new Banana(this.data,this.texture);e.view.x=this.view.x,e.view.y=this.view.y,e.add(),e.setVx(),e.setVy(t)},e}(GameObject),RenderSystem=function(){function t(){this._list=[]}return t.prototype.add=function(t){this._list.push(t)},t.prototype.onCameraMove=function(t){for(var e in this._list)this._list[e].onCameraMove(t)},t.prototype.run=function(){for(var t in this._list){var e=this._list[t];e&&e.run()}},t.prototype.remove=function(t){0<=(t=this._list.indexOf(t))&&this._list.splice(t,1)},t.prototype.reset=function(){this._list=[]},t}(),HitTestSystem=function(){function t(){this.hitTestResultArray=[],this._hitList=[]}return t.prototype.addHitList=function(t){this._hitList.push(t)},t.prototype.removeHitList=function(t){0<=(t=this._hitList.indexOf(t))&&this._hitList.splice(t,1)},t.prototype.hitTest=function(t){this.hitTestResultArray.length=0;t=(s=t.getHitBounds()).x+0;var e,i=s.y+0,n=s.width+0,s=s.height+0;for(e in this._hitList){var r=this._hitList[e],o=(u=r.getHitBounds()).x+0,a=u.y+0,h=u.width+0,u=u.height+0;this.containPoint(o,a,h,u,t,i)||this.containPoint(o,a,h,u,t+n,i)||this.containPoint(o,a,h,u,t,i+s)||this.containPoint(o,a,h,u,t+n,i+s)?this.hitTestResultArray.push(r):(this.containPoint(t,i,n,s,o,a)||this.containPoint(t,i,n,s,o+h,a)||this.containPoint(t,i,n,s,o,a+u)||this.containPoint(t,i,n,s,o+h,a+u))&&this.hitTestResultArray.push(r)}return this.hitTestResultArray},t.prototype.containPoint=function(t,e,i,n,s,r){return t<=s&&t+i>=s&&e<=r&&e+n>=r},t.prototype.reset=function(){this._hitList=[]},t}(),system={render:new RenderSystem,hitTest:new HitTestSystem},__extends=this.__extends||function(t,e){function i(){this.constructor=t}for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n]);i.prototype=e.prototype,t.prototype=new i},BoxManager=function(){function t(){this._list=[],this.container=gameContainer}return t.getInstance=function(){return null==t._instance&&(t._instance=new t),t._instance},t.prototype.addBox=function(t){t.x+=10,this.container.addChild(t),this._list.push(t),t.onEnter()},t.prototype.removeBox=function(t){var e=this._list.indexOf(t);e&&this._list.splice(e,1),this.container.removeChild(t),t.onExit()},t.prototype.clearAllBox=function(){this.container.removeAllChildren()},t}(),UIBase=function(t){function e(){t.call(this),this.createView()}return __extends(e,t),e.prototype.createView=function(){},e.prototype.onEnter=function(){},e.prototype.onExit=function(){},e}(ns_egret.DisplayObjectContainer),NameInputUI=function(t){function e(){t.apply(this,arguments)}return __extends(e,t),e.prototype.createView=function(){this.textField=new ns_egret.TextField;var t=utils.createBitmap("ui_tanchuang_1.png");this.addChild(t),this.width=t.getBounds().width,this.height=t.getBounds().height;var e=utils.createBitmap("ui_title_1.png");for(e.relativeAnchorPointX=.5,e.relativeAnchorPointY=.5,e.x=t.getBounds().width/2,e.y=-20,this.addChild(e),(e=utils.createBitmap("ui_title_success.png")).relativeAnchorPointX=.5,e.relativeAnchorPointY=.5,e.x=t.getBounds().width/2,e.y=-25,this.addChild(e),e=0;3>e;e++){var i=utils.createBitmap("ui_chendi_1.png");this.addChild(i),i.relativeAnchorPointX=.5,i.scaleX=.8,i.scaleY=.8,i.x=this.width/2,i.y=64*e+20}(e=utils.createBitmap("nin.png")).relativeAnchorPointX=.5,e.relativeAnchorPointY=.5,e.x=t.getBounds().width/2-120,e.y=this.height-253,this.addChild(e),(i=utils.createBitmap("dewanjia.png")).relativeAnchorPointX=.5,i.relativeAnchorPointY=.5,i.x=t.getBounds().width/2+140,i.y=e.y,this.addChild(i),(i=utils.createBitmap("gong.png")).relativeAnchorPointX=.5,i.relativeAnchorPointY=.5,i.x=t.getBounds().width/2-100,i.y=50,this.addChild(i),(i=utils.createBitmap("mi_2.png")).relativeAnchorPointX=.5,i.relativeAnchorPointY=.5,i.x=t.getBounds().width/2+82,i.y=50,this.addChild(i),(i=utils.createBitmap("jisha.png")).relativeAnchorPointX=.5,i.relativeAnchorPointY=.5,i.x=t.getBounds().width/2-100,i.y=114,this.addChild(i),(i=utils.createBitmap("zhiguai.png")).relativeAnchorPointX=.5,i.relativeAnchorPointY=.5,i.x=t.getBounds().width/2+100,i.y=114,this.addChild(i),(i=utils.createBitmap("zongji.png")).relativeAnchorPointX=.5,i.relativeAnchorPointY=.5,i.x=t.getBounds().width/2-100,i.y=178,this.addChild(i),(i=utils.createBitmap("fen.png")).relativeAnchorPointX=.5,i.relativeAnchorPointY=.5,i.x=t.getBounds().width/2+82,i.y=178,this.addChild(i)},e.prototype.onTouchBegan=function(){i=window.localStorage.getItem("best_"+MyInfo.currentWeek);if(i&&parseInt(i)>this.score)app.stateMachine.changeState(new ResultState);else{var t=window.localStorage.getItem("userId"),e=this.textInput.getText();if(t||(t=ns_egret.Ticker.now()+""+Math.floor(1e5*Math.random())),""==e)this.textField.text="名字不能为空";else if(10<e.length)this.textField.text="您起的名字超过限制了";else{var i,n={};(i={mod:"Top",do:"set"}).p=n,n.name=e,n.uId=t,n.num=this.score,i=JSON.stringify(i),i=new ns_egret.URLRequest(MyInfo.serverAddress+"?data="+i+"&s="+hex_md5(i+MyInfo.secret),function(i){0==(i=JSON.parse(i.responseText)).s?(window.localStorage.getItem("userId")||(window.localStorage.setItem("userId",t),window.localStorage.setItem("userName",e)),window.localStorage.setItem("best_"+MyInfo.currentWeek,this.score),app.stateMachine.changeState(new ResultState)):1==i.s?this.textField.text="您起的名字超过限制了":3==i.s?this.textField.text="名字已经被使用，请重新起名":2==i.s&&(this.textField.text="您的名字有非法字符")},this),ns_egret.NetContext.getInstance().send(i)}}},e.prototype.add=function(t,e){void 0===t&&(t=0),void 0===e&&(e=0),this.score=t+e;var i=utils.createBitmap("ui_tanchuang_1.png");if(9999999>MyInfo.score)i=utils.createBitmap("ui_word_zaipao.png"),i.x=35,i.y=320,i.relativeAnchorPointY=.5,i=utils.createBitmap("ui_word_mi.png"),i.relativeAnchorPointY=.5,i.x=225,i.y=320,i=new UIFont(MyInfo.score<Const.SLIVER_GIFT?Const.SLIVER_GIFT-MyInfo.score:Const.GOLD_GIFT-MyInfo.score),i.scaleX=i.scaleY=.7,i.relativeAnchorPointY=.5,i.x=115,i.y=315,100>MyInfo.score?i=utils.createBitmap("ui_word_get_award_2.png"):(i=utils.createBitmap("ui_word_get_award.png"),i.scaleX=i.scaleY=.9),i.relativeAnchorPointY=.5,i.x=35,i.y=365,i=utils.createBitmap("ui_return_1.png"),this.addChild(i),i.touchEnabled=!0,i.y=400,i.x=35,i.addEventListener(ns_egret.TouchEvent.TOUCH_BEGAN,function(){app.stateMachine.changeState(new LoginState)},this),(i=utils.createBitmap("ui_award_1.png")).addEventListener(ns_egret.TouchEvent.TOUCH_BEGAN,function(){EgretShare.share()},this),i.touchEnabled=!0,this.addChild(i),i.y=400,i.x=235;else{var n=utils.createBitmap("ui_award_1.png");this.addChild(n),n.relativeAnchorPointX=n.relativeAnchorPointY=.5,n.addEventListener(ns_egret.TouchEvent.TOUCH_BEGAN,this.onTouchBegan,this),n.x=i.getBounds().width/2,n.y=this.height-65,n.touchEnabled=!0,this.button=n;var s=window.localStorage.getItem("best_"+MyInfo.currentWeek);if(s&&parseInt(s)>this.score){var r=utils.createBitmap("ui_ninbenzhou.png");r.relativeAnchorPointX=.5,r.relativeAnchorPointY=.5,r.x=i.getBounds().width/2-65,r.y=n.y-140,this.addChild(r),(s=new UIFont(s,4)).relativeAnchorPointY=.5,s.x=i.getBounds().width/2-200,s.y=n.y-90,this.addChild(s),(n=utils.createBitmap("fen.png")).relativeAnchorPointX=.5,n.relativeAnchorPointY=.5,n.x=i.getBounds().width/2,n.y=s.y,this.addChild(n)}else{(s=utils.createBitmap("ui_chendi_1.png")).scaleX=.7,s.scaleY=.7,this.addChild(s),s.relativeAnchorPointX=.5,s.x=this.width/2,s.y=n.y-100,(n=utils.createBitmap("qingliuaia.png")).relativeAnchorPointX=.5,n.relativeAnchorPointY=.5,n.x=i.getBounds().width/2,n.y=s.y-30,this.addChild(n);var o=window.localStorage.getItem("userName");this.textInput=new ns_egret.TextInput,this.textInput.x=180,this.textInput.y=365,ns_egret.Ticker.getInstance().callLater(function(){this.addChild(this.textInput),this.textInput.setText(o||"忍者"+Math.floor(1e5*Math.random()))},this)}this.textField.relativeAnchorPointX=.5,this.textField.y=510,this.textField.x=i.getBounds().width/2,this.textField.size=20,this.addChild(this.textField)}(i=new UIFont(t,4)).scaleX=i.scaleY=.6,i.relativeAnchorPointX=.5,i.x=this.width/2,i.y=30,this.addChild(i),(i=new UIFont(e)).scaleX=i.scaleY=.6,i.relativeAnchorPointX=.5,i.x=this.width/2,i.y=94,this.addChild(i),(i=1e3>e+t?new UIFont(e+t):new UIFont(e+t,4)).scaleX=i.scaleY=.6,i.relativeAnchorPointX=.5,i.x=this.width/2,i.y=158,this.addChild(i),(i=new UIFont(this.getScore(e+t),2)).scaleX=i.scaleY=1,i.relativeAnchorPointX=.5,i.x=this.width/2-3,i.y=220,this.addChild(i),(i=utils.createBitmap("cent.png")).relativeAnchorPointX=.5,i.x=this.width/2+60,i.y=235,this.addChild(i)},e.prototype.getScore=function(t){return t=Math.log(18*t),99<(t*=t)&&(t=99),Math.round(t)},e.prototype.onExit=function(){this.removeEventListener(ns_egret.TouchEvent.TOUCH_BEGAN,this.onTouchBegan,this)},e}(UIBase),LoginUI=function(t){function e(){t.call(this)}return __extends(e,t),e.prototype.createView=function(){e=utils.createBitmap("ui_logo.png");this.addChild(e);var t;(t=Const.HAS_RANK?utils.createBitmap("mingren.png"):utils.createBitmap("ui_mingren.png")).scaleX=.8,t.scaleY=.8,t.x=Const.HAS_RANK?-80:55,this.addChild(t);var e,i=(e=ns_egret.MainContext.instance.stage).stageHeight-t.getBounds().height+190;Const.HAS_RANK&&(i=e.stageHeight-t.getBounds().height+150),t.y=e.stageHeight+100,ns_egret.Tween.get(t).to({y:i},800,ns_egret.Ease.backOut).call(function(){ns_egret.Tween.get(n).to({alpha:1,scaleX:.7,scaleY:.7},300),n.touchEnabled=!0});var n=utils.createBitmap("ui_chuzhan_1.png");this.addChild(n),n.alpha=0,n.scaleX=n.scaleY=0,n.relativeAnchorPointX=n.relativeAnchorPointY=.5,n.x=Const.HAS_RANK?e.stageWidth/2+80:e.stageWidth/2,n.y=e.stageHeight-80,n.addEventListener(ns_egret.TouchEvent.TOUCH_BEGAN,this.onTouchBegan,this),this.button=n,t=utils.createBitmap("ui_egretLogo.png"),this.addChild(t),Const.HAS_RANK&&(this.rank=new Rank,this.rank.scaleX=this.rank.scaleY=.7,this.rank.relativeAnchorPointX=.5,this.rank.x=this.button.x,this.rank.y=this.button.y-this.rank.getBounds().height*this.rank.scaleX,this.addChild(this.rank)),t.scaleX=.5,t.scaleY=.5,t.y=e.stageHeight-t.getBounds().height/2,t.x=e.stageWidth/2-t.getBounds().width/4},e.prototype.onTouchBegan=function(){MyInfo.statistics("gameStart"),app.stateMachine.changeState(new GameState)},e.prototype.onExit=function(){this.removeEventListener(ns_egret.TouchEvent.TOUCH_BEGAN,this.onTouchBegan,this)},e}(UIBase),Rank=function(t){function e(){t.call(this),this.number_max=6,this.currentNumber=0,this.scroll=new ns_egret.ScrollView,this.rankContainer=new ns_egret.DisplayObjectContainer;var e=utils.createBitmap("ui_tanchuang_1.png");this.addChild(e),this.soloHeight=e.getBounds().height/this.number_max;var i=utils.createBitmap("ui_title_1.png");i.relativeAnchorPointX=.5,i.relativeAnchorPointY=.5,i.x=e.getBounds().width/2,i.y=-20,this.addChild(i),(i=utils.createBitmap("paihang.png")).relativeAnchorPointX=.5,i.relativeAnchorPointY=.5,i.x=e.getBounds().width/2,i.y=-25,this.addChild(i),this.width=e.getBounds().width,this.height=e.getBounds().height,this.initRankContainer(),this.setRank()}return __extends(e,t),e.prototype.setRank=function(){var t={mod:"Top",do:"getList"},t=JSON.stringify(t),t=new ns_egret.URLRequest(MyInfo.serverAddress+"?data="+t+"&s="+hex_md5(t+MyInfo.secret),function(t){if(0==(t=JSON.parse(t.responseText)).s){MyInfo.currentWeek=t.w,console.log(MyInfo.currentWeek);for(var e=t.l,i=0;i<t.l.length&&10>i;i++){var n=e[i];this.addValue(n.name,n.num)}}},this);ns_egret.NetContext.getInstance().send(t)},e.prototype.addValue=function(t,e){void 0===t&&(t="unname"),void 0===e&&(e=0);var i=this.currentNumber,n=utils.createBitmap("ui_chendi_1.png");this.rankContainer.addChild(n),n.relativeAnchorPointX=.5,n.x=this.width/2,n.y=80*i;var s=new ComboFont(i+1),r=new UIFont(Math.round(e),4);s.x=50,s.y=80*i+15,s.scaleX=s.scaleY=.7,r.x=290,r.y=s.y,r.scaleX=r.scaleY=.7,this.rankContainer.addChild(s),this.rankContainer.addChild(r),(i=new ns_egret.TextField).text=t,i.stroke=2,i.x=118,i.y=s.y+5,i.size=28,i.textColor="#FFFFFF",this.rankContainer.addChild(i),n=n.getBounds().height,this.currentNumber++,this.scroll.setContainer(this.rankContainer,this.width,this.currentNumber*n)},e.prototype.initRankContainer=function(){this.addChild(this.scroll),this.scroll.x=0,this.scroll.y=20,this.scroll.setContentSize(this.width,this.height-40),this.scroll.direction=ns_egret.Direction.VERTICAL,this.scroll.setContainer(this.rankContainer,this.width,120)},e}(ns_egret.DisplayObjectContainer),FailUI=function(t){function e(){t.apply(this,arguments)}return __extends(e,t),e.prototype.createView=function(){var t=new UIBackground("ui_title_fail.png");this.addChild(t);var e=ns_egret.MainContext.instance.stage;this.relativeAnchorPointX=this.relativeAnchorPointY=.5,this.x=e.stageWidth/2,this.y=e.stageHeight/2,t=utils.createBitmap("ui_chendi_1.png"),this.addChild(t),t.relativeAnchorPointX=.5,t.x=e.stageWidth/2,t.y=140,t=utils.createBitmap("ui_chendi_1.png"),this.addChild(t),t.relativeAnchorPointX=.5,t.x=e.stageWidth/2,t.y=240,e=utils.createBitmap("ui_font_score.png"),this.addChild(e),e.x=t.x-t.getBounds().width/2+20,e.y=145,e=utils.createBitmap("ui_font_best.png"),this.addChild(e),e.x=t.x-t.getBounds().width/2+20,e.y=245,e=new UIFont(MyInfo.score),this.addChild(e),e.y=145,e.x=t.x+20,e=new UIFont(MyInfo.bestScore),this.addChild(e),e.y=245,e.x=t.x+20,(t=utils.createBitmap("ui_word_zaipao.png")).x=20,t.y=350,t.relativeAnchorPointY=.5,(t=utils.createBitmap("ui_word_mi.png")).relativeAnchorPointY=.5,t.x=230,t.y=350,t=new UIFont(Const.SLIVER_GIFT-MyInfo.score),t=utils.createBitmap("ui_word_get_award.png"),this.addChild(t),t.relativeAnchorPointY=.5,t.x=20,t.y=400,t=utils.createBitmap("ui_return_1.png"),this.addChild(t),t.touchEnabled=!0,t.y=440,t.x=30,t.addEventListener(ns_egret.TouchEvent.TOUCH_BEGAN,function(){app.stateMachine.changeState(new LoginState)},this),(t=utils.createBitmap("ui_reset_1.png")).addEventListener(ns_egret.TouchEvent.TOUCH_BEGAN,function(){app.stateMachine.changeState(new GameState)},this),t.touchEnabled=!0,this.addChild(t),t.y=440,t.x=230,utils.scaleDialog(this)},e}(UIBase),WinUI=function(t){function e(){t.apply(this,arguments)}return __extends(e,t),e.prototype.createView=function(){var t=new ns_egret.URLRequest("",function(t){(t=JSON.parse(t.responseText)).result&&t.result.card_id?(t=t.result.card_id,MyInfo.statistics("getGift"),t=new GetAwardUI(t),BoxManager.getInstance().removeBox(this),BoxManager.getInstance().addBox(t)):alert(t.error.message+",请稍后再试")},this);ns_egret.NetContext.getInstance().send(t)},e.prototype.getGift=function(){var t=new ns_egret.URLRequest("",function(t){(t=JSON.parse(t.responseText)).result&&t.result.card_id?(t=new GetAwardUI(t.result.card_id),BoxManager.getInstance().removeBox(this),BoxManager.getInstance().addBox(t)):alert(t.error.message+",请稍后再试")},this);ns_egret.NetContext.getInstance().send(t)},e}(UIBase),UIBackground=function(t){function e(e){t.call(this);var i=utils.createBitmap("ui_tanchuang_1.png");this.addChild(i),i.y=65;var n=utils.createBitmap("ui_title_1.png");this.addChild(n),n.relativeAnchorPointX=.5,n.x=i.getBounds().width/2,e=utils.createBitmap(e),this.addChild(e),e.relativeAnchorPointX=.5,e.x=i.getBounds().width/2}return __extends(e,t),e}(ns_egret.DisplayObjectContainer),LoadingUI=function(){function t(){}return t.prototype.addToStage=function(){this.container=new ns_egret.DisplayObjectContainer,this.textField=new ns_egret.TextField,ns_egret.MainContext.instance.stage.addChild(this.container),this.container.addChild(this.textField),this.textField.x=120,this.textField.y=300,this.textField.setContentSize(480,100),this.textField.align="middle"},t.prototype.removeFromStage=function(){this.container.parent.removeChild(this.container)},t.prototype.onProgress=function(t,e){this.textField.text="游戏加载中..."+Math.floor(t/e*100)+"%"},t}(),GetAwardUI=function(t){function e(e){this.codeName=e,t.call(this)}return __extends(e,t),e.prototype.createView=function(){var t=new UIBackground("ui_title_success.png");this.addChild(t);var e=ns_egret.MainContext.instance.stage;this.relativeAnchorPointX=this.relativeAnchorPointY=.5,this.x=e.stageWidth/2,this.y=e.stageHeight/2,t=utils.createBitmap("ui_word_get_award.png"),this.addChild(t),t.x=e.stageWidth/2,t.relativeAnchorPointX=.5,t.y=85,t=utils.createBitmap("ui_chendi_1.png"),this.addChild(t),t.relativeAnchorPointX=.5,t.x=e.stageWidth/2,t.y=360,(t=new ns_egret.TextField).text=this.codeName,this.addChild(t),t.setContentSize(480,100),t.textAlign="center",t.size=48,t.y=365,t=utils.createGift(),this.addChild(t),t.touchEnabled=!0,t.x=240,t.relativeAnchorPointX=.5,t.y=130,t=utils.createBitmap("ui_notice_codename.png"),this.addChild(t),t.relativeAnchorPointX=.5,t.x=e.stageWidth/2,t.y=310,e=utils.createBitmap("ui_return_1.png"),this.addChild(e),e.touchEnabled=!0,e.y=450,e.x=30,e.addEventListener(ns_egret.TouchEvent.TOUCH_BEGAN,function(){app.stateMachine.changeState(new LoginState)},this),(e=utils.createBitmap("button-qianwangduihuan-1.png")).addEventListener(ns_egret.TouchEvent.TOUCH_BEGAN,function(){MyInfo.statistics("goTargetGame")},this),e.touchEnabled=!0,this.addChild(e),e.y=450,e.x=230,utils.scaleDialog(this)},e}(UIBase),GuideUI=function(t){function e(){t.call(this),this.createView()}return __extends(e,t),e.prototype.createView=function(){var t=utils.createBitmap("zilaiye.png");t.x=90,t.y=-280,this.addChild(t),t=utils.createBitmap("duihua-1.png"),this.addChild(t),(t=utils.createBitmap("duihua-3.png")).x=415,t.y=90,this.addChild(t),ns_egret.Tween.get(t,{loop:!0}).to({y:85},600).to({y:90},600),(t=utils.createBitmap("duihua-2.png")).x=415,t.y=110,this.addChild(t),this.txt=new ns_egret.TextField,this.txt.x=240,this.txt.y=65,this.txt.size=20,this.txt.text="点击",this.txt.setContentSize(400,0),this.txt.textColor="#23100b",this.txt.relativeAnchorPointX=this.txt.relativeAnchorPointY=.5,this.addChild(this.txt)},e.prototype.setText=function(t){this.txt.text=t},e}(ns_egret.DisplayObjectContainer),UIFont=function(t){function e(e,i){void 0===i&&(i=3),t.call(this),this._list=[],this.length=i;var n=ns_egret.ResourceLoader.create("number.json").data;for(this.spriteSheet=new ns_egret.SpriteSheet(n),this.texture=ns_egret.TextureCache.getInstance().getTexture("number.png"),n=0;n<i;n++){var s=new ns_egret.Bitmap;this._list.push(s),this.addChild(s),s.x=40*n}this.updateText(e)}return __extends(e,t),e.prototype.updateText=function(t){for(1e4<=t&&(t=9999),t=t.toString();t.length<this.length;)t="0"+t;for(var e=0;e<this.length;e++){var i=this._list[e],n=t[e];i.texture=this.texture,i.spriteFrame=this.spriteSheet.getFrame(n+".png")}},e}(ns_egret.DisplayObjectContainer),ComboFont=function(t){function e(e){t.call(this),this._list=[];var i=ns_egret.ResourceLoader.create("combo_number.json").data;for(this.spriteSheet=new ns_egret.SpriteSheet(i),this.texture=ns_egret.TextureCache.getInstance().getTexture("combo_number.png"),i=0;3>i;i++){var n=new ns_egret.Bitmap;this._list.push(n),this.addChild(n),n.x=40*i}this.updateText(e)}return __extends(e,t),e.prototype.updateText=function(t){this.value=t,1e3<=t&&(t=999),t=t.toString();for(var e=0;3>e;e++){var i=this._list[e];if(e<t.length){i.visible=!0;var n=t[e];i.texture=this.texture,i.spriteFrame=this.spriteSheet.getFrame(n+".png")}else i.visible=!1}},e.prototype.getValue=function(){return this.value},e}(ns_egret.DisplayObjectContainer),AngerContainer=function(t){function e(){t.call(this),this.anger=0,this.isBanana=!1,this.angerList=[];for(var e=1;3>=e;e++){var i=utils.createBitmap("ui_anger_bg.png");i.x=60*e,this.addChild(i)}}return __extends(e,t),e.prototype.onGetAnger=function(){if(this.isBanana&&this.maxAngerOver(),this.isBanana=!1,this.anger++,3>=this.anger){(t=utils.createBitmap("anger.png")).x=60*this.anger+5,this.addChild(t),this.angerList.push(t)}if(3==this.anger){this.anger=0;var t=ns_egret.ResourceLoader.create("maxAnger.json").data,e=ns_egret.TextureCache.getInstance().getTexture("maxAnger.png");this.maxAngerMC=new ns_egret.MovieClip(t,e),this.maxAngerMC.gotoAndPlay("run"),t=this.maxAngerMC.getBounds(),this.maxAngerMC.x=ns_egret.MainContext.instance.stage.stageWidth-t.width>>1,this.addChild(this.maxAngerMC),this.maxAngerMC.y=ns_egret.MainContext.instance.stage.stageHeight-this.y,this.maxAnger=!0,t=-300-this.y,ns_egret.Tween.get(this.maxAngerMC).to({y:t},1200).call(this.maxAngerOver,this),ns_egret.Ticker.getInstance().register(this.update,this)}},e.prototype.onGetBanana=function(){if(this.isBanana||this.maxAngerOver(),this.isBanana=!0,this.anger++,3>=this.anger){(t=utils.createBitmap("bananaAnger.png")).x=60*this.anger+5,this.addChild(t),this.angerList.push(t)}if(3==this.anger){this.anger=0;var t=ns_egret.ResourceLoader.create("maxAnger.json").data,e=ns_egret.TextureCache.getInstance().getTexture("maxAnger.png");this.maxAngerMC=new ns_egret.MovieClip(t,e),this.maxAngerMC.gotoAndPlay("run"),t=this.maxAngerMC.getBounds(),this.maxAngerMC.x=ns_egret.MainContext.instance.stage.stageWidth-t.width>>1,this.addChild(this.maxAngerMC),this.maxAngerMC.y=ns_egret.MainContext.instance.stage.stageHeight-this.y,this.maxAnger=!0,t=-300-this.y,ns_egret.Tween.get(this.maxAngerMC).to({y:t},1200).call(this.maxAngerOver,this),ns_egret.Ticker.getInstance().register(this.update,this)}},e.prototype.update=function(){if(this.maxAnger)for(var t=system.hitTest._hitList,e=t.length,i=0;i<e;i++){var n=t[i];n.view.y>this.maxAngerMC.y&&(system.hitTest.removeHitList(n),system.render.remove(n),n.view.visible=!1,i--,e--)}},e.prototype.maxAngerOver=function(){for(var t in this.angerList)this.angerList[t].removeFromParent();this.angerList.length=0,this.maxAnger=!1,ns_egret.Ticker.getInstance().unregister(this.update,this),null==this.maxAngerMC?this.anger=0:(this.maxAngerMC.parent.removeChild(this.maxAngerMC),this.maxAngerMC=null)},e}(ns_egret.DisplayObjectContainer),hexcase=0,b64pad="";