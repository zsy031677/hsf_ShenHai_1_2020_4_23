function CBall(e){var t,a,c,i,r,_,s,n=!1,o=INIT_BALLMASS_NORMAL,A=0,L=0,l=FRICTION_NORMAL,S=EDGEFRICTION_NORMAL,E=ROTATIONSPEED_NORMAL,g=HORIZ_KICKFORCE_NORMAL,I=VERT_KICKFORCE_NORMAL,C=RESTITUTION_KICKFORCE_NORMAL,O=new CVector2(0,INIT_GRAVITY_NORMAL);this._init=function(e){var n="ball_"+Math.floor(3*Math.random()+1);(i=new createjs.Bitmap(s_oSpriteLibrary.getSprite(n))).regX=BALL_SIZE/2,i.regY=BALL_SIZE/2,i.x=CANVAS_WIDTH/2,i.y=CANVAS_HEIGHT/2,(r=new createjs.Bitmap(s_oSpriteLibrary.getSprite("shadow"))).regX=SHADOW_WIDTH/2,r.regY=SHADOW_HEIGHT/2,r.x=i.x,r.y=CANVAS_HEIGHT-BALL_BOUNCE_YOFFSET,r.alpha=.65,(_=new createjs.Bitmap(s_oSpriteLibrary.getSprite("ball_hit"))).regX=BALL_SIZE/2,_.regY=BALL_SIZE/2,_.x=CANVAS_WIDTH/2,_.y=CANVAS_HEIGHT/2,_.alpha=0,s_oStage.addChild(r),s_oStage.addChild(i),s_oStage.addChild(_),i.on("mousedown",this.clicked,this),t=new CVector2(i.x,i.y),a=new CVector2(0,0),c=new CVector2(0,0),s=e},this.unload=function(){s_oStage.removeChild(i,r,_),i=void 0},this.update=function(){c.addV(O),this._friction(),a.addV(c),t.addV(a),c._init(0,0),i.x=t.getX(),i.y=t.getY(),L=a.getX(),A+=L,i.rotation=A*E,r.x=i.x,r.scaleX=r.scaleY=i.y/(CANVAS_HEIGHT-BALL_SIZE/2-BALL_BOUNCE_YOFFSET),r.alpha=i.y/(CANVAS_HEIGHT-BALL_SIZE/2-BALL_BOUNCE_YOFFSET),_.x=i.x,_.y=i.y,_.rotation=A*E},this.checkEdges=function(){if(t.getX()<BALL_SIZE/2?(t.set(BALL_SIZE/2,t.getY()),a.set(-(1-S)*a.getX(),a.getY())):t.getX()>CANVAS_WIDTH-BALL_SIZE/2&&(t.set(CANVAS_WIDTH-BALL_SIZE/2,t.getY()),a.set(-(1-S)*a.getX(),a.getY())),t.getY()>CANVAS_HEIGHT-BALL_SIZE/2-BALL_BOUNCE_YOFFSET)return t.set(t.getX(),CANVAS_HEIGHT-BALL_SIZE/2-BALL_BOUNCE_YOFFSET),a.set(a.getX(),-(1-S)*a.getY()),!0},this.applyForce=function(e){var t=new CVector2(e.getX(),e.getY());t.scalarDivision(o),c.addV(t)},this.clicked=function(e){!1!==DISABLE_SOUND_MOBILE&&!1!==s_bMobile||createjs.Sound.play("tap"),s.increaseScore(),s.playerAnim(t.getX(),t.getY()),a.set(-C*a.getX(),-C*a.getY());var c=new CVector2(-e.rawX+t.getX(),-1*(e.rawY-(t.getY()-BALL_SIZE/2)));c.normalize();var r=new CVector2(c.getX()*g,c.getY()*I-0);this.applyForce(r),!1===n&&(n=!0,createjs.Tween.get(i).to({scaleX:1.15,scaleY:.85},100,createjs.Ease.cubicIn).call(function(){createjs.Tween.get(i).to({scaleX:1,scaleY:1},100,createjs.Ease.cubicOut).call(function(){})}),createjs.Tween.get(_).to({scaleX:1.15,scaleY:.85,alpha:.4},100,createjs.Ease.cubicIn).call(function(){createjs.Tween.get(_).to({scaleX:1,scaleY:1,alpha:0},100,createjs.Ease.cubicOut).call(function(){n=!1})}))},this._friction=function(){var e=new CVector2(a.getX(),a.getY());e.scalarProduct(-1),e.normalize(),e.scalarProduct(l),this.applyForce(e)},this._v2Limit=function(e,t){e.length()>=t&&(e.normalize(),e.scalarProduct(t))},this._init(e)}