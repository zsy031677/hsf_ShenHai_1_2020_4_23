function CMain(e){var i,t,s,r=0,a=0,o=STATE_LOADING;this.initContainer=function(e){INIT_GRAVITY_NORMAL=e.gravity,INIT_BALLMASS_NORMAL=e.ballMass,FRICTION_NORMAL=e.friction,EDGEFRICTION_NORMAL=e.edgeFriction,ROTATIONSPEED_NORMAL=e.rotationSpeed,HORIZ_KICKFORCE_NORMAL=e.horizKickForce,VERT_KICKFORCE_NORMAL=e.vertKickForce,RESTITUTION_KICKFORCE_NORMAL=e.restitutionKickForce,INIT_GRAVITY_CHALLENGE=e.chGravity,INIT_BALLMASS_CHALLENGE=e.chBallMass,FRICTION_CHALLENGE=e.chFriction,EDGEFRICTION_CHALLENGE=e.chEdgeFriction,ROTATIONSPEED_CHALLENGE=e.chRotationSpeed,HORIZ_KICKFORCE_CHALLENGE=e.chHorizKickForce,VERT_KICKFORCE_CHALLENGE=e.chVertKickForce,RESTITUTION_KICKFORCE_CHALLENGE=e.chRestitutionKickForce,GRAVITY_INCREASE=e.chGravityIncrease,s_oStage=new createjs.Stage("canvas"),createjs.Touch.enable(s_oStage),!1===(s_bMobile=jQuery.browser.mobile)&&s_oStage.enableMouseOver(20),s_iPrevTime=(new Date).getTime(),createjs.Ticker.setFPS(30),createjs.Ticker.addEventListener("tick",this._update),!1!==DISABLE_SOUND_MOBILE&&!1!==s_bMobile||this._initSounds(),s_oSpriteLibrary=new CSpriteLibrary,i=new CPreloader,this._loadImages()},this.soundLoaded=function(){++r===a&&(i.unload(),this.gotoMenu())},this._initSounds=function(){createjs.Sound.initializeDefaultPlugins()&&(navigator.userAgent.indexOf("Opera")>0||navigator.userAgent.indexOf("OPR")>0?(createjs.Sound.alternateExtensions=["mp3"],createjs.Sound.addEventListener("fileload",createjs.proxy(this.soundLoaded,this)),createjs.Sound.registerSound("./sounds/reset_kickup.ogg","reset_kickup"),createjs.Sound.registerSound("./sounds/soundtrack.ogg","soundtrack"),createjs.Sound.registerSound("./sounds/tap.ogg","tap")):(createjs.Sound.alternateExtensions=["ogg"],createjs.Sound.addEventListener("fileload",createjs.proxy(this.soundLoaded,this)),createjs.Sound.registerSound("./sounds/reset_kickup.mp3","reset_kickup"),createjs.Sound.registerSound("./sounds/soundtrack.mp3","soundtrack"),createjs.Sound.registerSound("./sounds/tap.mp3","tap")),a+=3)},this._loadImages=function(){s_oSpriteLibrary.init(this._onImagesLoaded,this._onAllImagesLoaded,this),s_oSpriteLibrary.addSprite("audio_icon","./sprites/audio_icon.png"),s_oSpriteLibrary.addSprite("ball_1","./sprites/ball_1.png"),s_oSpriteLibrary.addSprite("ball_2","./sprites/ball_2.png"),s_oSpriteLibrary.addSprite("ball_3","./sprites/ball_3.png"),s_oSpriteLibrary.addSprite("ball_hit","./sprites/ball_hit.png"),s_oSpriteLibrary.addSprite("shadow","./sprites/shadow.png"),s_oSpriteLibrary.addSprite("bg_game","./sprites/bg_game.jpg"),s_oSpriteLibrary.addSprite("bg_help","./sprites/bg_help.png"),s_oSpriteLibrary.addSprite("bg_menu","./sprites/bg_menu.jpg"),s_oSpriteLibrary.addSprite("but_exit","./sprites/but_exit.png"),s_oSpriteLibrary.addSprite("but_play","./sprites/but_play.png"),s_oSpriteLibrary.addSprite("panel","./sprites/msg_box.png");for(var e=1;e<=7;e++)s_oSpriteLibrary.addSprite("player_"+e,"./sprites/player_sprite_"+e+".png");a+=s_oSpriteLibrary.getNumSprites(),s_oSpriteLibrary.loadSprites()},this._onImagesLoaded=function(){r++;var e=Math.floor(r/a*100);i.refreshLoader(e),r===a&&(i.unload(),this.gotoMenu())},this._onAllImagesLoaded=function(){},this.onAllPreloaderImagesLoaded=function(){this._loadImages()},this.gotoMenu=function(){t=new CMenu,o=STATE_MENU},this.gotoGame=function(e){s=new CGame(e),o=STATE_GAME,$(s_oMain).trigger("game_start")},this.gotoHelp=function(){_oHelp=new CHelp,o=STATE_HELP},this._update=function(e){var i=(new Date).getTime();s_iTimeElaps=i-s_iPrevTime,s_iCntFps++,s_iPrevTime=i,(s_iCntTime+=s_iTimeElaps)>=1e3&&(s_iCurFps=s_iCntFps,s_iCntTime-=1e3,s_iCntFps=0),o===STATE_GAME&&s.update(),s_oStage.update(e)},s_oMain=this,this.initContainer(e)}var s_bMobile,s_oDrawLayer,s_oStage,s_oMain,s_oSpriteLibrary,s_oGameSettings,s_bAudioActive=!0,s_iCntTime=0,s_iTimeElaps=0,s_iPrevTime=0,s_iCntFps=0,s_iCurFps=0,s_oSoundTrack=null;