function CController(){function t(t){return a||o||(n===LAUNCH_STATE_DIRECTION&&s_oGame.getState()===STATE_PLAY&&(37===t.keyCode?(u.onLeft(),a=!0):39===t.keyCode&&(u.onRight(),a=!0)),32===t.keyCode&&(u.manageControl(),a=!0)),t.preventDefault(),!1}function e(t){return a&&(n===LAUNCH_STATE_DIRECTION&&s_oGame.getState()===STATE_PLAY&&(37===t.keyCode?a=!1:39===t.keyCode&&(a=!1)),32===t.keyCode&&(a=!1)),t.preventDefault(),!1}var i,n,o,a,s,r,_,l,A,u,C,T;return this._init=function(){o=!1,n=LAUNCH_STATE_DIRECTION,(C=new createjs.Shape).graphics.beginFill("rgba(0,0,0,0.01)").drawRect(0,0,CANVAS_WIDTH,CANVAS_HEIGHT),s_oStage.addChild(C),A=new createjs.Container,s_oStage.addChild(A),s={x:CANVAS_WIDTH_HALF+250,y:CANVAS_HEIGHT-300},r={x:CANVAS_WIDTH_HALF-250,y:CANVAS_HEIGHT-300};var t=s_oSpriteLibrary.getSprite("arrow_left");(_=new CGfxButton(r.x,r.y,t,A)).addEventListener(ON_MOUSE_DOWN,this.onLeft,this),_.setScale(.6);var e=s_oSpriteLibrary.getSprite("arrow_right");(l=new CGfxButton(s.x,s.y,e,A)).addEventListener(ON_MOUSE_DOWN,this.onRight,this),l.setScale(.6),(T=new CPowerBar(CANVAS_WIDTH_HALF-200,CANVAS_HEIGHT_HALF+320,s_oStage)).setVisible(!1),this.arrowVisibility(!1)},this.arrowVisibility=function(t){A.visible=t},this.onLeft=function(){s_oGame.setBallPosition("left")},this.onRight=function(){s_oGame.setBallPosition("right")},this.activeStateLaunchPower=function(){n=LAUNCH_STATE_POWER,T.setVisible(!0),T.animFade(1),T.animateMask(TIME_POWER_BAR)},this.activeStateLaunchEffect=function(){n=LAUNCH_STATE_EFFECT,T.animateRotation(TIME_POWER_BAR_ANGLE)},this.resetControls=function(){o=!1,n=LAUNCH_STATE_DIRECTION,u.arrowVisibility(!0),T.mask(0),T.setRotation(0),T.setVisible(!1)},this.manageControl=function(){if(!o)if(n===LAUNCH_STATE_DIRECTION)u.arrowVisibility(!1),u.activeStateLaunchPower();else if(n===LAUNCH_STATE_POWER)T.removeTweensMask(),u.activeStateLaunchEffect();else if(n===LAUNCH_STATE_EFFECT){T.removeTweensContainer(),o=!0;var t=T.getMaskValue(),e=T.getRotationValue();s_oGame.launchBall(t,e)}},this.enable=function(){this.arrowVisibility(!0),i=C.on("mousedown",this.manageControl,this),s_bMobile||(document.onkeydown=t,document.onkeyup=e)},this.disable=function(){C.off("mousedown",i),s_bMobile||(document.onkeydown=null,document.onkeyup=null)},this.unload=function(){_.unload(),_=null,l.unload(),l=null,T.unload(),this.disable()},this._init(),u=this,this}