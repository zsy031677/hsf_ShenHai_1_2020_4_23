function TimeSeries(e){(e=e||{}).resetBoundsInterval=e.resetBoundsInterval||3e3,e.resetBounds=void 0===e.resetBounds||e.resetBounds,this.options=e,this.data=[],this.label=e.label||"",this.maxDataLength=e.maxDataLength||1e3,this.dataPool=[],this.maxValue=Number.NaN,this.minValue=Number.NaN,e.resetBounds&&(this.boundsTimer=setInterval(function(e){return function(){e.resetBounds()}}(this),e.resetBoundsInterval))}function SmoothieChart(e){(e=e||{}).grid=e.grid||{fillStyle:"#000000",strokeStyle:"#777777",lineWidth:1,millisPerLine:1e3,verticalSections:2},e.millisPerPixel=e.millisPerPixel||20,e.fps=e.fps||50,e.maxValueScale=e.maxValueScale||1,e.minValue=e.minValue,e.maxValue=e.maxValue,e.labels=e.labels||{fillStyle:"#ffffff"},e.interpolation=e.interpolation||"bezier",e.scaleSmoothing=e.scaleSmoothing||.125,e.maxDataSetLength=e.maxDataSetLength||2,e.timestampFormatter=e.timestampFormatter||null,this.options=e,this.seriesSet=[],this.currentValueRange=1,this.currentVisMinValue=0}TimeSeries.prototype.resetBounds=function(){this.maxValue=Number.NaN,this.minValue=Number.NaN;for(var e=0;e<this.data.length;e++)this.maxValue=isNaN(this.maxValue)?this.data[e][1]:Math.max(this.maxValue,this.data[e][1]),this.minValue=isNaN(this.minValue)?this.data[e][1]:Math.min(this.minValue,this.data[e][1])},TimeSeries.prototype.append=function(e,t){this.lastTimeStamp=e;var i=this.dataPool.length?this.dataPool.pop():[e,t];for(i[0]=e,i[1]=t,this.data.push(i),this.maxValue=isNaN(this.maxValue)?t:Math.max(this.maxValue,t),this.minValue=isNaN(this.minValue)?t:Math.min(this.minValue,t);this.data.length>this.maxDataLength;)this.dataPool.push(this.data.shift())},SmoothieChart.prototype.addTimeSeries=function(e,t){this.seriesSet.push({timeSeries:e,options:t||{}})},SmoothieChart.prototype.removeTimeSeries=function(e){this.seriesSet.splice(this.seriesSet.indexOf(e),1)},SmoothieChart.prototype.streamTo=function(e,t){var i=this;this.render_on_tick=function(){var t=i.seriesSet[0].timeSeries;t.data;i.render(e,t.lastTimeStamp)},this.start()},SmoothieChart.prototype.start=function(){this.timer||(this.timer=setInterval(this.render_on_tick,1e3/this.options.fps))},SmoothieChart.prototype.stop=function(){this.timer&&(clearInterval(this.timer),this.timer=void 0)},SmoothieChart.timeFormatter=function(e){function t(e){return(e<10?"0":"")+e}return t(e.getHours())+":"+t(e.getMinutes())+":"+t(e.getSeconds())},SmoothieChart.prototype.render=function(e,t){var i=e.getContext("2d"),a=this.options,s={top:0,left:0,width:e.clientWidth,height:e.clientHeight};if(i.save(),t-=t%a.millisPerPixel,i.translate(s.left,s.top),i.beginPath(),i.rect(0,0,s.width,s.height),i.clip(),i.save(),i.fillStyle=a.grid.fillStyle,i.clearRect(0,0,s.width,s.height),i.fillRect(0,0,s.width,s.height),i.restore(),i.save(),i.lineWidth=a.grid.lineWidth||1,i.strokeStyle=a.grid.strokeStyle||"#ffffff",a.grid.millisPerLine>0)for(var l=t-t%a.grid.millisPerLine;l>=t-s.width*a.millisPerPixel;l-=a.grid.millisPerLine){i.beginPath();var r=Math.round(s.width-(t-l)/a.millisPerPixel);if(i.moveTo(r,0),i.lineTo(r,s.height),i.stroke(),a.timestampFormatter){var h=new Date(l),n=a.timestampFormatter(h),o=i.measureText(n).width/2+i.measureText(C).width+4;r<s.width-o&&(i.fillStyle=a.labels.fillStyle,i.fillText(n,r-i.measureText(n).width/2,s.height-2))}i.closePath()}for(var m=1;m<a.grid.verticalSections;m++){var u=Math.round(m*s.height/a.grid.verticalSections);i.beginPath(),i.moveTo(0,u),i.lineTo(s.width,u),i.stroke(),i.closePath()}i.beginPath(),i.strokeRect(0,0,s.width,s.height),i.closePath(),i.restore();for(var d=Number.NaN,f=Number.NaN,S=0;S<this.seriesSet.length;S++){L=this.seriesSet[S].timeSeries;isNaN(L.maxValue)||(d=isNaN(d)?L.maxValue:Math.max(d,L.maxValue)),isNaN(L.minValue)||(f=isNaN(f)?L.minValue:Math.min(f,L.minValue))}if(isNaN(d)&&isNaN(f))i.restore();else{null!=a.maxValue?d=a.maxValue:d*=a.maxValueScale,null!=a.minValue&&(f=a.minValue);var g=d-f;this.currentValueRange+=a.scaleSmoothing*(g-this.currentValueRange),this.currentVisMinValue+=a.scaleSmoothing*(f-this.currentVisMinValue);for(var c=this.currentValueRange,p=this.currentVisMinValue,S=0;S<this.seriesSet.length;S++){i.save();for(var x=(L=this.seriesSet[S].timeSeries).data,V=this.seriesSet[S].options;x.length>=a.maxDataSetLength&&x[1][0]<t-s.width*a.millisPerPixel;)x.splice(0,1);i.lineWidth=V.lineWidth||1,i.fillStyle=V.fillStyle,i.strokeStyle=V.strokeStyle||"#ffffff",i.beginPath();for(var v=0,N=0,P=0,b=0;b<x.length;b++){var T=Math.round(s.width-(t-x[b][0])/a.millisPerPixel),y=x[b][1]-p,w=s.height-(c?Math.round(y/c*s.height):0),M=Math.max(Math.min(w,s.height-1),1);if(0==b)v=T,i.moveTo(T,M);else switch(a.interpolation){case"line":i.lineTo(T,M);break;case"bezier":default:i.bezierCurveTo(Math.round((N+T)/2),P,Math.round(N+T)/2,M,T,M)}N=T,P=M}x.length>0&&V.fillStyle&&(i.lineTo(s.width+V.lineWidth+1,P),i.lineTo(s.width+V.lineWidth+1,s.height+V.lineWidth+1),i.lineTo(v,s.height+V.lineWidth),i.fill()),i.stroke(),i.closePath(),i.restore()}if(!a.labels.disabled){a.labelOffsetY||(a.labelOffsetY=0),i.fillStyle=a.labels.fillStyle;var k=parseFloat(d).toFixed(2),C=parseFloat(f).toFixed(2);i.fillText(k,s.width-i.measureText(k).width-2,10),i.fillText(C,s.width-i.measureText(C).width-2,s.height-2);for(b=0;b<this.seriesSet.length;b++){var L,W=(L=this.seriesSet[b].timeSeries).label;i.fillStyle=L.options.fillStyle||"rgb(255,255,255)",W&&i.fillText(W,2,10*(b+1)+a.labelOffsetY)}}i.restore()}};